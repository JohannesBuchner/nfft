<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
    <title>
      NFFT 3.1.3 API Reference - NFFT: nfft_times.c Source File
    </title>
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <table>
      <tr>
        <td valign="top">
          <img src="images/logo.png" alt="NFFT Logo">
        </td>
        <td align="left" valign="bottom" width="100%">
          <H1nc>3.1.3 API Reference</H1nc>
        </td>
      </tr>
    </table>  
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<h1>nfft_times.c</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * Copyright (c) 2002, 2009 Jens Keiner, Stefan Kunis, Daniel Potts</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * This program is free software; you can redistribute it and/or modify it under</span>
<a name="l00005"></a>00005 <span class="comment"> * the terms of the GNU General Public License as published by the Free Software</span>
<a name="l00006"></a>00006 <span class="comment"> * Foundation; either version 2 of the License, or (at your option) any later</span>
<a name="l00007"></a>00007 <span class="comment"> * version.</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * This program is distributed in the hope that it will be useful, but WITHOUT</span>
<a name="l00010"></a>00010 <span class="comment"> * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</span>
<a name="l00011"></a>00011 <span class="comment"> * FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more</span>
<a name="l00012"></a>00012 <span class="comment"> * details.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * You should have received a copy of the GNU General Public License along with</span>
<a name="l00015"></a>00015 <span class="comment"> * this program; if not, write to the Free Software Foundation, Inc., 51</span>
<a name="l00016"></a>00016 <span class="comment"> * Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</span>
<a name="l00017"></a>00017 <span class="comment"> */</span>
<a name="l00018"></a>00018 
<a name="l00019"></a>00019 <span class="comment">/* $Id: nfft_times.c 3198 2009-05-27 14:16:50Z keiner $ */</span>
<a name="l00020"></a>00020 
<a name="l00021"></a>00021 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;complex.h&gt;</span>
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 <span class="preprocessor">#include "<a class="code" href="nfft3util_8h.html" title="Header file for utility functions used by the nfft3 library.">nfft3util.h</a>"</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include "<a class="code" href="nfft3_8h.html" title="Header file for the nfft3 library.">nfft3.h</a>"</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="keywordtype">int</span> global_n;
<a name="l00031"></a>00031 <span class="keywordtype">int</span> global_d;
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 <span class="keyword">static</span> <span class="keywordtype">int</span> comp1(<span class="keyword">const</span> <span class="keywordtype">void</span> *x,<span class="keyword">const</span> <span class="keywordtype">void</span> *y)
<a name="l00034"></a>00034 {
<a name="l00035"></a>00035   <span class="keywordflow">return</span> ((* (<span class="keywordtype">double</span>*) x)&lt;(* (<span class="keywordtype">double</span>*) y)?-1:1);
<a name="l00036"></a>00036 }
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 <span class="keyword">static</span> <span class="keywordtype">int</span> comp2(<span class="keyword">const</span> <span class="keywordtype">void</span> *x,<span class="keyword">const</span> <span class="keywordtype">void</span> *y)
<a name="l00039"></a>00039 {
<a name="l00040"></a>00040   <span class="keywordtype">int</span> nx0,nx1,ny0,ny1;
<a name="l00041"></a>00041   nx0=global_n*(* ((<span class="keywordtype">double</span>*)x+0));
<a name="l00042"></a>00042   nx1=global_n*(* ((<span class="keywordtype">double</span>*)x+1));
<a name="l00043"></a>00043   ny0=global_n*(* ((<span class="keywordtype">double</span>*)y+0));
<a name="l00044"></a>00044   ny1=global_n*(* ((<span class="keywordtype">double</span>*)y+1));
<a name="l00045"></a>00045 
<a name="l00046"></a>00046   <span class="keywordflow">if</span>(nx0&lt;ny0)
<a name="l00047"></a>00047     <span class="keywordflow">return</span> -1;
<a name="l00048"></a>00048   <span class="keywordflow">else</span>
<a name="l00049"></a>00049     <span class="keywordflow">if</span>(nx0==ny0)
<a name="l00050"></a>00050       <span class="keywordflow">if</span>(nx1&lt;ny1)
<a name="l00051"></a>00051   <span class="keywordflow">return</span> -1;
<a name="l00052"></a>00052       <span class="keywordflow">else</span>
<a name="l00053"></a>00053   <span class="keywordflow">return</span> 1;
<a name="l00054"></a>00054     <span class="keywordflow">else</span>
<a name="l00055"></a>00055       <span class="keywordflow">return</span> 1;
<a name="l00056"></a>00056 }
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 <span class="keyword">static</span> <span class="keywordtype">int</span> comp3(<span class="keyword">const</span> <span class="keywordtype">void</span> *x,<span class="keyword">const</span> <span class="keywordtype">void</span> *y)
<a name="l00059"></a>00059 {
<a name="l00060"></a>00060   <span class="keywordtype">int</span> nx0,nx1,nx2,ny0,ny1,ny2;
<a name="l00061"></a>00061   nx0=global_n*(* ((<span class="keywordtype">double</span>*)x+0));
<a name="l00062"></a>00062   nx1=global_n*(* ((<span class="keywordtype">double</span>*)x+1));
<a name="l00063"></a>00063   nx2=global_n*(* ((<span class="keywordtype">double</span>*)x+2));
<a name="l00064"></a>00064   ny0=global_n*(* ((<span class="keywordtype">double</span>*)y+0));
<a name="l00065"></a>00065   ny1=global_n*(* ((<span class="keywordtype">double</span>*)y+1));
<a name="l00066"></a>00066   ny2=global_n*(* ((<span class="keywordtype">double</span>*)y+2));
<a name="l00067"></a>00067 
<a name="l00068"></a>00068   <span class="keywordflow">if</span>(nx0&lt;ny0)
<a name="l00069"></a>00069     <span class="keywordflow">return</span> -1;
<a name="l00070"></a>00070   <span class="keywordflow">else</span>
<a name="l00071"></a>00071     <span class="keywordflow">if</span>(nx0==ny0)
<a name="l00072"></a>00072       <span class="keywordflow">if</span>(nx1&lt;ny1)
<a name="l00073"></a>00073   <span class="keywordflow">return</span> -1;
<a name="l00074"></a>00074       <span class="keywordflow">else</span>
<a name="l00075"></a>00075   <span class="keywordflow">if</span>(nx1==ny1)
<a name="l00076"></a>00076     <span class="keywordflow">if</span>(nx2&lt;ny2)
<a name="l00077"></a>00077       <span class="keywordflow">return</span> -1;
<a name="l00078"></a>00078     <span class="keywordflow">else</span>
<a name="l00079"></a>00079       <span class="keywordflow">return</span> 1;
<a name="l00080"></a>00080   <span class="keywordflow">else</span>
<a name="l00081"></a>00081     <span class="keywordflow">return</span> 1;
<a name="l00082"></a>00082     <span class="keywordflow">else</span>
<a name="l00083"></a>00083       <span class="keywordflow">return</span> 1;
<a name="l00084"></a>00084 }
<a name="l00085"></a>00085 
<a name="l00086"></a>00086 <span class="keywordtype">void</span> measure_time_nfft(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> N, <span class="keywordtype">unsigned</span> test_ndft)
<a name="l00087"></a>00087 {
<a name="l00088"></a>00088   <span class="keywordtype">int</span> r, M, NN[d], nn[d],j;
<a name="l00089"></a>00089   <span class="keywordtype">double</span> t, t_fft, t_ndft, t_nfft;
<a name="l00090"></a>00090 
<a name="l00091"></a>00091   <a class="code" href="structnfft__plan.html" title="Structure for a NFFT plan.">nfft_plan</a> p;
<a name="l00092"></a>00092   fftw_plan p_fft;
<a name="l00093"></a>00093 
<a name="l00094"></a>00094   <span class="keywordtype">double</span> auxC=pow(2,29);
<a name="l00095"></a>00095 
<a name="l00096"></a>00096   printf(<span class="stringliteral">"\\verb+%d+&amp;\t"</span>,(<span class="keywordtype">int</span>)(log(N)/log(2)*d+0.5));
<a name="l00097"></a>00097 
<a name="l00098"></a>00098   <span class="keywordflow">for</span>(r=0,M=1;r&lt;d;r++)
<a name="l00099"></a>00099     {
<a name="l00100"></a>00100       M=N*M;
<a name="l00101"></a>00101       NN[r]=N;
<a name="l00102"></a>00102       nn[r]=2*N;
<a name="l00103"></a>00103     }
<a name="l00104"></a>00104 
<a name="l00105"></a>00105   <a class="code" href="group__nfft.html#g406f05717c6299b918261c61aaa9de23" title="Initialisation of a transform plan, guru.">nfft_init_guru</a>(&amp;p, d, NN, M, nn, 2,
<a name="l00106"></a>00106      <a class="code" href="group__nfft.html#gda3a356fdaf5840f98374a0a7aaf3e9c" title="If this flag is set, the deconvolution step (the multiplication with the diagonal...">PRE_PHI_HUT</a>|
<a name="l00107"></a>00107      <a class="code" href="group__nfft.html#g7ad8a7e19519b16340dabec48899c6a4" title="If this flag is set, the convolution step (the multiplication with the sparse matrix...">PRE_FULL_PSI</a>| <a class="code" href="group__nfft.html#g02d52cb02b6cfdbc3e4d5fd4de1aef9e" title="If this flag is set, (de)allocation of the vector of Fourier coefficients is done...">MALLOC_F_HAT</a>| <a class="code" href="group__nfft.html#g353185384f87de0dc4320a82652ef724" title="If this flag is set, (de)allocation of the node vector is done.">MALLOC_X</a>| <a class="code" href="group__nfft.html#ga7b5098f4136080bbe0dd989973e2a69" title="If this flag is set, (de)allocation of the vector of samples is done.">MALLOC_F</a>|
<a name="l00108"></a>00108      <a class="code" href="group__nfft.html#gd3fe6867a3351441c6f44dd5a3746f5b" title="If this flag is set, fftw_init/fftw_finalize is called.">FFTW_INIT</a>| <a class="code" href="group__nfft.html#g9193f768d5839892d0e303080c370eaf" title="If this flag is set, FFTW uses disjoint input/output vectors.">FFT_OUT_OF_PLACE</a>,
<a name="l00109"></a>00109      FFTW_MEASURE| FFTW_DESTROY_INPUT);
<a name="l00110"></a>00110 
<a name="l00111"></a>00111   p_fft=fftw_plan_dft(d, NN, p.<a class="code" href="structnfft__plan.html#23409aec68871e9a56f11711e2891691" title="Vector of Fourier coefficients, \ size is N_total float_types.">f_hat</a>, p.<a class="code" href="structnfft__plan.html#fa27a166f809acf70ae27e5e6f28daa5" title="Vector of samples, \ size is M_total float types.">f</a>, FFTW_FORWARD, FFTW_MEASURE);
<a name="l00112"></a>00112 
<a name="l00114"></a>00114   <a class="code" href="group__nfftutil.html#ga44184ac2c1452221508e7640f391c34" title="Inits a vector of random double numbers in .">nfft_vrand_shifted_unit_double</a>(p.<a class="code" href="structnfft__plan.html#7eb64fb5fedfba0ec75261e777e020c0" title="Nodes in time/spatial domain, size is  doubles.">x</a>, p.<a class="code" href="structnfft__plan.html#e39d4867eac948d96abbe3fc930b39a8" title="Dimension, rank.">d</a>*p.<a class="code" href="structnfft__plan.html#df33ce87c35b396c50d214d9bdeeefe6" title="Total number of samples.">M_total</a>);
<a name="l00115"></a>00115 
<a name="l00116"></a>00116   global_n=nn[0];
<a name="l00117"></a>00117   global_d=d;
<a name="l00118"></a>00118   <span class="keywordflow">switch</span>(d)
<a name="l00119"></a>00119     {
<a name="l00120"></a>00120       <span class="keywordflow">case</span> 1: { qsort(p.<a class="code" href="structnfft__plan.html#7eb64fb5fedfba0ec75261e777e020c0" title="Nodes in time/spatial domain, size is  doubles.">x</a>,p.<a class="code" href="structnfft__plan.html#df33ce87c35b396c50d214d9bdeeefe6" title="Total number of samples.">M_total</a>,d*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),comp1); <span class="keywordflow">break</span>; }
<a name="l00121"></a>00121       <span class="keywordflow">case</span> 2: { qsort(p.<a class="code" href="structnfft__plan.html#7eb64fb5fedfba0ec75261e777e020c0" title="Nodes in time/spatial domain, size is  doubles.">x</a>,p.<a class="code" href="structnfft__plan.html#df33ce87c35b396c50d214d9bdeeefe6" title="Total number of samples.">M_total</a>,d*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),comp2); <span class="keywordflow">break</span>; }
<a name="l00122"></a>00122       <span class="keywordflow">case</span> 3: { qsort(p.<a class="code" href="structnfft__plan.html#7eb64fb5fedfba0ec75261e777e020c0" title="Nodes in time/spatial domain, size is  doubles.">x</a>,p.<a class="code" href="structnfft__plan.html#df33ce87c35b396c50d214d9bdeeefe6" title="Total number of samples.">M_total</a>,d*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),comp3); <span class="keywordflow">break</span>; }
<a name="l00123"></a>00123     }
<a name="l00124"></a>00124 
<a name="l00125"></a>00125   <a class="code" href="group__nfft.html#gfd7b278b6ed04d929212b4807dd195f0" title="Precomputation for a transform plan.">nfft_precompute_one_psi</a>(&amp;p);
<a name="l00126"></a>00126 
<a name="l00128"></a>00128   <a class="code" href="group__nfftutil.html#g5f53c8cd0b2f33200fce15ecf75a0685" title="Inits a vector of random complex numbers in .">nfft_vrand_unit_complex</a>(p.<a class="code" href="structnfft__plan.html#23409aec68871e9a56f11711e2891691" title="Vector of Fourier coefficients, \ size is N_total float_types.">f_hat</a>, p.<a class="code" href="structnfft__plan.html#d33daddf76670c8731c759bf74ad0d22" title="Total number of Fourier \ coefficients.">N_total</a>);
<a name="l00129"></a>00129 
<a name="l00131"></a>00131   t_fft=0;
<a name="l00132"></a>00132   r=0;
<a name="l00133"></a>00133   <span class="keywordflow">while</span>(t_fft&lt;1)
<a name="l00134"></a>00134     {
<a name="l00135"></a>00135       r++;
<a name="l00136"></a>00136       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00137"></a>00137       fftw_execute(p_fft);
<a name="l00138"></a>00138       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00139"></a>00139       t_fft+=t;
<a name="l00140"></a>00140     }
<a name="l00141"></a>00141   t_fft/=r;
<a name="l00142"></a>00142 
<a name="l00143"></a>00143   <span class="comment">//  printf("\\verb+%.1e+ &amp; \\verb+(%.1f)+ &amp;\t",t_fft,t_fft/(p.N_total*(log(N)/log(2)*d))*auxC);</span>
<a name="l00144"></a>00144   printf(<span class="stringliteral">"\\verb+%.1e+ &amp;\t"</span>,t_fft);
<a name="l00145"></a>00145 
<a name="l00147"></a>00147   <span class="keywordflow">if</span>(test_ndft)
<a name="l00148"></a>00148     {
<a name="l00149"></a>00149       t_ndft=0;
<a name="l00150"></a>00150       r=0;
<a name="l00151"></a>00151       <span class="keywordflow">while</span>(t_ndft&lt;1)
<a name="l00152"></a>00152         {
<a name="l00153"></a>00153           r++;
<a name="l00154"></a>00154           t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00155"></a>00155           <a class="code" href="group__nfft.html#g27ef1bcb8dd3a3fc1cdbeee368ec1acf" title="Computes a NDFT, see the definition.">ndft_trafo</a>(&amp;p);
<a name="l00156"></a>00156           t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00157"></a>00157           t_ndft+=t;
<a name="l00158"></a>00158         }
<a name="l00159"></a>00159       t_ndft/=r;
<a name="l00160"></a>00160       <span class="comment">//printf("\\verb+%.1e+ &amp; \\verb+(%d)+&amp;\t",t_ndft,(int)round(t_ndft/(p.N_total*p.N_total)*auxC));</span>
<a name="l00161"></a>00161       printf(<span class="stringliteral">"\\verb+%.1e+ &amp;\t"</span>,t_ndft);
<a name="l00162"></a>00162     }
<a name="l00163"></a>00163   <span class="keywordflow">else</span>
<a name="l00164"></a>00164     <span class="comment">//    printf("\\verb+*+\t&amp;\t&amp;\t");</span>
<a name="l00165"></a>00165     printf(<span class="stringliteral">"\\verb+*+\t&amp;\t"</span>);
<a name="l00166"></a>00166 
<a name="l00168"></a>00168   t_nfft=0;
<a name="l00169"></a>00169   r=0;
<a name="l00170"></a>00170   <span class="keywordflow">while</span>(t_nfft&lt;1)
<a name="l00171"></a>00171     {
<a name="l00172"></a>00172       r++;
<a name="l00173"></a>00173       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00174"></a>00174       <span class="keywordflow">switch</span>(d)
<a name="l00175"></a>00175   {
<a name="l00176"></a>00176     <span class="keywordflow">case</span> 1: { nfft_trafo_1d(&amp;p); <span class="keywordflow">break</span>; }
<a name="l00177"></a>00177     <span class="keywordflow">case</span> 2: { nfft_trafo_2d(&amp;p); <span class="keywordflow">break</span>; }
<a name="l00178"></a>00178     <span class="keywordflow">case</span> 3: { nfft_trafo_3d(&amp;p); <span class="keywordflow">break</span>; }
<a name="l00179"></a>00179           <span class="keywordflow">default</span>: <a class="code" href="group__nfft.html#g9f1e6bd9f7f956a8679e6b413c97b421" title="Computes a NFFT, see the definition.">nfft_trafo</a>(&amp;p);
<a name="l00180"></a>00180   }
<a name="l00181"></a>00181       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00182"></a>00182       t_nfft+=t;
<a name="l00183"></a>00183     }
<a name="l00184"></a>00184   t_nfft/=r;
<a name="l00185"></a>00185 
<a name="l00186"></a>00186   <span class="comment">//  printf("\\verb+%.1e+ &amp; \\verb+(%d)+ &amp; \\verb+(%.1e)+\\\\\n",t_nfft,(int)round(t_nfft/(p.N_total*(log(N)/log(2)*d))*auxC),t_nfft/t_fft);</span>
<a name="l00187"></a>00187   printf(<span class="stringliteral">"\\verb+%.1e+ &amp; \\verb+(%3.1f)+\\\\\n"</span>,t_nfft,t_nfft/t_fft);
<a name="l00188"></a>00188 
<a name="l00189"></a>00189   fftw_destroy_plan(p_fft);
<a name="l00190"></a>00190   <a class="code" href="group__nfft.html#g614f9f7af5b0d5491afa9495393c4dc3" title="Destroys a transform plan.">nfft_finalize</a>(&amp;p);
<a name="l00191"></a>00191 }
<a name="l00192"></a>00192 
<a name="l00193"></a>00193 <span class="keywordtype">void</span> measure_time_nfft_XXX2(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> N, <span class="keywordtype">unsigned</span> test_ndft)
<a name="l00194"></a>00194 {
<a name="l00195"></a>00195   <span class="keywordtype">int</span> r, M, NN[d], nn[d];
<a name="l00196"></a>00196   <span class="keywordtype">double</span> t, t_fft, t_ndft, t_nfft;
<a name="l00197"></a>00197 
<a name="l00198"></a>00198   <a class="code" href="structnfft__plan.html" title="Structure for a NFFT plan.">nfft_plan</a> p;
<a name="l00199"></a>00199   fftw_plan p_fft;
<a name="l00200"></a>00200 
<a name="l00201"></a>00201   printf(<span class="stringliteral">"%d\t"</span>,(<span class="keywordtype">int</span>)(log(N)/log(2)*d+0.5)); fflush(stdout);
<a name="l00202"></a>00202 
<a name="l00203"></a>00203   <span class="keywordflow">for</span>(r=0,M=1;r&lt;d;r++)
<a name="l00204"></a>00204     {
<a name="l00205"></a>00205       M=N*M;
<a name="l00206"></a>00206       NN[r]=N;
<a name="l00207"></a>00207       nn[r]=2*N;
<a name="l00208"></a>00208     }
<a name="l00209"></a>00209 
<a name="l00210"></a>00210   <a class="code" href="group__nfft.html#g406f05717c6299b918261c61aaa9de23" title="Initialisation of a transform plan, guru.">nfft_init_guru</a>(&amp;p, d, NN, M, nn, 2,
<a name="l00211"></a>00211      <a class="code" href="group__nfft.html#gda3a356fdaf5840f98374a0a7aaf3e9c" title="If this flag is set, the deconvolution step (the multiplication with the diagonal...">PRE_PHI_HUT</a>|
<a name="l00212"></a>00212      <a class="code" href="group__nfft.html#g959463a5c7723ccef5057ddcb784b40c" title="If this flag is set, the convolution step (the multiplication with the sparse matrix...">PRE_PSI</a>|
<a name="l00213"></a>00213      <a class="code" href="group__nfft.html#g02d52cb02b6cfdbc3e4d5fd4de1aef9e" title="If this flag is set, (de)allocation of the vector of Fourier coefficients is done...">MALLOC_F_HAT</a>| <a class="code" href="group__nfft.html#g353185384f87de0dc4320a82652ef724" title="If this flag is set, (de)allocation of the node vector is done.">MALLOC_X</a>| <a class="code" href="group__nfft.html#ga7b5098f4136080bbe0dd989973e2a69" title="If this flag is set, (de)allocation of the vector of samples is done.">MALLOC_F</a>|
<a name="l00214"></a>00214      <a class="code" href="group__nfft.html#gd3fe6867a3351441c6f44dd5a3746f5b" title="If this flag is set, fftw_init/fftw_finalize is called.">FFTW_INIT</a>| <a class="code" href="group__nfft.html#g9193f768d5839892d0e303080c370eaf" title="If this flag is set, FFTW uses disjoint input/output vectors.">FFT_OUT_OF_PLACE</a>,
<a name="l00215"></a>00215      FFTW_MEASURE| FFTW_DESTROY_INPUT);
<a name="l00216"></a>00216 
<a name="l00217"></a>00217   p_fft=fftw_plan_dft(d, NN, p.<a class="code" href="structnfft__plan.html#23409aec68871e9a56f11711e2891691" title="Vector of Fourier coefficients, \ size is N_total float_types.">f_hat</a>, p.<a class="code" href="structnfft__plan.html#fa27a166f809acf70ae27e5e6f28daa5" title="Vector of samples, \ size is M_total float types.">f</a>, FFTW_FORWARD, FFTW_MEASURE);
<a name="l00218"></a>00218 
<a name="l00219"></a>00219   <span class="keywordtype">double</span> _Complex *swapndft=(<span class="keywordtype">double</span> _Complex*)<a class="code" href="nfft3_8h.html#afe6167438c5de4d3d4c509f66a6694e" title="Include header for FFTW3 library for its complex type.">nfft_malloc</a>(p.<a class="code" href="structnfft__plan.html#df33ce87c35b396c50d214d9bdeeefe6" title="Total number of samples.">M_total</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span> _Complex));
<a name="l00220"></a>00220 
<a name="l00222"></a>00222   <a class="code" href="group__nfftutil.html#ga44184ac2c1452221508e7640f391c34" title="Inits a vector of random double numbers in .">nfft_vrand_shifted_unit_double</a>(p.<a class="code" href="structnfft__plan.html#7eb64fb5fedfba0ec75261e777e020c0" title="Nodes in time/spatial domain, size is  doubles.">x</a>, p.<a class="code" href="structnfft__plan.html#e39d4867eac948d96abbe3fc930b39a8" title="Dimension, rank.">d</a>*p.<a class="code" href="structnfft__plan.html#df33ce87c35b396c50d214d9bdeeefe6" title="Total number of samples.">M_total</a>);
<a name="l00223"></a>00223 
<a name="l00224"></a>00224   qsort(p.<a class="code" href="structnfft__plan.html#7eb64fb5fedfba0ec75261e777e020c0" title="Nodes in time/spatial domain, size is  doubles.">x</a>,p.<a class="code" href="structnfft__plan.html#df33ce87c35b396c50d214d9bdeeefe6" title="Total number of samples.">M_total</a>,d*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),comp1);
<a name="l00225"></a>00225   <span class="comment">//nfft_vpr_double(p.x,p.M_total,"nodes x");</span>
<a name="l00226"></a>00226 
<a name="l00227"></a>00227   <a class="code" href="group__nfft.html#gfd7b278b6ed04d929212b4807dd195f0" title="Precomputation for a transform plan.">nfft_precompute_one_psi</a>(&amp;p);
<a name="l00228"></a>00228 
<a name="l00230"></a>00230   <a class="code" href="group__nfftutil.html#g5f53c8cd0b2f33200fce15ecf75a0685" title="Inits a vector of random complex numbers in .">nfft_vrand_unit_complex</a>(p.<a class="code" href="structnfft__plan.html#23409aec68871e9a56f11711e2891691" title="Vector of Fourier coefficients, \ size is N_total float_types.">f_hat</a>, p.<a class="code" href="structnfft__plan.html#d33daddf76670c8731c759bf74ad0d22" title="Total number of Fourier \ coefficients.">N_total</a>);
<a name="l00231"></a>00231 
<a name="l00233"></a>00233   t_fft=0;
<a name="l00234"></a>00234   r=0;
<a name="l00235"></a>00235   <span class="keywordflow">while</span>(t_fft&lt;0.1)
<a name="l00236"></a>00236     {
<a name="l00237"></a>00237       r++;
<a name="l00238"></a>00238       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00239"></a>00239       fftw_execute(p_fft);
<a name="l00240"></a>00240       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00241"></a>00241       t_fft+=t;
<a name="l00242"></a>00242     }
<a name="l00243"></a>00243   t_fft/=r;
<a name="l00244"></a>00244 
<a name="l00245"></a>00245   printf(<span class="stringliteral">"%.1e\t"</span>,t_fft);
<a name="l00246"></a>00246 
<a name="l00248"></a>00248   <span class="keywordflow">if</span>(test_ndft)
<a name="l00249"></a>00249     {
<a name="l00250"></a>00250       <a class="code" href="group__nfftutil.html#g4df074728562efbb458f6662e649d1d5" title="Swapping of two vectors.">NFFT_SWAP_complex</a>(p.<a class="code" href="structnfft__plan.html#fa27a166f809acf70ae27e5e6f28daa5" title="Vector of samples, \ size is M_total float types.">f</a>,swapndft);
<a name="l00251"></a>00251       t_ndft=0;
<a name="l00252"></a>00252       r=0;
<a name="l00253"></a>00253       <span class="keywordflow">while</span>(t_ndft&lt;0.1)
<a name="l00254"></a>00254         {
<a name="l00255"></a>00255           r++;
<a name="l00256"></a>00256           t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00257"></a>00257           <a class="code" href="group__nfft.html#g27ef1bcb8dd3a3fc1cdbeee368ec1acf" title="Computes a NDFT, see the definition.">ndft_trafo</a>(&amp;p);
<a name="l00258"></a>00258           t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00259"></a>00259           t_ndft+=t;
<a name="l00260"></a>00260         }
<a name="l00261"></a>00261       t_ndft/=r;
<a name="l00262"></a>00262       printf(<span class="stringliteral">"%.1e\t"</span>,t_ndft);
<a name="l00263"></a>00263       <a class="code" href="group__nfftutil.html#g4df074728562efbb458f6662e649d1d5" title="Swapping of two vectors.">NFFT_SWAP_complex</a>(p.<a class="code" href="structnfft__plan.html#fa27a166f809acf70ae27e5e6f28daa5" title="Vector of samples, \ size is M_total float types.">f</a>,swapndft);
<a name="l00264"></a>00264     }
<a name="l00265"></a>00265   <span class="keywordflow">else</span>
<a name="l00266"></a>00266     printf(<span class="stringliteral">"\t"</span>);
<a name="l00267"></a>00267 
<a name="l00269"></a>00269   t_nfft=0;
<a name="l00270"></a>00270   r=0;
<a name="l00271"></a>00271   <span class="keywordflow">while</span>(t_nfft&lt;0.1)
<a name="l00272"></a>00272     {
<a name="l00273"></a>00273       r++;
<a name="l00274"></a>00274       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00275"></a>00275       <a class="code" href="group__nfft.html#g9f1e6bd9f7f956a8679e6b413c97b421" title="Computes a NFFT, see the definition.">nfft_trafo</a>(&amp;p);
<a name="l00276"></a>00276       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00277"></a>00277       t_nfft+=t;
<a name="l00278"></a>00278     }
<a name="l00279"></a>00279   t_nfft/=r;
<a name="l00280"></a>00280   printf(<span class="stringliteral">"%.1e\t"</span>,t_nfft);
<a name="l00281"></a>00281   <span class="keywordflow">if</span>(test_ndft)
<a name="l00282"></a>00282     printf(<span class="stringliteral">"(%.1e)\t"</span>,<a class="code" href="group__nfftutil.html#gcdfad5420393c822ecc1602d9c164090" title="Computes .">nfft_error_l_2_complex</a>(swapndft, p.<a class="code" href="structnfft__plan.html#fa27a166f809acf70ae27e5e6f28daa5" title="Vector of samples, \ size is M_total float types.">f</a>, p.<a class="code" href="structnfft__plan.html#df33ce87c35b396c50d214d9bdeeefe6" title="Total number of samples.">M_total</a>));
<a name="l00283"></a>00283 
<a name="l00285"></a>00285   t_nfft=0;
<a name="l00286"></a>00286   r=0;
<a name="l00287"></a>00287   <span class="keywordflow">while</span>(t_nfft&lt;0.1)
<a name="l00288"></a>00288     {
<a name="l00289"></a>00289       r++;
<a name="l00290"></a>00290       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00291"></a>00291       nfft_trafo_1d(&amp;p);
<a name="l00292"></a>00292       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00293"></a>00293       t_nfft+=t;
<a name="l00294"></a>00294     }
<a name="l00295"></a>00295   t_nfft/=r;
<a name="l00296"></a>00296   printf(<span class="stringliteral">"%.1e\t"</span>,t_nfft);
<a name="l00297"></a>00297   <span class="keywordflow">if</span>(test_ndft)
<a name="l00298"></a>00298     printf(<span class="stringliteral">"(%.1e)\t"</span>,<a class="code" href="group__nfftutil.html#gcdfad5420393c822ecc1602d9c164090" title="Computes .">nfft_error_l_2_complex</a>(swapndft, p.<a class="code" href="structnfft__plan.html#fa27a166f809acf70ae27e5e6f28daa5" title="Vector of samples, \ size is M_total float types.">f</a>, p.<a class="code" href="structnfft__plan.html#df33ce87c35b396c50d214d9bdeeefe6" title="Total number of samples.">M_total</a>));
<a name="l00299"></a>00299 
<a name="l00300"></a>00300   printf(<span class="stringliteral">"\n"</span>);
<a name="l00301"></a>00301 
<a name="l00302"></a>00302   <a class="code" href="nfft3_8h.html#b8a0db03dda1317a8a3d922e0e4e8aaa">nfft_free</a>(swapndft);
<a name="l00303"></a>00303   fftw_destroy_plan(p_fft);
<a name="l00304"></a>00304   <a class="code" href="group__nfft.html#g614f9f7af5b0d5491afa9495393c4dc3" title="Destroys a transform plan.">nfft_finalize</a>(&amp;p);
<a name="l00305"></a>00305 }
<a name="l00306"></a>00306 
<a name="l00307"></a>00307 <span class="keywordtype">void</span> measure_time_nfft_XXX3(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> N, <span class="keywordtype">unsigned</span> test_ndft)
<a name="l00308"></a>00308 {
<a name="l00309"></a>00309   <span class="keywordtype">int</span> r, M, NN[d], nn[d];
<a name="l00310"></a>00310   <span class="keywordtype">double</span> t, t_fft, t_ndft, t_nfft;
<a name="l00311"></a>00311 
<a name="l00312"></a>00312   <a class="code" href="structnfft__plan.html" title="Structure for a NFFT plan.">nfft_plan</a> p;
<a name="l00313"></a>00313   fftw_plan p_fft;
<a name="l00314"></a>00314 
<a name="l00315"></a>00315   printf(<span class="stringliteral">"%d\t"</span>,(<span class="keywordtype">int</span>)(log(N)/log(2)*d+0.5)); fflush(stdout);
<a name="l00316"></a>00316 
<a name="l00317"></a>00317   <span class="keywordflow">for</span>(r=0,M=1;r&lt;d;r++)
<a name="l00318"></a>00318     {
<a name="l00319"></a>00319       M=N*M;
<a name="l00320"></a>00320       NN[r]=N;
<a name="l00321"></a>00321       nn[r]=2*N;
<a name="l00322"></a>00322     }
<a name="l00323"></a>00323 
<a name="l00324"></a>00324   <a class="code" href="group__nfft.html#g406f05717c6299b918261c61aaa9de23" title="Initialisation of a transform plan, guru.">nfft_init_guru</a>(&amp;p, d, NN, M, nn, 2,
<a name="l00325"></a>00325      <a class="code" href="group__nfft.html#gda3a356fdaf5840f98374a0a7aaf3e9c" title="If this flag is set, the deconvolution step (the multiplication with the diagonal...">PRE_PHI_HUT</a>|
<a name="l00326"></a>00326      <a class="code" href="group__nfft.html#g959463a5c7723ccef5057ddcb784b40c" title="If this flag is set, the convolution step (the multiplication with the sparse matrix...">PRE_PSI</a>|
<a name="l00327"></a>00327      <a class="code" href="group__nfft.html#g02d52cb02b6cfdbc3e4d5fd4de1aef9e" title="If this flag is set, (de)allocation of the vector of Fourier coefficients is done...">MALLOC_F_HAT</a>| <a class="code" href="group__nfft.html#g353185384f87de0dc4320a82652ef724" title="If this flag is set, (de)allocation of the node vector is done.">MALLOC_X</a>| <a class="code" href="group__nfft.html#ga7b5098f4136080bbe0dd989973e2a69" title="If this flag is set, (de)allocation of the vector of samples is done.">MALLOC_F</a>|
<a name="l00328"></a>00328      <a class="code" href="group__nfft.html#gd3fe6867a3351441c6f44dd5a3746f5b" title="If this flag is set, fftw_init/fftw_finalize is called.">FFTW_INIT</a>| <a class="code" href="group__nfft.html#g9193f768d5839892d0e303080c370eaf" title="If this flag is set, FFTW uses disjoint input/output vectors.">FFT_OUT_OF_PLACE</a>,
<a name="l00329"></a>00329      FFTW_MEASURE| FFTW_DESTROY_INPUT);
<a name="l00330"></a>00330 
<a name="l00331"></a>00331   p_fft=fftw_plan_dft(d, NN, p.<a class="code" href="structnfft__plan.html#fa27a166f809acf70ae27e5e6f28daa5" title="Vector of samples, \ size is M_total float types.">f</a>, p.<a class="code" href="structnfft__plan.html#23409aec68871e9a56f11711e2891691" title="Vector of Fourier coefficients, \ size is N_total float_types.">f_hat</a>, FFTW_BACKWARD, FFTW_MEASURE);
<a name="l00332"></a>00332 
<a name="l00333"></a>00333   <span class="keywordtype">double</span> _Complex *swapndft=(<span class="keywordtype">double</span> _Complex*)<a class="code" href="nfft3_8h.html#afe6167438c5de4d3d4c509f66a6694e" title="Include header for FFTW3 library for its complex type.">nfft_malloc</a>(p.<a class="code" href="structnfft__plan.html#d33daddf76670c8731c759bf74ad0d22" title="Total number of Fourier \ coefficients.">N_total</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span> _Complex));
<a name="l00334"></a>00334 
<a name="l00336"></a>00336   <a class="code" href="group__nfftutil.html#ga44184ac2c1452221508e7640f391c34" title="Inits a vector of random double numbers in .">nfft_vrand_shifted_unit_double</a>(p.<a class="code" href="structnfft__plan.html#7eb64fb5fedfba0ec75261e777e020c0" title="Nodes in time/spatial domain, size is  doubles.">x</a>, p.<a class="code" href="structnfft__plan.html#e39d4867eac948d96abbe3fc930b39a8" title="Dimension, rank.">d</a>*p.<a class="code" href="structnfft__plan.html#df33ce87c35b396c50d214d9bdeeefe6" title="Total number of samples.">M_total</a>);
<a name="l00337"></a>00337 
<a name="l00338"></a>00338   qsort(p.<a class="code" href="structnfft__plan.html#7eb64fb5fedfba0ec75261e777e020c0" title="Nodes in time/spatial domain, size is  doubles.">x</a>,p.<a class="code" href="structnfft__plan.html#df33ce87c35b396c50d214d9bdeeefe6" title="Total number of samples.">M_total</a>,d*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),comp1);
<a name="l00339"></a>00339   <span class="comment">//nfft_vpr_double(p.x,p.M_total,"nodes x");</span>
<a name="l00340"></a>00340 
<a name="l00341"></a>00341   <a class="code" href="group__nfft.html#gfd7b278b6ed04d929212b4807dd195f0" title="Precomputation for a transform plan.">nfft_precompute_one_psi</a>(&amp;p);
<a name="l00342"></a>00342 
<a name="l00344"></a>00344   <a class="code" href="group__nfftutil.html#g5f53c8cd0b2f33200fce15ecf75a0685" title="Inits a vector of random complex numbers in .">nfft_vrand_unit_complex</a>(p.<a class="code" href="structnfft__plan.html#fa27a166f809acf70ae27e5e6f28daa5" title="Vector of samples, \ size is M_total float types.">f</a>, p.<a class="code" href="structnfft__plan.html#d33daddf76670c8731c759bf74ad0d22" title="Total number of Fourier \ coefficients.">N_total</a>);
<a name="l00345"></a>00345 
<a name="l00347"></a>00347   t_fft=0;
<a name="l00348"></a>00348   r=0;
<a name="l00349"></a>00349   <span class="keywordflow">while</span>(t_fft&lt;0.1)
<a name="l00350"></a>00350     {
<a name="l00351"></a>00351       r++;
<a name="l00352"></a>00352       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00353"></a>00353       fftw_execute(p_fft);
<a name="l00354"></a>00354       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00355"></a>00355       t_fft+=t;
<a name="l00356"></a>00356     }
<a name="l00357"></a>00357   t_fft/=r;
<a name="l00358"></a>00358 
<a name="l00359"></a>00359   printf(<span class="stringliteral">"%.1e\t"</span>,t_fft);
<a name="l00360"></a>00360 
<a name="l00362"></a>00362   <span class="keywordflow">if</span>(test_ndft)
<a name="l00363"></a>00363     {
<a name="l00364"></a>00364       <a class="code" href="group__nfftutil.html#g4df074728562efbb458f6662e649d1d5" title="Swapping of two vectors.">NFFT_SWAP_complex</a>(p.<a class="code" href="structnfft__plan.html#23409aec68871e9a56f11711e2891691" title="Vector of Fourier coefficients, \ size is N_total float_types.">f_hat</a>,swapndft);
<a name="l00365"></a>00365       t_ndft=0;
<a name="l00366"></a>00366       r=0;
<a name="l00367"></a>00367       <span class="keywordflow">while</span>(t_ndft&lt;0.1)
<a name="l00368"></a>00368         {
<a name="l00369"></a>00369           r++;
<a name="l00370"></a>00370           t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00371"></a>00371           <a class="code" href="group__nfft.html#g03975608fdf8cfd8757f1f52b43ec51b" title="Computes an adjoint NDFT, see the definition.">ndft_adjoint</a>(&amp;p);
<a name="l00372"></a>00372           t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00373"></a>00373           t_ndft+=t;
<a name="l00374"></a>00374         }
<a name="l00375"></a>00375       t_ndft/=r;
<a name="l00376"></a>00376       printf(<span class="stringliteral">"%.1e\t"</span>,t_ndft);
<a name="l00377"></a>00377       <a class="code" href="group__nfftutil.html#g4df074728562efbb458f6662e649d1d5" title="Swapping of two vectors.">NFFT_SWAP_complex</a>(p.<a class="code" href="structnfft__plan.html#23409aec68871e9a56f11711e2891691" title="Vector of Fourier coefficients, \ size is N_total float_types.">f_hat</a>,swapndft);
<a name="l00378"></a>00378     }
<a name="l00379"></a>00379   <span class="keywordflow">else</span>
<a name="l00380"></a>00380     printf(<span class="stringliteral">"\t"</span>);
<a name="l00381"></a>00381 
<a name="l00383"></a>00383   t_nfft=0;
<a name="l00384"></a>00384   r=0;
<a name="l00385"></a>00385   <span class="keywordflow">while</span>(t_nfft&lt;0.1)
<a name="l00386"></a>00386     {
<a name="l00387"></a>00387       r++;
<a name="l00388"></a>00388       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00389"></a>00389       <a class="code" href="group__nfft.html#g4b44c1dd52026dcb494dc735f0fa5b08" title="Computes an adjoint NFFT, see the definition.">nfft_adjoint</a>(&amp;p);
<a name="l00390"></a>00390       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00391"></a>00391       t_nfft+=t;
<a name="l00392"></a>00392     }
<a name="l00393"></a>00393   t_nfft/=r;
<a name="l00394"></a>00394   printf(<span class="stringliteral">"%.1e\t"</span>,t_nfft);
<a name="l00395"></a>00395   <span class="keywordflow">if</span>(test_ndft)
<a name="l00396"></a>00396     printf(<span class="stringliteral">"(%.1e)\t"</span>,<a class="code" href="group__nfftutil.html#gcdfad5420393c822ecc1602d9c164090" title="Computes .">nfft_error_l_2_complex</a>(swapndft, p.<a class="code" href="structnfft__plan.html#23409aec68871e9a56f11711e2891691" title="Vector of Fourier coefficients, \ size is N_total float_types.">f_hat</a>, p.<a class="code" href="structnfft__plan.html#d33daddf76670c8731c759bf74ad0d22" title="Total number of Fourier \ coefficients.">N_total</a>));
<a name="l00397"></a>00397 
<a name="l00399"></a>00399   t_nfft=0;
<a name="l00400"></a>00400   r=0;
<a name="l00401"></a>00401   <span class="keywordflow">while</span>(t_nfft&lt;0.1)
<a name="l00402"></a>00402     {
<a name="l00403"></a>00403       r++;
<a name="l00404"></a>00404       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00405"></a>00405       nfft_adjoint_1d(&amp;p);
<a name="l00406"></a>00406       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00407"></a>00407       t_nfft+=t;
<a name="l00408"></a>00408     }
<a name="l00409"></a>00409   t_nfft/=r;
<a name="l00410"></a>00410   printf(<span class="stringliteral">"%.1e\t"</span>,t_nfft);
<a name="l00411"></a>00411   <span class="keywordflow">if</span>(test_ndft)
<a name="l00412"></a>00412     printf(<span class="stringliteral">"(%.1e)\t"</span>,<a class="code" href="group__nfftutil.html#gcdfad5420393c822ecc1602d9c164090" title="Computes .">nfft_error_l_2_complex</a>(swapndft, p.<a class="code" href="structnfft__plan.html#23409aec68871e9a56f11711e2891691" title="Vector of Fourier coefficients, \ size is N_total float_types.">f_hat</a>, p.<a class="code" href="structnfft__plan.html#d33daddf76670c8731c759bf74ad0d22" title="Total number of Fourier \ coefficients.">N_total</a>));
<a name="l00413"></a>00413 
<a name="l00414"></a>00414   printf(<span class="stringliteral">"\n"</span>);
<a name="l00415"></a>00415 
<a name="l00416"></a>00416   <a class="code" href="nfft3_8h.html#b8a0db03dda1317a8a3d922e0e4e8aaa">nfft_free</a>(swapndft);
<a name="l00417"></a>00417   fftw_destroy_plan(p_fft);
<a name="l00418"></a>00418   <a class="code" href="group__nfft.html#g614f9f7af5b0d5491afa9495393c4dc3" title="Destroys a transform plan.">nfft_finalize</a>(&amp;p);
<a name="l00419"></a>00419 }
<a name="l00420"></a>00420 
<a name="l00421"></a>00421 
<a name="l00422"></a>00422 
<a name="l00423"></a>00423 
<a name="l00424"></a>00424 <span class="keywordtype">void</span> measure_time_nfft_XXX4(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> N, <span class="keywordtype">unsigned</span> test_ndft)
<a name="l00425"></a>00425 {
<a name="l00426"></a>00426   <span class="keywordtype">int</span> j,r, M, NN[d], nn[d];
<a name="l00427"></a>00427   <span class="keywordtype">double</span> t, t_fft, t_ndft, t_nfft;
<a name="l00428"></a>00428 
<a name="l00429"></a>00429   <a class="code" href="structnfft__plan.html" title="Structure for a NFFT plan.">nfft_plan</a> p;
<a name="l00430"></a>00430   fftw_plan p_fft;
<a name="l00431"></a>00431 
<a name="l00432"></a>00432   printf(<span class="stringliteral">"%d\t"</span>,(<span class="keywordtype">int</span>)(log(N)/log(2)*d+0.5)); fflush(stdout);
<a name="l00433"></a>00433 
<a name="l00434"></a>00434   <span class="keywordflow">for</span>(r=0,M=1;r&lt;d;r++)
<a name="l00435"></a>00435     {
<a name="l00436"></a>00436       M=N*M;
<a name="l00437"></a>00437       NN[r]=N;
<a name="l00438"></a>00438       nn[r]=2*N;
<a name="l00439"></a>00439     }
<a name="l00440"></a>00440 
<a name="l00441"></a>00441   <a class="code" href="group__nfft.html#g406f05717c6299b918261c61aaa9de23" title="Initialisation of a transform plan, guru.">nfft_init_guru</a>(&amp;p, d, NN, M, nn, 4,
<a name="l00442"></a>00442      <a class="code" href="group__nfft.html#gda3a356fdaf5840f98374a0a7aaf3e9c" title="If this flag is set, the deconvolution step (the multiplication with the diagonal...">PRE_PHI_HUT</a>|
<a name="l00443"></a>00443      <a class="code" href="group__nfft.html#g959463a5c7723ccef5057ddcb784b40c" title="If this flag is set, the convolution step (the multiplication with the sparse matrix...">PRE_PSI</a>|
<a name="l00444"></a>00444      <a class="code" href="group__nfft.html#g02d52cb02b6cfdbc3e4d5fd4de1aef9e" title="If this flag is set, (de)allocation of the vector of Fourier coefficients is done...">MALLOC_F_HAT</a>| <a class="code" href="group__nfft.html#g353185384f87de0dc4320a82652ef724" title="If this flag is set, (de)allocation of the node vector is done.">MALLOC_X</a>| <a class="code" href="group__nfft.html#ga7b5098f4136080bbe0dd989973e2a69" title="If this flag is set, (de)allocation of the vector of samples is done.">MALLOC_F</a>|
<a name="l00445"></a>00445      <a class="code" href="group__nfft.html#gd3fe6867a3351441c6f44dd5a3746f5b" title="If this flag is set, fftw_init/fftw_finalize is called.">FFTW_INIT</a>| <a class="code" href="group__nfft.html#g9193f768d5839892d0e303080c370eaf" title="If this flag is set, FFTW uses disjoint input/output vectors.">FFT_OUT_OF_PLACE</a>,
<a name="l00446"></a>00446      FFTW_MEASURE| FFTW_DESTROY_INPUT);
<a name="l00447"></a>00447 
<a name="l00448"></a>00448   p_fft=fftw_plan_dft(d, NN, p.<a class="code" href="structnfft__plan.html#23409aec68871e9a56f11711e2891691" title="Vector of Fourier coefficients, \ size is N_total float_types.">f_hat</a>, p.<a class="code" href="structnfft__plan.html#fa27a166f809acf70ae27e5e6f28daa5" title="Vector of samples, \ size is M_total float types.">f</a>, FFTW_FORWARD, FFTW_MEASURE);
<a name="l00449"></a>00449 
<a name="l00450"></a>00450   <span class="keywordtype">double</span> _Complex *swapndft=(<span class="keywordtype">double</span> _Complex*)<a class="code" href="nfft3_8h.html#afe6167438c5de4d3d4c509f66a6694e" title="Include header for FFTW3 library for its complex type.">nfft_malloc</a>(p.<a class="code" href="structnfft__plan.html#df33ce87c35b396c50d214d9bdeeefe6" title="Total number of samples.">M_total</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span> _Complex));
<a name="l00451"></a>00451 
<a name="l00453"></a>00453   <a class="code" href="group__nfftutil.html#ga44184ac2c1452221508e7640f391c34" title="Inits a vector of random double numbers in .">nfft_vrand_shifted_unit_double</a>(p.<a class="code" href="structnfft__plan.html#7eb64fb5fedfba0ec75261e777e020c0" title="Nodes in time/spatial domain, size is  doubles.">x</a>, p.<a class="code" href="structnfft__plan.html#e39d4867eac948d96abbe3fc930b39a8" title="Dimension, rank.">d</a>*p.<a class="code" href="structnfft__plan.html#df33ce87c35b396c50d214d9bdeeefe6" title="Total number of samples.">M_total</a>);
<a name="l00454"></a>00454 
<a name="l00455"></a>00455   <span class="comment">//for(j=0;j&lt;2*M;j+=2)</span>
<a name="l00456"></a>00456   <span class="comment">//   p.x[j]=0.5*p.x[j]+0.25*(p.x[j]&gt;=0?1:-1);</span>
<a name="l00457"></a>00457 
<a name="l00458"></a>00458   <span class="comment">//qsort(p.x,p.M_total,d*sizeof(double),comp1);</span>
<a name="l00459"></a>00459   <span class="comment">//nfft_vpr_double(p.x,p.M_total,"nodes x");</span>
<a name="l00460"></a>00460 
<a name="l00461"></a>00461   <a class="code" href="group__nfft.html#gfd7b278b6ed04d929212b4807dd195f0" title="Precomputation for a transform plan.">nfft_precompute_one_psi</a>(&amp;p);
<a name="l00462"></a>00462 
<a name="l00464"></a>00464   <a class="code" href="group__nfftutil.html#g5f53c8cd0b2f33200fce15ecf75a0685" title="Inits a vector of random complex numbers in .">nfft_vrand_unit_complex</a>(p.<a class="code" href="structnfft__plan.html#23409aec68871e9a56f11711e2891691" title="Vector of Fourier coefficients, \ size is N_total float_types.">f_hat</a>, p.<a class="code" href="structnfft__plan.html#d33daddf76670c8731c759bf74ad0d22" title="Total number of Fourier \ coefficients.">N_total</a>);
<a name="l00465"></a>00465 
<a name="l00467"></a>00467   t_fft=0;
<a name="l00468"></a>00468   r=0;
<a name="l00469"></a>00469   <span class="keywordflow">while</span>(t_fft&lt;0.1)
<a name="l00470"></a>00470     {
<a name="l00471"></a>00471       r++;
<a name="l00472"></a>00472       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00473"></a>00473       fftw_execute(p_fft);
<a name="l00474"></a>00474       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00475"></a>00475       t_fft+=t;
<a name="l00476"></a>00476     }
<a name="l00477"></a>00477   t_fft/=r;
<a name="l00478"></a>00478 
<a name="l00479"></a>00479   printf(<span class="stringliteral">"%.1e\t"</span>,t_fft);
<a name="l00480"></a>00480 
<a name="l00482"></a>00482   <a class="code" href="group__nfftutil.html#g5f53c8cd0b2f33200fce15ecf75a0685" title="Inits a vector of random complex numbers in .">nfft_vrand_unit_complex</a>(p.<a class="code" href="structnfft__plan.html#23409aec68871e9a56f11711e2891691" title="Vector of Fourier coefficients, \ size is N_total float_types.">f_hat</a>, p.<a class="code" href="structnfft__plan.html#d33daddf76670c8731c759bf74ad0d22" title="Total number of Fourier \ coefficients.">N_total</a>);
<a name="l00483"></a>00483 
<a name="l00485"></a>00485   <span class="keywordflow">if</span>(test_ndft)
<a name="l00486"></a>00486     {
<a name="l00487"></a>00487       <a class="code" href="group__nfftutil.html#g4df074728562efbb458f6662e649d1d5" title="Swapping of two vectors.">NFFT_SWAP_complex</a>(p.<a class="code" href="structnfft__plan.html#fa27a166f809acf70ae27e5e6f28daa5" title="Vector of samples, \ size is M_total float types.">f</a>,swapndft);
<a name="l00488"></a>00488       t_ndft=0;
<a name="l00489"></a>00489       r=0;
<a name="l00490"></a>00490       <span class="keywordflow">while</span>(t_ndft&lt;0.1)
<a name="l00491"></a>00491         {
<a name="l00492"></a>00492           r++;
<a name="l00493"></a>00493           t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00494"></a>00494           <a class="code" href="group__nfft.html#g27ef1bcb8dd3a3fc1cdbeee368ec1acf" title="Computes a NDFT, see the definition.">ndft_trafo</a>(&amp;p);
<a name="l00495"></a>00495           t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00496"></a>00496           t_ndft+=t;
<a name="l00497"></a>00497         }
<a name="l00498"></a>00498       t_ndft/=r;
<a name="l00499"></a>00499       printf(<span class="stringliteral">"%.1e\t"</span>,t_ndft);
<a name="l00500"></a>00500 
<a name="l00501"></a>00501       <span class="comment">//printf("f=%e+i%e\t",creal(p.f[0]),cimag(p.f[0]));</span>
<a name="l00502"></a>00502 
<a name="l00503"></a>00503       <a class="code" href="group__nfftutil.html#g4df074728562efbb458f6662e649d1d5" title="Swapping of two vectors.">NFFT_SWAP_complex</a>(p.<a class="code" href="structnfft__plan.html#fa27a166f809acf70ae27e5e6f28daa5" title="Vector of samples, \ size is M_total float types.">f</a>,swapndft);
<a name="l00504"></a>00504     }
<a name="l00505"></a>00505   <span class="keywordflow">else</span>
<a name="l00506"></a>00506     printf(<span class="stringliteral">"\t"</span>);
<a name="l00507"></a>00507 
<a name="l00509"></a>00509   t_nfft=0;
<a name="l00510"></a>00510   r=0;
<a name="l00511"></a>00511   <span class="keywordflow">while</span>(t_nfft&lt;0.1)
<a name="l00512"></a>00512     {
<a name="l00513"></a>00513       r++;
<a name="l00514"></a>00514       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00515"></a>00515       <a class="code" href="group__nfft.html#g9f1e6bd9f7f956a8679e6b413c97b421" title="Computes a NFFT, see the definition.">nfft_trafo</a>(&amp;p);
<a name="l00516"></a>00516       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00517"></a>00517       t_nfft+=t;
<a name="l00518"></a>00518     }
<a name="l00519"></a>00519   t_nfft/=r;
<a name="l00520"></a>00520   printf(<span class="stringliteral">"%.1e\t"</span>,t_nfft);
<a name="l00521"></a>00521   <span class="keywordflow">if</span>(test_ndft)
<a name="l00522"></a>00522     printf(<span class="stringliteral">"(%.1e)\t"</span>,<a class="code" href="group__nfftutil.html#gcdfad5420393c822ecc1602d9c164090" title="Computes .">nfft_error_l_2_complex</a>(swapndft, p.<a class="code" href="structnfft__plan.html#fa27a166f809acf70ae27e5e6f28daa5" title="Vector of samples, \ size is M_total float types.">f</a>, p.<a class="code" href="structnfft__plan.html#df33ce87c35b396c50d214d9bdeeefe6" title="Total number of samples.">M_total</a>));
<a name="l00523"></a>00523 
<a name="l00524"></a>00524   <span class="comment">//printf("f=%e+i%e\t",creal(p.f[0]),cimag(p.f[0]));</span>
<a name="l00525"></a>00525 
<a name="l00527"></a>00527   t_nfft=0;
<a name="l00528"></a>00528   r=0;
<a name="l00529"></a>00529   <span class="keywordflow">while</span>(t_nfft&lt;0.1)
<a name="l00530"></a>00530     {
<a name="l00531"></a>00531       r++;
<a name="l00532"></a>00532       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00533"></a>00533       nfft_trafo_2d(&amp;p);
<a name="l00534"></a>00534       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00535"></a>00535       t_nfft+=t;
<a name="l00536"></a>00536     }
<a name="l00537"></a>00537   t_nfft/=r;
<a name="l00538"></a>00538   printf(<span class="stringliteral">"%.1e\t"</span>,t_nfft);
<a name="l00539"></a>00539   <span class="keywordflow">if</span>(test_ndft)
<a name="l00540"></a>00540     printf(<span class="stringliteral">"(%.1e)\t"</span>,<a class="code" href="group__nfftutil.html#gcdfad5420393c822ecc1602d9c164090" title="Computes .">nfft_error_l_2_complex</a>(swapndft, p.<a class="code" href="structnfft__plan.html#fa27a166f809acf70ae27e5e6f28daa5" title="Vector of samples, \ size is M_total float types.">f</a>, p.<a class="code" href="structnfft__plan.html#df33ce87c35b396c50d214d9bdeeefe6" title="Total number of samples.">M_total</a>));
<a name="l00541"></a>00541 
<a name="l00542"></a>00542   <span class="comment">//printf("f=%e+i%e\t",creal(p.f[0]),cimag(p.f[0]));</span>
<a name="l00543"></a>00543 
<a name="l00544"></a>00544   printf(<span class="stringliteral">"\n"</span>);
<a name="l00545"></a>00545 
<a name="l00546"></a>00546   <a class="code" href="nfft3_8h.html#b8a0db03dda1317a8a3d922e0e4e8aaa">nfft_free</a>(swapndft);
<a name="l00547"></a>00547   fftw_destroy_plan(p_fft);
<a name="l00548"></a>00548   <a class="code" href="group__nfft.html#g614f9f7af5b0d5491afa9495393c4dc3" title="Destroys a transform plan.">nfft_finalize</a>(&amp;p);
<a name="l00549"></a>00549 }
<a name="l00550"></a>00550 
<a name="l00551"></a>00551 
<a name="l00552"></a>00552 <span class="keywordtype">void</span> measure_time_nfft_XXX5(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> N, <span class="keywordtype">unsigned</span> test_ndft)
<a name="l00553"></a>00553 {
<a name="l00554"></a>00554   <span class="keywordtype">int</span> j,r, M, NN[d], nn[d];
<a name="l00555"></a>00555   <span class="keywordtype">double</span> t, t_fft, t_ndft, t_nfft;
<a name="l00556"></a>00556 
<a name="l00557"></a>00557   <a class="code" href="structnfft__plan.html" title="Structure for a NFFT plan.">nfft_plan</a> p;
<a name="l00558"></a>00558   fftw_plan p_fft;
<a name="l00559"></a>00559 
<a name="l00560"></a>00560   printf(<span class="stringliteral">"%d\t"</span>,(<span class="keywordtype">int</span>)(log(N)/log(2)*d+0.5)); fflush(stdout);
<a name="l00561"></a>00561 
<a name="l00562"></a>00562   <span class="keywordflow">for</span>(r=0,M=1;r&lt;d;r++)
<a name="l00563"></a>00563     {
<a name="l00564"></a>00564       M=N*M;
<a name="l00565"></a>00565       NN[r]=N;
<a name="l00566"></a>00566       nn[r]=2*N;
<a name="l00567"></a>00567     }
<a name="l00568"></a>00568 
<a name="l00569"></a>00569   <a class="code" href="group__nfft.html#g406f05717c6299b918261c61aaa9de23" title="Initialisation of a transform plan, guru.">nfft_init_guru</a>(&amp;p, d, NN, M, nn, 4,
<a name="l00570"></a>00570      <a class="code" href="group__nfft.html#gda3a356fdaf5840f98374a0a7aaf3e9c" title="If this flag is set, the deconvolution step (the multiplication with the diagonal...">PRE_PHI_HUT</a>|
<a name="l00571"></a>00571      <a class="code" href="group__nfft.html#g959463a5c7723ccef5057ddcb784b40c" title="If this flag is set, the convolution step (the multiplication with the sparse matrix...">PRE_PSI</a>|
<a name="l00572"></a>00572      <a class="code" href="group__nfft.html#g02d52cb02b6cfdbc3e4d5fd4de1aef9e" title="If this flag is set, (de)allocation of the vector of Fourier coefficients is done...">MALLOC_F_HAT</a>| <a class="code" href="group__nfft.html#g353185384f87de0dc4320a82652ef724" title="If this flag is set, (de)allocation of the node vector is done.">MALLOC_X</a>| <a class="code" href="group__nfft.html#ga7b5098f4136080bbe0dd989973e2a69" title="If this flag is set, (de)allocation of the vector of samples is done.">MALLOC_F</a>|
<a name="l00573"></a>00573      <a class="code" href="group__nfft.html#gd3fe6867a3351441c6f44dd5a3746f5b" title="If this flag is set, fftw_init/fftw_finalize is called.">FFTW_INIT</a>| <a class="code" href="group__nfft.html#g9193f768d5839892d0e303080c370eaf" title="If this flag is set, FFTW uses disjoint input/output vectors.">FFT_OUT_OF_PLACE</a>,
<a name="l00574"></a>00574      FFTW_MEASURE| FFTW_DESTROY_INPUT);
<a name="l00575"></a>00575 
<a name="l00576"></a>00576   p_fft=fftw_plan_dft(d, NN, p.<a class="code" href="structnfft__plan.html#fa27a166f809acf70ae27e5e6f28daa5" title="Vector of samples, \ size is M_total float types.">f</a>, p.<a class="code" href="structnfft__plan.html#23409aec68871e9a56f11711e2891691" title="Vector of Fourier coefficients, \ size is N_total float_types.">f_hat</a>, FFTW_FORWARD, FFTW_MEASURE);
<a name="l00577"></a>00577 
<a name="l00578"></a>00578   <span class="keywordtype">double</span> _Complex *swapndft=(<span class="keywordtype">double</span> _Complex*)<a class="code" href="nfft3_8h.html#afe6167438c5de4d3d4c509f66a6694e" title="Include header for FFTW3 library for its complex type.">nfft_malloc</a>(p.<a class="code" href="structnfft__plan.html#d33daddf76670c8731c759bf74ad0d22" title="Total number of Fourier \ coefficients.">N_total</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span> _Complex));
<a name="l00579"></a>00579 
<a name="l00581"></a>00581   <a class="code" href="group__nfftutil.html#ga44184ac2c1452221508e7640f391c34" title="Inits a vector of random double numbers in .">nfft_vrand_shifted_unit_double</a>(p.<a class="code" href="structnfft__plan.html#7eb64fb5fedfba0ec75261e777e020c0" title="Nodes in time/spatial domain, size is  doubles.">x</a>, p.<a class="code" href="structnfft__plan.html#e39d4867eac948d96abbe3fc930b39a8" title="Dimension, rank.">d</a>*p.<a class="code" href="structnfft__plan.html#df33ce87c35b396c50d214d9bdeeefe6" title="Total number of samples.">M_total</a>);
<a name="l00582"></a>00582 
<a name="l00583"></a>00583   <span class="comment">//sort_nodes(p.x,p.d,p.M_total,</span>
<a name="l00584"></a>00584 
<a name="l00585"></a>00585   <a class="code" href="group__nfft.html#gfd7b278b6ed04d929212b4807dd195f0" title="Precomputation for a transform plan.">nfft_precompute_one_psi</a>(&amp;p);
<a name="l00586"></a>00586 
<a name="l00588"></a>00588   <a class="code" href="group__nfftutil.html#g5f53c8cd0b2f33200fce15ecf75a0685" title="Inits a vector of random complex numbers in .">nfft_vrand_unit_complex</a>(p.<a class="code" href="structnfft__plan.html#fa27a166f809acf70ae27e5e6f28daa5" title="Vector of samples, \ size is M_total float types.">f</a>, p.<a class="code" href="structnfft__plan.html#df33ce87c35b396c50d214d9bdeeefe6" title="Total number of samples.">M_total</a>);
<a name="l00589"></a>00589 
<a name="l00591"></a>00591   t_fft=0;
<a name="l00592"></a>00592   r=0;
<a name="l00593"></a>00593   <span class="keywordflow">while</span>(t_fft&lt;0.1)
<a name="l00594"></a>00594     {
<a name="l00595"></a>00595       r++;
<a name="l00596"></a>00596       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00597"></a>00597       fftw_execute(p_fft);
<a name="l00598"></a>00598       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00599"></a>00599       t_fft+=t;
<a name="l00600"></a>00600     }
<a name="l00601"></a>00601   t_fft/=r;
<a name="l00602"></a>00602 
<a name="l00603"></a>00603   printf(<span class="stringliteral">"%.1e\t"</span>,t_fft);
<a name="l00604"></a>00604 
<a name="l00606"></a>00606   <a class="code" href="group__nfftutil.html#g5f53c8cd0b2f33200fce15ecf75a0685" title="Inits a vector of random complex numbers in .">nfft_vrand_unit_complex</a>(p.<a class="code" href="structnfft__plan.html#fa27a166f809acf70ae27e5e6f28daa5" title="Vector of samples, \ size is M_total float types.">f</a>, p.<a class="code" href="structnfft__plan.html#df33ce87c35b396c50d214d9bdeeefe6" title="Total number of samples.">M_total</a>);
<a name="l00607"></a>00607 
<a name="l00609"></a>00609   <span class="keywordflow">if</span>(test_ndft)
<a name="l00610"></a>00610     {
<a name="l00611"></a>00611       <a class="code" href="group__nfftutil.html#g4df074728562efbb458f6662e649d1d5" title="Swapping of two vectors.">NFFT_SWAP_complex</a>(p.<a class="code" href="structnfft__plan.html#23409aec68871e9a56f11711e2891691" title="Vector of Fourier coefficients, \ size is N_total float_types.">f_hat</a>,swapndft);
<a name="l00612"></a>00612       t_ndft=0;
<a name="l00613"></a>00613       r=0;
<a name="l00614"></a>00614       <span class="keywordflow">while</span>(t_ndft&lt;0.1)
<a name="l00615"></a>00615         {
<a name="l00616"></a>00616           r++;
<a name="l00617"></a>00617           t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00618"></a>00618           <a class="code" href="group__nfft.html#g03975608fdf8cfd8757f1f52b43ec51b" title="Computes an adjoint NDFT, see the definition.">ndft_adjoint</a>(&amp;p);
<a name="l00619"></a>00619           t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00620"></a>00620           t_ndft+=t;
<a name="l00621"></a>00621         }
<a name="l00622"></a>00622       t_ndft/=r;
<a name="l00623"></a>00623       printf(<span class="stringliteral">"%.1e\t"</span>,t_ndft);
<a name="l00624"></a>00624 
<a name="l00625"></a>00625       <span class="comment">//printf("\nf_hat=%e+i%e\t",creal(p.f_hat[0]),cimag(p.f_hat[0]));</span>
<a name="l00626"></a>00626 
<a name="l00627"></a>00627       <a class="code" href="group__nfftutil.html#g4df074728562efbb458f6662e649d1d5" title="Swapping of two vectors.">NFFT_SWAP_complex</a>(p.<a class="code" href="structnfft__plan.html#23409aec68871e9a56f11711e2891691" title="Vector of Fourier coefficients, \ size is N_total float_types.">f_hat</a>,swapndft);
<a name="l00628"></a>00628     }
<a name="l00629"></a>00629   <span class="keywordflow">else</span>
<a name="l00630"></a>00630     printf(<span class="stringliteral">"\t"</span>);
<a name="l00631"></a>00631 
<a name="l00633"></a>00633   t_nfft=0;
<a name="l00634"></a>00634   r=0;
<a name="l00635"></a>00635   <span class="keywordflow">while</span>(t_nfft&lt;0.1)
<a name="l00636"></a>00636     {
<a name="l00637"></a>00637       r++;
<a name="l00638"></a>00638       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00639"></a>00639       <a class="code" href="group__nfft.html#g4b44c1dd52026dcb494dc735f0fa5b08" title="Computes an adjoint NFFT, see the definition.">nfft_adjoint</a>(&amp;p);
<a name="l00640"></a>00640       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00641"></a>00641       t_nfft+=t;
<a name="l00642"></a>00642     }
<a name="l00643"></a>00643   t_nfft/=r;
<a name="l00644"></a>00644   printf(<span class="stringliteral">"%.1e\t"</span>,t_nfft);
<a name="l00645"></a>00645   <span class="keywordflow">if</span>(test_ndft)
<a name="l00646"></a>00646     printf(<span class="stringliteral">"(%.1e)\t"</span>,<a class="code" href="group__nfftutil.html#gcdfad5420393c822ecc1602d9c164090" title="Computes .">nfft_error_l_2_complex</a>(swapndft, p.<a class="code" href="structnfft__plan.html#23409aec68871e9a56f11711e2891691" title="Vector of Fourier coefficients, \ size is N_total float_types.">f_hat</a>, p.<a class="code" href="structnfft__plan.html#d33daddf76670c8731c759bf74ad0d22" title="Total number of Fourier \ coefficients.">N_total</a>));
<a name="l00647"></a>00647 
<a name="l00648"></a>00648   <span class="comment">//printf("\nf_hat=%e+i%e\t",creal(p.f_hat[0]),cimag(p.f_hat[0]));</span>
<a name="l00649"></a>00649 
<a name="l00651"></a>00651   t_nfft=0;
<a name="l00652"></a>00652   r=0;
<a name="l00653"></a>00653   <span class="keywordflow">while</span>(t_nfft&lt;0.1)
<a name="l00654"></a>00654     {
<a name="l00655"></a>00655       r++;
<a name="l00656"></a>00656       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00657"></a>00657       nfft_adjoint_2d(&amp;p);
<a name="l00658"></a>00658       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00659"></a>00659       t_nfft+=t;
<a name="l00660"></a>00660     }
<a name="l00661"></a>00661   t_nfft/=r;
<a name="l00662"></a>00662   printf(<span class="stringliteral">"%.1e\t"</span>,t_nfft);
<a name="l00663"></a>00663   <span class="keywordflow">if</span>(test_ndft)
<a name="l00664"></a>00664     printf(<span class="stringliteral">"(%.1e)\t"</span>,<a class="code" href="group__nfftutil.html#gcdfad5420393c822ecc1602d9c164090" title="Computes .">nfft_error_l_2_complex</a>(swapndft, p.<a class="code" href="structnfft__plan.html#23409aec68871e9a56f11711e2891691" title="Vector of Fourier coefficients, \ size is N_total float_types.">f_hat</a>, p.<a class="code" href="structnfft__plan.html#d33daddf76670c8731c759bf74ad0d22" title="Total number of Fourier \ coefficients.">N_total</a>));
<a name="l00665"></a>00665 
<a name="l00666"></a>00666   <span class="comment">//printf("\nf_hat=%e+i%e\t",creal(p.f_hat[0]),cimag(p.f_hat[0]));</span>
<a name="l00667"></a>00667 
<a name="l00668"></a>00668   printf(<span class="stringliteral">"\n"</span>);
<a name="l00669"></a>00669 
<a name="l00670"></a>00670   <a class="code" href="nfft3_8h.html#b8a0db03dda1317a8a3d922e0e4e8aaa">nfft_free</a>(swapndft);
<a name="l00671"></a>00671   fftw_destroy_plan(p_fft);
<a name="l00672"></a>00672   <a class="code" href="group__nfft.html#g614f9f7af5b0d5491afa9495393c4dc3" title="Destroys a transform plan.">nfft_finalize</a>(&amp;p);
<a name="l00673"></a>00673 }
<a name="l00674"></a>00674 
<a name="l00675"></a>00675 
<a name="l00676"></a>00676 <span class="keywordtype">void</span> measure_time_nfft_XXX6(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> N, <span class="keywordtype">unsigned</span> test_ndft)
<a name="l00677"></a>00677 {
<a name="l00678"></a>00678   <span class="keywordtype">int</span> j,r, M, NN[d], nn[d];
<a name="l00679"></a>00679   <span class="keywordtype">double</span> t, t_fft, t_ndft, t_nfft;
<a name="l00680"></a>00680 
<a name="l00681"></a>00681   <a class="code" href="structnfft__plan.html" title="Structure for a NFFT plan.">nfft_plan</a> p;
<a name="l00682"></a>00682   fftw_plan p_fft;
<a name="l00683"></a>00683 
<a name="l00684"></a>00684   printf(<span class="stringliteral">"%d\t"</span>,(<span class="keywordtype">int</span>)(log(N)/log(2)*d+0.5)); fflush(stdout);
<a name="l00685"></a>00685 
<a name="l00686"></a>00686   <span class="keywordflow">for</span>(r=0,M=1;r&lt;d;r++)
<a name="l00687"></a>00687     {
<a name="l00688"></a>00688       M=N*M;
<a name="l00689"></a>00689       NN[r]=N;
<a name="l00690"></a>00690       nn[r]=2*N;
<a name="l00691"></a>00691     }
<a name="l00692"></a>00692 
<a name="l00693"></a>00693   <a class="code" href="group__nfft.html#g406f05717c6299b918261c61aaa9de23" title="Initialisation of a transform plan, guru.">nfft_init_guru</a>(&amp;p, d, NN, M, nn, 2,
<a name="l00694"></a>00694      <a class="code" href="group__nfft.html#gda3a356fdaf5840f98374a0a7aaf3e9c" title="If this flag is set, the deconvolution step (the multiplication with the diagonal...">PRE_PHI_HUT</a>|
<a name="l00695"></a>00695      <a class="code" href="group__nfft.html#g01ebac2d2071639df189f083fc9f24eb" title="If this flag is set, the convolution step (the multiplication with the sparse matrix...">FG_PSI</a>|
<a name="l00696"></a>00696      <a class="code" href="group__nfft.html#g02d52cb02b6cfdbc3e4d5fd4de1aef9e" title="If this flag is set, (de)allocation of the vector of Fourier coefficients is done...">MALLOC_F_HAT</a>| <a class="code" href="group__nfft.html#g353185384f87de0dc4320a82652ef724" title="If this flag is set, (de)allocation of the node vector is done.">MALLOC_X</a>| <a class="code" href="group__nfft.html#ga7b5098f4136080bbe0dd989973e2a69" title="If this flag is set, (de)allocation of the vector of samples is done.">MALLOC_F</a>|
<a name="l00697"></a>00697      <a class="code" href="group__nfft.html#gd3fe6867a3351441c6f44dd5a3746f5b" title="If this flag is set, fftw_init/fftw_finalize is called.">FFTW_INIT</a>| <a class="code" href="group__nfft.html#g9193f768d5839892d0e303080c370eaf" title="If this flag is set, FFTW uses disjoint input/output vectors.">FFT_OUT_OF_PLACE</a>,
<a name="l00698"></a>00698      FFTW_MEASURE| FFTW_DESTROY_INPUT);
<a name="l00699"></a>00699 
<a name="l00700"></a>00700   p_fft=fftw_plan_dft(d, NN, p.<a class="code" href="structnfft__plan.html#23409aec68871e9a56f11711e2891691" title="Vector of Fourier coefficients, \ size is N_total float_types.">f_hat</a>, p.<a class="code" href="structnfft__plan.html#fa27a166f809acf70ae27e5e6f28daa5" title="Vector of samples, \ size is M_total float types.">f</a>, FFTW_FORWARD, FFTW_MEASURE);
<a name="l00701"></a>00701 
<a name="l00702"></a>00702   <span class="keywordtype">double</span> _Complex *swapndft=(<span class="keywordtype">double</span> _Complex*)<a class="code" href="nfft3_8h.html#afe6167438c5de4d3d4c509f66a6694e" title="Include header for FFTW3 library for its complex type.">nfft_malloc</a>(p.<a class="code" href="structnfft__plan.html#df33ce87c35b396c50d214d9bdeeefe6" title="Total number of samples.">M_total</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span> _Complex));
<a name="l00703"></a>00703 
<a name="l00705"></a>00705   <a class="code" href="group__nfftutil.html#ga44184ac2c1452221508e7640f391c34" title="Inits a vector of random double numbers in .">nfft_vrand_shifted_unit_double</a>(p.<a class="code" href="structnfft__plan.html#7eb64fb5fedfba0ec75261e777e020c0" title="Nodes in time/spatial domain, size is  doubles.">x</a>, p.<a class="code" href="structnfft__plan.html#e39d4867eac948d96abbe3fc930b39a8" title="Dimension, rank.">d</a>*p.<a class="code" href="structnfft__plan.html#df33ce87c35b396c50d214d9bdeeefe6" title="Total number of samples.">M_total</a>);
<a name="l00706"></a>00706 
<a name="l00707"></a>00707   <span class="comment">//qsort(p.x,p.M_total,d*sizeof(double),comp1);</span>
<a name="l00708"></a>00708   <span class="comment">//nfft_vpr_double(p.x,p.M_total,"nodes x");</span>
<a name="l00709"></a>00709 
<a name="l00710"></a>00710   <a class="code" href="group__nfft.html#gfd7b278b6ed04d929212b4807dd195f0" title="Precomputation for a transform plan.">nfft_precompute_one_psi</a>(&amp;p);
<a name="l00711"></a>00711 
<a name="l00713"></a>00713   <a class="code" href="group__nfftutil.html#g5f53c8cd0b2f33200fce15ecf75a0685" title="Inits a vector of random complex numbers in .">nfft_vrand_unit_complex</a>(p.<a class="code" href="structnfft__plan.html#23409aec68871e9a56f11711e2891691" title="Vector of Fourier coefficients, \ size is N_total float_types.">f_hat</a>, p.<a class="code" href="structnfft__plan.html#d33daddf76670c8731c759bf74ad0d22" title="Total number of Fourier \ coefficients.">N_total</a>);
<a name="l00714"></a>00714 
<a name="l00716"></a>00716   t_fft=0;
<a name="l00717"></a>00717   r=0;
<a name="l00718"></a>00718   <span class="keywordflow">while</span>(t_fft&lt;0.1)
<a name="l00719"></a>00719     {
<a name="l00720"></a>00720       r++;
<a name="l00721"></a>00721       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00722"></a>00722       fftw_execute(p_fft);
<a name="l00723"></a>00723       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00724"></a>00724       t_fft+=t;
<a name="l00725"></a>00725     }
<a name="l00726"></a>00726   t_fft/=r;
<a name="l00727"></a>00727 
<a name="l00728"></a>00728   printf(<span class="stringliteral">"%.1e\t"</span>,t_fft);
<a name="l00729"></a>00729 
<a name="l00731"></a>00731   <a class="code" href="group__nfftutil.html#g5f53c8cd0b2f33200fce15ecf75a0685" title="Inits a vector of random complex numbers in .">nfft_vrand_unit_complex</a>(p.<a class="code" href="structnfft__plan.html#23409aec68871e9a56f11711e2891691" title="Vector of Fourier coefficients, \ size is N_total float_types.">f_hat</a>, p.<a class="code" href="structnfft__plan.html#d33daddf76670c8731c759bf74ad0d22" title="Total number of Fourier \ coefficients.">N_total</a>);
<a name="l00732"></a>00732 
<a name="l00734"></a>00734   <span class="keywordflow">if</span>(test_ndft)
<a name="l00735"></a>00735     {
<a name="l00736"></a>00736       <a class="code" href="group__nfftutil.html#g4df074728562efbb458f6662e649d1d5" title="Swapping of two vectors.">NFFT_SWAP_complex</a>(p.<a class="code" href="structnfft__plan.html#fa27a166f809acf70ae27e5e6f28daa5" title="Vector of samples, \ size is M_total float types.">f</a>,swapndft);
<a name="l00737"></a>00737       t_ndft=0;
<a name="l00738"></a>00738       r=0;
<a name="l00739"></a>00739       <span class="keywordflow">while</span>(t_ndft&lt;0.1)
<a name="l00740"></a>00740         {
<a name="l00741"></a>00741           r++;
<a name="l00742"></a>00742           t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00743"></a>00743           <a class="code" href="group__nfft.html#g27ef1bcb8dd3a3fc1cdbeee368ec1acf" title="Computes a NDFT, see the definition.">ndft_trafo</a>(&amp;p);
<a name="l00744"></a>00744           t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00745"></a>00745           t_ndft+=t;
<a name="l00746"></a>00746         }
<a name="l00747"></a>00747       t_ndft/=r;
<a name="l00748"></a>00748       printf(<span class="stringliteral">"%.1e\t"</span>,t_ndft);
<a name="l00749"></a>00749 
<a name="l00750"></a>00750       <span class="comment">//printf("f=%e+i%e\t",creal(p.f[0]),cimag(p.f[0]));</span>
<a name="l00751"></a>00751 
<a name="l00752"></a>00752       <a class="code" href="group__nfftutil.html#g4df074728562efbb458f6662e649d1d5" title="Swapping of two vectors.">NFFT_SWAP_complex</a>(p.<a class="code" href="structnfft__plan.html#fa27a166f809acf70ae27e5e6f28daa5" title="Vector of samples, \ size is M_total float types.">f</a>,swapndft);
<a name="l00753"></a>00753     }
<a name="l00754"></a>00754   <span class="keywordflow">else</span>
<a name="l00755"></a>00755     printf(<span class="stringliteral">"\t"</span>);
<a name="l00756"></a>00756 
<a name="l00758"></a>00758   t_nfft=0;
<a name="l00759"></a>00759   r=0;
<a name="l00760"></a>00760   <span class="keywordflow">while</span>(t_nfft&lt;0.1)
<a name="l00761"></a>00761     {
<a name="l00762"></a>00762       r++;
<a name="l00763"></a>00763       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00764"></a>00764       <a class="code" href="group__nfft.html#g9f1e6bd9f7f956a8679e6b413c97b421" title="Computes a NFFT, see the definition.">nfft_trafo</a>(&amp;p);
<a name="l00765"></a>00765       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00766"></a>00766       t_nfft+=t;
<a name="l00767"></a>00767     }
<a name="l00768"></a>00768   t_nfft/=r;
<a name="l00769"></a>00769   printf(<span class="stringliteral">"%.1e\t"</span>,t_nfft);
<a name="l00770"></a>00770   <span class="keywordflow">if</span>(test_ndft)
<a name="l00771"></a>00771     printf(<span class="stringliteral">"(%.1e)\t"</span>,<a class="code" href="group__nfftutil.html#gcdfad5420393c822ecc1602d9c164090" title="Computes .">nfft_error_l_2_complex</a>(swapndft, p.<a class="code" href="structnfft__plan.html#fa27a166f809acf70ae27e5e6f28daa5" title="Vector of samples, \ size is M_total float types.">f</a>, p.<a class="code" href="structnfft__plan.html#df33ce87c35b396c50d214d9bdeeefe6" title="Total number of samples.">M_total</a>));
<a name="l00772"></a>00772 
<a name="l00773"></a>00773   <span class="comment">//printf("f=%e+i%e\t",creal(p.f[0]),cimag(p.f[0]));</span>
<a name="l00774"></a>00774 
<a name="l00776"></a>00776   t_nfft=0;
<a name="l00777"></a>00777   r=0;
<a name="l00778"></a>00778   <span class="keywordflow">while</span>(t_nfft&lt;0.1)
<a name="l00779"></a>00779     {
<a name="l00780"></a>00780       r++;
<a name="l00781"></a>00781       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00782"></a>00782       nfft_trafo_3d(&amp;p);
<a name="l00783"></a>00783       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00784"></a>00784       t_nfft+=t;
<a name="l00785"></a>00785     }
<a name="l00786"></a>00786   t_nfft/=r;
<a name="l00787"></a>00787   printf(<span class="stringliteral">"%.1e\t"</span>,t_nfft);
<a name="l00788"></a>00788   <span class="keywordflow">if</span>(test_ndft)
<a name="l00789"></a>00789     printf(<span class="stringliteral">"(%.1e)\t"</span>,<a class="code" href="group__nfftutil.html#gcdfad5420393c822ecc1602d9c164090" title="Computes .">nfft_error_l_2_complex</a>(swapndft, p.<a class="code" href="structnfft__plan.html#fa27a166f809acf70ae27e5e6f28daa5" title="Vector of samples, \ size is M_total float types.">f</a>, p.<a class="code" href="structnfft__plan.html#df33ce87c35b396c50d214d9bdeeefe6" title="Total number of samples.">M_total</a>));
<a name="l00790"></a>00790 
<a name="l00791"></a>00791   <span class="comment">//printf("f=%e+i%e\t",creal(p.f[0]),cimag(p.f[0]));</span>
<a name="l00792"></a>00792 
<a name="l00793"></a>00793   printf(<span class="stringliteral">"\n"</span>);
<a name="l00794"></a>00794 
<a name="l00795"></a>00795   <a class="code" href="nfft3_8h.html#b8a0db03dda1317a8a3d922e0e4e8aaa">nfft_free</a>(swapndft);
<a name="l00796"></a>00796   fftw_destroy_plan(p_fft);
<a name="l00797"></a>00797   <a class="code" href="group__nfft.html#g614f9f7af5b0d5491afa9495393c4dc3" title="Destroys a transform plan.">nfft_finalize</a>(&amp;p);
<a name="l00798"></a>00798 }
<a name="l00799"></a>00799 
<a name="l00800"></a>00800 
<a name="l00801"></a>00801 <span class="keywordtype">void</span> measure_time_nfft_XXX7(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> N, <span class="keywordtype">unsigned</span> test_ndft)
<a name="l00802"></a>00802 {
<a name="l00803"></a>00803   <span class="keywordtype">int</span> j,r, M, NN[d], nn[d];
<a name="l00804"></a>00804   <span class="keywordtype">double</span> t, t_fft, t_ndft, t_nfft;
<a name="l00805"></a>00805 
<a name="l00806"></a>00806   <a class="code" href="structnfft__plan.html" title="Structure for a NFFT plan.">nfft_plan</a> p;
<a name="l00807"></a>00807   fftw_plan p_fft;
<a name="l00808"></a>00808 
<a name="l00809"></a>00809   printf(<span class="stringliteral">"%d\t"</span>,(<span class="keywordtype">int</span>)(log(N)/log(2)*d+0.5)); fflush(stdout);
<a name="l00810"></a>00810 
<a name="l00811"></a>00811   <span class="keywordflow">for</span>(r=0,M=1;r&lt;d;r++)
<a name="l00812"></a>00812     {
<a name="l00813"></a>00813       M=N*M;
<a name="l00814"></a>00814       NN[r]=N;
<a name="l00815"></a>00815       nn[r]=2*N;
<a name="l00816"></a>00816     }
<a name="l00817"></a>00817 
<a name="l00818"></a>00818   <a class="code" href="group__nfft.html#g406f05717c6299b918261c61aaa9de23" title="Initialisation of a transform plan, guru.">nfft_init_guru</a>(&amp;p, d, NN, M, nn, 2,
<a name="l00819"></a>00819      <a class="code" href="group__nfft.html#gda3a356fdaf5840f98374a0a7aaf3e9c" title="If this flag is set, the deconvolution step (the multiplication with the diagonal...">PRE_PHI_HUT</a>|
<a name="l00820"></a>00820      <a class="code" href="group__nfft.html#g01ebac2d2071639df189f083fc9f24eb" title="If this flag is set, the convolution step (the multiplication with the sparse matrix...">FG_PSI</a>|
<a name="l00821"></a>00821      <a class="code" href="group__nfft.html#g02d52cb02b6cfdbc3e4d5fd4de1aef9e" title="If this flag is set, (de)allocation of the vector of Fourier coefficients is done...">MALLOC_F_HAT</a>| <a class="code" href="group__nfft.html#g353185384f87de0dc4320a82652ef724" title="If this flag is set, (de)allocation of the node vector is done.">MALLOC_X</a>| <a class="code" href="group__nfft.html#ga7b5098f4136080bbe0dd989973e2a69" title="If this flag is set, (de)allocation of the vector of samples is done.">MALLOC_F</a>|
<a name="l00822"></a>00822      <a class="code" href="group__nfft.html#gd3fe6867a3351441c6f44dd5a3746f5b" title="If this flag is set, fftw_init/fftw_finalize is called.">FFTW_INIT</a>| <a class="code" href="group__nfft.html#g9193f768d5839892d0e303080c370eaf" title="If this flag is set, FFTW uses disjoint input/output vectors.">FFT_OUT_OF_PLACE</a>,
<a name="l00823"></a>00823      FFTW_MEASURE| FFTW_DESTROY_INPUT);
<a name="l00824"></a>00824 
<a name="l00825"></a>00825   p_fft=fftw_plan_dft(d, NN, p.<a class="code" href="structnfft__plan.html#fa27a166f809acf70ae27e5e6f28daa5" title="Vector of samples, \ size is M_total float types.">f</a>, p.<a class="code" href="structnfft__plan.html#23409aec68871e9a56f11711e2891691" title="Vector of Fourier coefficients, \ size is N_total float_types.">f_hat</a>, FFTW_FORWARD, FFTW_MEASURE);
<a name="l00826"></a>00826 
<a name="l00827"></a>00827   <span class="keywordtype">double</span> _Complex *swapndft=(<span class="keywordtype">double</span> _Complex*)<a class="code" href="nfft3_8h.html#afe6167438c5de4d3d4c509f66a6694e" title="Include header for FFTW3 library for its complex type.">nfft_malloc</a>(p.<a class="code" href="structnfft__plan.html#d33daddf76670c8731c759bf74ad0d22" title="Total number of Fourier \ coefficients.">N_total</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span> _Complex));
<a name="l00828"></a>00828 
<a name="l00830"></a>00830   <a class="code" href="group__nfftutil.html#ga44184ac2c1452221508e7640f391c34" title="Inits a vector of random double numbers in .">nfft_vrand_shifted_unit_double</a>(p.<a class="code" href="structnfft__plan.html#7eb64fb5fedfba0ec75261e777e020c0" title="Nodes in time/spatial domain, size is  doubles.">x</a>, p.<a class="code" href="structnfft__plan.html#e39d4867eac948d96abbe3fc930b39a8" title="Dimension, rank.">d</a>*p.<a class="code" href="structnfft__plan.html#df33ce87c35b396c50d214d9bdeeefe6" title="Total number of samples.">M_total</a>);
<a name="l00831"></a>00831 
<a name="l00832"></a>00832   <span class="comment">//sort_nodes(p.x,p.d,p.M_total,</span>
<a name="l00833"></a>00833 
<a name="l00834"></a>00834   <a class="code" href="group__nfft.html#gfd7b278b6ed04d929212b4807dd195f0" title="Precomputation for a transform plan.">nfft_precompute_one_psi</a>(&amp;p);
<a name="l00835"></a>00835 
<a name="l00837"></a>00837   <a class="code" href="group__nfftutil.html#g5f53c8cd0b2f33200fce15ecf75a0685" title="Inits a vector of random complex numbers in .">nfft_vrand_unit_complex</a>(p.<a class="code" href="structnfft__plan.html#fa27a166f809acf70ae27e5e6f28daa5" title="Vector of samples, \ size is M_total float types.">f</a>, p.<a class="code" href="structnfft__plan.html#df33ce87c35b396c50d214d9bdeeefe6" title="Total number of samples.">M_total</a>);
<a name="l00838"></a>00838 
<a name="l00840"></a>00840   t_fft=0;
<a name="l00841"></a>00841   r=0;
<a name="l00842"></a>00842   <span class="keywordflow">while</span>(t_fft&lt;0.1)
<a name="l00843"></a>00843     {
<a name="l00844"></a>00844       r++;
<a name="l00845"></a>00845       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00846"></a>00846       fftw_execute(p_fft);
<a name="l00847"></a>00847       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00848"></a>00848       t_fft+=t;
<a name="l00849"></a>00849     }
<a name="l00850"></a>00850   t_fft/=r;
<a name="l00851"></a>00851 
<a name="l00852"></a>00852   printf(<span class="stringliteral">"%.1e\t"</span>,t_fft);
<a name="l00853"></a>00853 
<a name="l00855"></a>00855   <a class="code" href="group__nfftutil.html#g5f53c8cd0b2f33200fce15ecf75a0685" title="Inits a vector of random complex numbers in .">nfft_vrand_unit_complex</a>(p.<a class="code" href="structnfft__plan.html#fa27a166f809acf70ae27e5e6f28daa5" title="Vector of samples, \ size is M_total float types.">f</a>, p.<a class="code" href="structnfft__plan.html#df33ce87c35b396c50d214d9bdeeefe6" title="Total number of samples.">M_total</a>);
<a name="l00856"></a>00856 
<a name="l00858"></a>00858   <span class="keywordflow">if</span>(test_ndft)
<a name="l00859"></a>00859     {
<a name="l00860"></a>00860       <a class="code" href="group__nfftutil.html#g4df074728562efbb458f6662e649d1d5" title="Swapping of two vectors.">NFFT_SWAP_complex</a>(p.<a class="code" href="structnfft__plan.html#23409aec68871e9a56f11711e2891691" title="Vector of Fourier coefficients, \ size is N_total float_types.">f_hat</a>,swapndft);
<a name="l00861"></a>00861       t_ndft=0;
<a name="l00862"></a>00862       r=0;
<a name="l00863"></a>00863       <span class="keywordflow">while</span>(t_ndft&lt;0.1)
<a name="l00864"></a>00864         {
<a name="l00865"></a>00865           r++;
<a name="l00866"></a>00866           t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00867"></a>00867           <a class="code" href="group__nfft.html#g03975608fdf8cfd8757f1f52b43ec51b" title="Computes an adjoint NDFT, see the definition.">ndft_adjoint</a>(&amp;p);
<a name="l00868"></a>00868           t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00869"></a>00869           t_ndft+=t;
<a name="l00870"></a>00870         }
<a name="l00871"></a>00871       t_ndft/=r;
<a name="l00872"></a>00872       printf(<span class="stringliteral">"%.1e\t"</span>,t_ndft);
<a name="l00873"></a>00873 
<a name="l00874"></a>00874       <span class="comment">//printf("\nf_hat=%e+i%e\t",creal(p.f_hat[0]),cimag(p.f_hat[0]));</span>
<a name="l00875"></a>00875 
<a name="l00876"></a>00876       <a class="code" href="group__nfftutil.html#g4df074728562efbb458f6662e649d1d5" title="Swapping of two vectors.">NFFT_SWAP_complex</a>(p.<a class="code" href="structnfft__plan.html#23409aec68871e9a56f11711e2891691" title="Vector of Fourier coefficients, \ size is N_total float_types.">f_hat</a>,swapndft);
<a name="l00877"></a>00877     }
<a name="l00878"></a>00878   <span class="keywordflow">else</span>
<a name="l00879"></a>00879     printf(<span class="stringliteral">"\t"</span>);
<a name="l00880"></a>00880 
<a name="l00882"></a>00882   t_nfft=0;
<a name="l00883"></a>00883   r=0;
<a name="l00884"></a>00884   <span class="keywordflow">while</span>(t_nfft&lt;0.1)
<a name="l00885"></a>00885     {
<a name="l00886"></a>00886       r++;
<a name="l00887"></a>00887       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00888"></a>00888       <a class="code" href="group__nfft.html#g4b44c1dd52026dcb494dc735f0fa5b08" title="Computes an adjoint NFFT, see the definition.">nfft_adjoint</a>(&amp;p);
<a name="l00889"></a>00889       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00890"></a>00890       t_nfft+=t;
<a name="l00891"></a>00891     }
<a name="l00892"></a>00892   t_nfft/=r;
<a name="l00893"></a>00893   printf(<span class="stringliteral">"%.1e\t"</span>,t_nfft);
<a name="l00894"></a>00894   <span class="keywordflow">if</span>(test_ndft)
<a name="l00895"></a>00895     printf(<span class="stringliteral">"(%.1e)\t"</span>,<a class="code" href="group__nfftutil.html#gcdfad5420393c822ecc1602d9c164090" title="Computes .">nfft_error_l_2_complex</a>(swapndft, p.<a class="code" href="structnfft__plan.html#23409aec68871e9a56f11711e2891691" title="Vector of Fourier coefficients, \ size is N_total float_types.">f_hat</a>, p.<a class="code" href="structnfft__plan.html#d33daddf76670c8731c759bf74ad0d22" title="Total number of Fourier \ coefficients.">N_total</a>));
<a name="l00896"></a>00896 
<a name="l00897"></a>00897   <span class="comment">//printf("\nf_hat=%e+i%e\t",creal(p.f_hat[0]),cimag(p.f_hat[0]));</span>
<a name="l00898"></a>00898 
<a name="l00900"></a>00900   t_nfft=0;
<a name="l00901"></a>00901   r=0;
<a name="l00902"></a>00902   <span class="keywordflow">while</span>(t_nfft&lt;0.1)
<a name="l00903"></a>00903     {
<a name="l00904"></a>00904       r++;
<a name="l00905"></a>00905       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>();
<a name="l00906"></a>00906       nfft_adjoint_3d(&amp;p);
<a name="l00907"></a>00907       t=<a class="code" href="group__nfftutil.html#gae7e89f8691419d4a5bc972db7a3abd7" title="Actual used CPU time in seconds; calls getrusage, limited accuracy.">nfft_second</a>()-t;
<a name="l00908"></a>00908       t_nfft+=t;
<a name="l00909"></a>00909     }
<a name="l00910"></a>00910   t_nfft/=r;
<a name="l00911"></a>00911   printf(<span class="stringliteral">"%.1e\t"</span>,t_nfft);
<a name="l00912"></a>00912   <span class="keywordflow">if</span>(test_ndft)
<a name="l00913"></a>00913     printf(<span class="stringliteral">"(%.1e)\t"</span>,<a class="code" href="group__nfftutil.html#gcdfad5420393c822ecc1602d9c164090" title="Computes .">nfft_error_l_2_complex</a>(swapndft, p.<a class="code" href="structnfft__plan.html#23409aec68871e9a56f11711e2891691" title="Vector of Fourier coefficients, \ size is N_total float_types.">f_hat</a>, p.<a class="code" href="structnfft__plan.html#d33daddf76670c8731c759bf74ad0d22" title="Total number of Fourier \ coefficients.">N_total</a>));
<a name="l00914"></a>00914 
<a name="l00915"></a>00915   <span class="comment">//printf("\nf_hat=%e+i%e\t",creal(p.f_hat[0]),cimag(p.f_hat[0]));</span>
<a name="l00916"></a>00916 
<a name="l00917"></a>00917   printf(<span class="stringliteral">"\n"</span>);
<a name="l00918"></a>00918 
<a name="l00919"></a>00919   <a class="code" href="nfft3_8h.html#b8a0db03dda1317a8a3d922e0e4e8aaa">nfft_free</a>(swapndft);
<a name="l00920"></a>00920   fftw_destroy_plan(p_fft);
<a name="l00921"></a>00921   <a class="code" href="group__nfft.html#g614f9f7af5b0d5491afa9495393c4dc3" title="Destroys a transform plan.">nfft_finalize</a>(&amp;p);
<a name="l00922"></a>00922 }
<a name="l00923"></a>00923 
<a name="l00924"></a>00924 <span class="keywordtype">int</span> main2(<span class="keywordtype">void</span>)
<a name="l00925"></a>00925 {
<a name="l00926"></a>00926   <span class="keywordtype">int</span> l,d,logIN;
<a name="l00927"></a>00927 
<a name="l00928"></a>00928   <span class="keywordflow">for</span>(l=3;l&lt;=6;l++)
<a name="l00929"></a>00929     {
<a name="l00930"></a>00930       d=3;
<a name="l00931"></a>00931       logIN=d*l;
<a name="l00932"></a>00932       <span class="keywordflow">if</span>(logIN&lt;=15)
<a name="l00933"></a>00933   {
<a name="l00934"></a>00934     measure_time_nfft_XXX6(d,(1U&lt;&lt; (logIN/d)),1);
<a name="l00935"></a>00935     measure_time_nfft_XXX7(d,(1U&lt;&lt; (logIN/d)),1);
<a name="l00936"></a>00936   }
<a name="l00937"></a>00937       <span class="keywordflow">else</span>
<a name="l00938"></a>00938   {
<a name="l00939"></a>00939     measure_time_nfft_XXX6(d,(1U&lt;&lt; (logIN/d)),0);
<a name="l00940"></a>00940     measure_time_nfft_XXX7(d,(1U&lt;&lt; (logIN/d)),0);
<a name="l00941"></a>00941   }
<a name="l00942"></a>00942     }
<a name="l00943"></a>00943 
<a name="l00944"></a>00944   exit(-1);
<a name="l00945"></a>00945 
<a name="l00946"></a>00946 
<a name="l00947"></a>00947   <span class="keywordflow">for</span>(l=7;l&lt;=12;l++)
<a name="l00948"></a>00948     {
<a name="l00949"></a>00949       d=2;
<a name="l00950"></a>00950       logIN=d*l;
<a name="l00951"></a>00951       <span class="keywordflow">if</span>(logIN&lt;=15)
<a name="l00952"></a>00952   {
<a name="l00953"></a>00953     measure_time_nfft_XXX4(d,(1U&lt;&lt; (logIN/d)),1);
<a name="l00954"></a>00954     measure_time_nfft_XXX5(d,(1U&lt;&lt; (logIN/d)),1);
<a name="l00955"></a>00955   }
<a name="l00956"></a>00956       <span class="keywordflow">else</span>
<a name="l00957"></a>00957   {
<a name="l00958"></a>00958     measure_time_nfft_XXX4(d,(1U&lt;&lt; (logIN/d)),0);
<a name="l00959"></a>00959     measure_time_nfft_XXX5(d,(1U&lt;&lt; (logIN/d)),0);
<a name="l00960"></a>00960   }
<a name="l00961"></a>00961     }
<a name="l00962"></a>00962 
<a name="l00963"></a>00963   exit(-1);
<a name="l00964"></a>00964 
<a name="l00965"></a>00965   <span class="keywordflow">for</span>(l=3;l&lt;=12;l++)
<a name="l00966"></a>00966     {
<a name="l00967"></a>00967       logIN=l;
<a name="l00968"></a>00968       <span class="keywordflow">if</span>(logIN&lt;=15)
<a name="l00969"></a>00969   {
<a name="l00970"></a>00970     measure_time_nfft_XXX2(1,(1U&lt;&lt; (logIN)),1);
<a name="l00971"></a>00971     measure_time_nfft_XXX3(1,(1U&lt;&lt; (logIN)),1);
<a name="l00972"></a>00972   }
<a name="l00973"></a>00973       <span class="keywordflow">else</span>
<a name="l00974"></a>00974   {
<a name="l00975"></a>00975     measure_time_nfft_XXX2(1,(1U&lt;&lt; (logIN)),0);
<a name="l00976"></a>00976     measure_time_nfft_XXX3(1,(1U&lt;&lt; (logIN)),0);
<a name="l00977"></a>00977   }
<a name="l00978"></a>00978     }
<a name="l00979"></a>00979 
<a name="l00980"></a>00980   exit(-1);
<a name="l00981"></a>00981 }
<a name="l00982"></a>00982 
<a name="l00983"></a>00983 <span class="keywordtype">int</span> XXX(<span class="keywordtype">void</span>)
<a name="l00984"></a>00984 {
<a name="l00985"></a>00985   <span class="keywordtype">int</span> l,d,logIN;
<a name="l00986"></a>00986 
<a name="l00987"></a>00987 }
<a name="l00988"></a>00988 
<a name="l00989"></a>00989 <span class="keywordtype">int</span> <a class="code" href="group__examples__solver__glacier.html#g3c04138a5bfe5d72780bb7e82a18e627" title="Main routine.">main</a>(<span class="keywordtype">void</span>)
<a name="l00990"></a>00990 {
<a name="l00991"></a>00991   <span class="keywordtype">int</span> l,d,logIN;
<a name="l00992"></a>00992 
<a name="l00993"></a>00993   printf(<span class="stringliteral">"\\hline $l_N$ &amp; FFT &amp; NDFT &amp; NFFT &amp; NFFT/FFT\\\\\n"</span>);
<a name="l00994"></a>00994   printf(<span class="stringliteral">"\\hline \\hline \\multicolumn{5}{|c|}{$d=1$} \\\\ \\hline\n"</span>);
<a name="l00995"></a>00995   <span class="keywordflow">for</span>(l=3;l&lt;=22;l++)
<a name="l00996"></a>00996     {
<a name="l00997"></a>00997       d=1;
<a name="l00998"></a>00998       logIN=l;
<a name="l00999"></a>00999       <span class="keywordflow">if</span>(logIN&lt;=15)
<a name="l01000"></a>01000   measure_time_nfft(d,(1U&lt;&lt; (logIN/d)),1);
<a name="l01001"></a>01001       <span class="keywordflow">else</span>
<a name="l01002"></a>01002   measure_time_nfft(d,(1U&lt;&lt; (logIN/d)),0);
<a name="l01003"></a>01003 
<a name="l01004"></a>01004       fflush(stdout);
<a name="l01005"></a>01005     }
<a name="l01006"></a>01006 
<a name="l01007"></a>01007   printf(<span class="stringliteral">"\\hline $l_N$ &amp; FFT &amp; NDFT &amp; NFFT &amp; NFFT/FFT\\\\\n"</span>);
<a name="l01008"></a>01008   printf(<span class="stringliteral">"\\hline \\hline \\multicolumn{5}{|c|}{$d=2$} \\\\ \\hline\n"</span>);
<a name="l01009"></a>01009   <span class="keywordflow">for</span>(l=3;l&lt;=11;l++)
<a name="l01010"></a>01010     {
<a name="l01011"></a>01011       d=2;
<a name="l01012"></a>01012       logIN=d*l;
<a name="l01013"></a>01013       <span class="keywordflow">if</span>(logIN&lt;=15)
<a name="l01014"></a>01014   measure_time_nfft(d,(1U&lt;&lt; (logIN/d)),1);
<a name="l01015"></a>01015       <span class="keywordflow">else</span>
<a name="l01016"></a>01016   measure_time_nfft(d,(1U&lt;&lt; (logIN/d)),0);
<a name="l01017"></a>01017 
<a name="l01018"></a>01018       fflush(stdout);
<a name="l01019"></a>01019     }
<a name="l01020"></a>01020 
<a name="l01021"></a>01021   printf(<span class="stringliteral">"\\hline \\hline \\multicolumn{5}{|c|}{$d=3$} \\\\ \\hline\n"</span>);
<a name="l01022"></a>01022   <span class="keywordflow">for</span>(l=3;l&lt;=7;l++)
<a name="l01023"></a>01023     {
<a name="l01024"></a>01024       d=3;
<a name="l01025"></a>01025       logIN=d*l;
<a name="l01026"></a>01026       <span class="keywordflow">if</span>(logIN&lt;=15)
<a name="l01027"></a>01027   measure_time_nfft(d,(1U&lt;&lt; (logIN/d)),1);
<a name="l01028"></a>01028       <span class="keywordflow">else</span>
<a name="l01029"></a>01029   measure_time_nfft(d,(1U&lt;&lt; (logIN/d)),0);
<a name="l01030"></a>01030 
<a name="l01031"></a>01031       fflush(stdout);
<a name="l01032"></a>01032     }
<a name="l01033"></a>01033 
<a name="l01034"></a>01034   <span class="keywordflow">return</span> 1;
<a name="l01035"></a>01035 }
</pre></div></div>
    <hr size="1"/>
    Generated on 23 Dec 2009 by Doxygen 1.5.6
  </body>
</html>
