<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
    <title>
      NFFT 3.0.3 API Reference - NFFT: nfft_times.c Source File
    </title>
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <table>
      <tr>
        <td valign="top">
          <img src="images/logo.png" alt="NFFT Logo">
        </td>
        <td align="left" valign="bottom" width="100%">
          <H1nc>3.0.3 API Reference</H1nc>
        </td>
      </tr>
    </table>  
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">examples</a>&nbsp;/&nbsp;<a class="el" href="dir_000018.html">nfft</a></div>
<h1>nfft_times.c</h1><div class="fragment"><pre class="fragment">00001 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00002 <span class="preprocessor">#include &lt;math.h&gt;</span>
00003 <span class="preprocessor">#include &lt;string.h&gt;</span>
00004 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00005 
00006 <span class="preprocessor">#include "<a class="code" href="util_8h.html">util.h</a>"</span>
00007 <span class="preprocessor">#include "<a class="code" href="nfft3_8h.html">nfft3.h</a>"</span>
00008 
00009 <span class="keywordtype">void</span> measure_time_nfft(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> N, <span class="keywordtype">unsigned</span> test_ndft)
00010 {
00011   <span class="keywordtype">int</span> r, M, NN[d], nn[d];
00012   <span class="keywordtype">double</span> t, t_fft, t_ndft, t_nfft;
00013 
00014   <a class="code" href="structnfft__plan.html">nfft_plan</a> p;
00015   fftw_plan p_fft;
00016 
00017   printf(<span class="stringliteral">"$%d$&amp;\t"</span>,(<span class="keywordtype">int</span>)(log(N)/log(2)*d+0.5));
00018      
00019   <span class="keywordflow">for</span>(r=0,M=1;r&lt;d;r++)
00020     {
00021       M=N*M;
00022       NN[r]=N;
00023       nn[r]=2*N;
00024     }
00025 
00026   <a class="code" href="group__nfft.html#ga9">nfft_init_guru</a>(&amp;p, d, NN, M, nn, 4, 
00027      PRE_PHI_HUT| PRE_PSI| MALLOC_F_HAT| MALLOC_X| MALLOC_F|
00028      FFTW_INIT| FFT_OUT_OF_PLACE,
00029      FFTW_ESTIMATE| FFTW_DESTROY_INPUT);
00030 
00031   p_fft=fftw_plan_dft(d, NN, p.<a class="code" href="structnfft__plan.html#o2">f_hat</a>, p.<a class="code" href="structnfft__plan.html#o3">f</a>, FFTW_FORWARD, FFTW_MEASURE);
00032 
00034   <a class="code" href="group__nfftutil.html#ga47">nfft_vrand_shifted_unit_double</a>(p.<a class="code" href="structnfft__plan.html#o14">x</a>, p.<a class="code" href="structnfft__plan.html#o4">d</a>*p.<a class="code" href="structnfft__plan.html#o1">M_total</a>);
00035 
00036   <a class="code" href="group__nfft.html#ga10">nfft_precompute_one_psi</a>(&amp;p);
00037 
00039   <a class="code" href="group__nfftutil.html#ga46">nfft_vrand_unit_complex</a>(p.<a class="code" href="structnfft__plan.html#o2">f_hat</a>, p.<a class="code" href="structnfft__plan.html#o0">N_total</a>);
00040 
00042   t_fft=0;
00043   r=0;
00044   <span class="keywordflow">while</span>(t_fft&lt;0.1)
00045     {
00046       r++;
00047       t=<a class="code" href="group__nfftutil.html#ga0">nfft_second</a>();
00048       fftw_execute(p_fft);
00049       t=<a class="code" href="group__nfftutil.html#ga0">nfft_second</a>()-t;
00050       t_fft+=t;
00051     }
00052   t_fft/=r;
00053 
00054   printf(<span class="stringliteral">"$%.1e$&amp;\t"</span>,t_fft);
00055 
00057   <span class="keywordflow">if</span>(test_ndft)
00058     {
00059       t_ndft=0;
00060       r=0;
00061       <span class="keywordflow">while</span>(t_ndft&lt;0.1)
00062         {
00063           r++;
00064           t=<a class="code" href="group__nfftutil.html#ga0">nfft_second</a>();
00065           <a class="code" href="group__nfft.html#ga0">ndft_trafo</a>(&amp;p);
00066           t=<a class="code" href="group__nfftutil.html#ga0">nfft_second</a>()-t;
00067           t_ndft+=t;
00068         }
00069       t_ndft/=r;
00070       printf(<span class="stringliteral">"$%.1e$&amp;\t"</span>,t_ndft);
00071     }
00072   <span class="keywordflow">else</span>
00073     printf(<span class="stringliteral">"*&amp;\t\t"</span>);
00074 
00076   t_nfft=0;
00077   r=0;
00078   <span class="keywordflow">while</span>(t_nfft&lt;0.1)
00079     {
00080       r++;
00081       t=<a class="code" href="group__nfftutil.html#ga0">nfft_second</a>();
00082       <a class="code" href="group__nfft.html#ga2">nfft_trafo</a>(&amp;p);
00083       t=<a class="code" href="group__nfftutil.html#ga0">nfft_second</a>()-t;
00084       t_nfft+=t;
00085     }
00086   t_nfft/=r;
00087   
00088   <span class="keywordflow">if</span>(d==1)
00089     printf(<span class="stringliteral">"$%.1e$&amp;\t"</span>,t_nfft);
00090   <span class="keywordflow">else</span>
00091     printf(<span class="stringliteral">"$%.1e$ \\\\\n"</span>,t_nfft);
00092 
00093   fftw_destroy_plan(p_fft);
00094   <a class="code" href="group__nfft.html#ga15">nfft_finalize</a>(&amp;p);
00095 } 
00096 
00097 <span class="keywordtype">int</span> <a class="code" href="flags_8c.html#a6">main</a>()
00098 {
00099   <span class="keywordtype">int</span> l,d,logIN;
00100 
00101   printf(<span class="stringliteral">"\\multicolumn{4}{c|}{$d=1$}&amp;\t\\multicolumn{4}{c|}{$d=2$}\\\\\n"</span>);
00102   <span class="keywordflow">for</span>(l=3;l&lt;=22;l++)
00103     {
00104       d=1;
00105       logIN=l;
00106       <span class="keywordflow">if</span>(logIN&lt;=15)
00107   measure_time_nfft(d,(1U&lt;&lt; (logIN/d)),1);
00108       <span class="keywordflow">else</span>
00109   measure_time_nfft(d,(1U&lt;&lt; (logIN/d)),0);
00110 
00111       <span class="keywordflow">if</span>(l&lt;12)
00112   {
00113     d=2;
00114     logIN=d*l;
00115     <span class="keywordflow">if</span>(logIN&lt;=15)
00116       measure_time_nfft(d,(1U&lt;&lt; (logIN/d)),1);
00117     <span class="keywordflow">else</span>
00118       measure_time_nfft(d,(1U&lt;&lt; (logIN/d)),0);
00119   }
00120 
00121       <span class="keywordflow">if</span>(l==12)
00122   printf(<span class="stringliteral">"\\multicolumn{4}{c|}{$d=3$}\\\\\n"</span>);
00123        
00124       <span class="keywordflow">if</span>((l&gt;12)&amp;&amp;(l&lt;=17))
00125   {
00126     d=3;
00127     logIN=d*(l-10);
00128     <span class="keywordflow">if</span>(logIN&lt;=15)
00129       measure_time_nfft(d,(1U&lt;&lt; (logIN/d)),1);
00130     <span class="keywordflow">else</span>
00131       measure_time_nfft(d,(1U&lt;&lt; (logIN/d)),0);
00132   }
00133 
00134       <span class="keywordflow">if</span>(l&gt;17)
00135   printf(<span class="stringliteral">" &amp; &amp; &amp; \\\\\n"</span>);
00136   
00137   fflush(stdout);
00138       }
00139 
00140   <span class="keywordflow">return</span> 1;
00141 }
</pre></div>    <hr size="1"/>
    Generated on 5 Feb 2007 by Doxygen 1.4.1
  </body>
</html>
