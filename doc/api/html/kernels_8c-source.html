<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
    <title>
      NFFT 3.0.2 API Reference - NFFT: kernels.c Source File
    </title>
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <table>
      <tr>
        <td valign="top">
          <img src="images/logo.png" alt="NFFT Logo">
        </td>
        <td align="left" valign="bottom" width="100%">
          <H1nc>3.0.2 API Reference</H1nc>
        </td>
      </tr>
    </table>  
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="dir_000006.html">applications</a>&nbsp;/&nbsp;<a class="el" href="dir_000016.html">fastsum</a></div>
<h1>kernels.c</h1><a href="kernels_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 
00005 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00006 <span class="preprocessor">#include &lt;complex.h&gt;</span>
00007 <span class="preprocessor">#include &lt;math.h&gt;</span>
00008 <span class="preprocessor">#include &lt;float.h&gt;</span>
00009 
00015 complex <span class="keywordtype">double</span> gaussian(<span class="keywordtype">double</span> x, <span class="keywordtype">int</span> der, <span class="keyword">const</span> <span class="keywordtype">double</span> *param)    <span class="comment">/* K(x)=exp(-x^2/c^2) */</span>
00016 {
00017   <span class="keywordtype">double</span> c=param[0];
00018   <span class="keywordtype">double</span> value=0.0;
00019 
00020   <span class="keywordflow">switch</span> (der)
00021   {
00022     <span class="keywordflow">case</span>  0 : value=exp(-x*x/(c*c)); <span class="keywordflow">break</span>;
00023     <span class="keywordflow">case</span>  1 : value=-2.0*x/(c*c)*exp(-x*x/(c*c)); <span class="keywordflow">break</span>;
00024     <span class="keywordflow">case</span>  2 : value=2.0*exp(-x*x/(c*c))*(-c*c+2.0*x*x)/(c*c*c*c); <span class="keywordflow">break</span>;
00025     <span class="keywordflow">case</span>  3 : value=-4.0*x*exp(-x*x/(c*c))*(-3.0*c*c+2.0*x*x)/(c*c*c*c*c*c); <span class="keywordflow">break</span>;
00026     <span class="keywordflow">case</span>  4 : value=4.0*exp(-x*x/(c*c))*(3.0*c*c*c*c-12.0*c*c*x*x+4.0*x*x*x*x)/(c*c*c*c*c*c*c*c); <span class="keywordflow">break</span>;
00027     <span class="keywordflow">case</span>  5 : value=-8.0*x*exp(-x*x/(c*c))*(15.0*c*c*c*c-20.0*c*c*x*x+4.0*x*x*x*x)/pow(c,10.0); <span class="keywordflow">break</span>;
00028     <span class="keywordflow">case</span>  6 : value=8.0*exp(-x*x/(c*c))*(-15.0*c*c*c*c*c*c+90.0*x*x*c*c*c*c-60.0*x*x*x*x*c*c+8.0*x*x*x*x*x*x)/pow(c,12.0); <span class="keywordflow">break</span>;
00029     <span class="keywordflow">case</span>  7 : value=-16.0*x*exp(-x*x/(c*c))*(-105.0*c*c*c*c*c*c+210.0*x*x*c*c*c*c-84.0*x*x*x*x*c*c+8.0*x*x*x*x*x*x)/pow(c,14.0); <span class="keywordflow">break</span>;
00030     <span class="keywordflow">case</span>  8 : value=16.0*exp(-x*x/(c*c))*(105.0*c*c*c*c*c*c*c*c-840.0*x*x*c*c*c*c*c*c+840.0*x*x*x*x*c*c*c*c-224.0*x*x*x*x*x*x*c*c+16.0*x*x*x*x*x*x*x*x)/pow(c,16.0); <span class="keywordflow">break</span>;
00031     <span class="keywordflow">case</span>  9 : value=-32.0*x*exp(-x*x/(c*c))*(945.0*c*c*c*c*c*c*c*c-2520.0*x*x*c*c*c*c*c*c+1512.0*x*x*x*x*c*c*c*c-288.0*x*x*x*x*x*x*c*c+16.0*x*x*x*x*x*x*x*x)/pow(c,18.0); <span class="keywordflow">break</span>;
00032     <span class="keywordflow">case</span> 10 : value=32.0*exp(-x*x/(c*c))*(-945.0*pow(c,10.0)+9450.0*x*x*c*c*c*c*c*c*c*c-12600.0*x*x*x*x*c*c*c*c*c*c+5040.0*x*x*x*x*x*x*c*c*c*c-720.0*x*x*x*x*x*x*x*x*c*c+32.0*pow(x,10.0))/pow(c,20.0); <span class="keywordflow">break</span>;
00033     <span class="keywordflow">case</span> 11 : value=-64.0*x*exp(-x*x/(c*c))*(-10395.0*pow(c,10.0)+34650.0*x*x*c*c*c*c*c*c*c*c-27720.0*x*x*x*x*c*c*c*c*c*c+7920.0*x*x*x*x*x*x*c*c*c*c-880.0*x*x*x*x*x*x*x*x*c*c+32.0*pow(x,10.0))/pow(c,22.0); <span class="keywordflow">break</span>;
00034     <span class="keywordflow">case</span> 12 : value=64.0*exp(-x*x/(c*c))*(10395.0*pow(c,12.0)-124740.0*x*x*pow(c,10.0)+207900.0*x*x*x*x*c*c*c*c*c*c*c*c-110880.0*x*x*x*x*x*x*c*c*c*c*c*c+23760.0*x*x*x*x*x*x*x*x*c*c*c*c-2112.0*pow(x,10.0)*c*c+64.0*pow(x,12.0))/pow(c,24.0); <span class="keywordflow">break</span>;
00035     <span class="keywordflow">default</span> : value=0.0;
00036   }
00037 
00038   <span class="keywordflow">return</span> value;
00039 }
00040 
00041 complex <span class="keywordtype">double</span> multiquadric(<span class="keywordtype">double</span> x, <span class="keywordtype">int</span> der, <span class="keyword">const</span> <span class="keywordtype">double</span> *param)    <span class="comment">/* K(x)=sqrt(x^2+c^2) */</span>
00042 {
00043   <span class="keywordtype">double</span> c=param[0];
00044   <span class="keywordtype">double</span> value=0.0;
00045 
00046   <span class="keywordflow">switch</span> (der)
00047   {
00048     <span class="keywordflow">case</span>  0 : value=sqrt(x*x+c*c); <span class="keywordflow">break</span>;
00049     <span class="keywordflow">case</span>  1 : value=1.0/(sqrt(x*x+c*c))*x; <span class="keywordflow">break</span>;
00050     <span class="keywordflow">case</span>  2 : value=c*c/sqrt(pow(x*x+c*c,3.0)); <span class="keywordflow">break</span>;
00051     <span class="keywordflow">case</span>  3 : value=-3.0*x*c*c/sqrt(pow(x*x+c*c,5.0)); <span class="keywordflow">break</span>;
00052     <span class="keywordflow">case</span>  4 : value=3.0*c*c*(4.0*x*x-c*c)/sqrt(pow(x*x+c*c,7.0)); <span class="keywordflow">break</span>;
00053     <span class="keywordflow">case</span>  5 : value=-15.0*x*c*c*(4.0*x*x-3.0*c*c)/sqrt(pow(x*x+c*c,9.0)); <span class="keywordflow">break</span>;
00054     <span class="keywordflow">case</span>  6 : value=45.0*c*c*(8.0*x*x*x*x-12.0*x*x*c*c+c*c*c*c)/sqrt(pow(x*x+c*c,11.0)); <span class="keywordflow">break</span>;
00055     <span class="keywordflow">case</span>  7 : value=-315.0*x*c*c*(8.0*x*x*x*x-20.0*x*x*c*c+5.0*c*c*c*c)/sqrt(pow(x*x+c*c,13.0)); <span class="keywordflow">break</span>;
00056     <span class="keywordflow">case</span>  8 : value=315.0*c*c*(64.0*x*x*x*x*x*x-240.0*x*x*x*x*c*c+120.0*x*x*c*c*c*c-5.0*c*c*c*c*c*c)/sqrt(pow(x*x+c*c,15.0)); <span class="keywordflow">break</span>;
00057     <span class="keywordflow">case</span>  9 : value=-2835.0*x*c*c*(64.0*x*x*x*x*x*x-336.0*x*x*x*x*c*c+280.0*x*x*c*c*c*c-35.0*c*c*c*c*c*c)/sqrt(pow(x*x+c*c,17.0)); <span class="keywordflow">break</span>;
00058     <span class="keywordflow">case</span> 10 : value=14175.0*c*c*(128.0*x*x*x*x*x*x*x*x-896.0*x*x*x*x*x*x*c*c+1120.0*x*x*x*x*c*c*c*c-280.0*x*x*c*c*c*c*c*c+7.0*c*c*c*c*c*c*c*c)/sqrt(pow(x*x+c*c,19.0)); <span class="keywordflow">break</span>;
00059     <span class="keywordflow">case</span> 11 : value=-155925.0*x*c*c*(128.0*x*x*x*x*x*x*x*x-1152.0*x*x*x*x*x*x*c*c+2016.0*x*x*x*x*c*c*c*c-840.0*x*x*c*c*c*c*c*c+63.0*c*c*c*c*c*c*c*c)/sqrt(pow(x*x+c*c,21.0)); <span class="keywordflow">break</span>;
00060     <span class="keywordflow">case</span> 12 : value=467775.0*c*c*(1260.0*x*x*c*c*c*c*c*c*c*c-21.0*pow(c,10.0)+512.0*pow(x,10.0)-5760.0*x*x*x*x*x*x*x*x*c*c+13440.0*x*x*x*x*x*x*c*c*c*c-8400.0*x*x*x*x*c*c*c*c*c*c)/sqrt(pow(x*x+c*c,23.0)); <span class="keywordflow">break</span>;
00061     <span class="keywordflow">default</span> : value=0.0;
00062   }
00063 
00064   <span class="keywordflow">return</span> value;
00065 }
00066 
00067 complex <span class="keywordtype">double</span> inverse_multiquadric(<span class="keywordtype">double</span> x, <span class="keywordtype">int</span> der, <span class="keyword">const</span> <span class="keywordtype">double</span> *param)    <span class="comment">/* K(x)=1/sqrt(x^2+c^2) */</span>
00068 {
00069   <span class="keywordtype">double</span> c=param[0];
00070   <span class="keywordtype">double</span> value=0.0;
00071 
00072   <span class="keywordflow">switch</span> (der)
00073   {
00074     <span class="keywordflow">case</span>  0 : value=1.0/sqrt(x*x+c*c); <span class="keywordflow">break</span>;
00075     <span class="keywordflow">case</span>  1 : value=-1.0/(sqrt(pow(x*x+c*c,3.0)))*x; <span class="keywordflow">break</span>;
00076     <span class="keywordflow">case</span>  2 : value=(2.0*x*x-c*c)/sqrt(pow(x*x+c*c,5.0)); <span class="keywordflow">break</span>;
00077     <span class="keywordflow">case</span>  3 : value=-3.0*x*(2.0*x*x-3.0*c*c)/sqrt(pow(x*x+c*c,7.0)); <span class="keywordflow">break</span>;
00078     <span class="keywordflow">case</span>  4 : value=3.0*(8.0*x*x*x*x-24.0*x*x*c*c+3.0*c*c*c*c)/sqrt(pow(x*x+c*c,9.0)); <span class="keywordflow">break</span>;
00079     <span class="keywordflow">case</span>  5 : value=-15.0*x*(8.0*x*x*x*x-40.0*x*x*c*c+15.0*c*c*c*c)/sqrt(pow(x*x+c*c,11.0)); <span class="keywordflow">break</span>;
00080     <span class="keywordflow">case</span>  6 : value=45.0*(16.0*x*x*x*x*x*x-120.0*x*x*x*x*c*c+90.0*x*x*c*c*c*c-5.0*c*c*c*c*c*c)/sqrt(pow(x*x+c*c,13.0)); <span class="keywordflow">break</span>;
00081     <span class="keywordflow">case</span>  7 : value=-315.0*x*(16.0*x*x*x*x*x*x-168.0*x*x*x*x*c*c+210.0*x*x*c*c*c*c-35.0*c*c*c*c*c*c)/sqrt(pow(x*x+c*c,15.0)); <span class="keywordflow">break</span>;
00082     <span class="keywordflow">case</span>  8 : value=315.0*(128.0*x*x*x*x*x*x*x*x-1792.0*x*x*x*x*x*x*c*c+3360.0*x*x*x*x*c*c*c*c-1120.0*x*x*c*c*c*c*c*c+35.0*c*c*c*c*c*c*c*c)/sqrt(pow(x*x+c*c,17.0)); <span class="keywordflow">break</span>;
00083     <span class="keywordflow">case</span>  9 : value=-2835.0*x*(128.0*x*x*x*x*x*x*x*x-2304.0*x*x*x*x*x*x*c*c+6048.0*x*x*x*x*c*c*c*c-3360.0*x*x*c*c*c*c*c*c+315.0*c*c*c*c*c*c*c*c)/sqrt(pow(x*x+c*c,19.0)); <span class="keywordflow">break</span>;
00084     <span class="keywordflow">case</span> 10 : value=14175.0*(256.0*pow(x,10.0)-5760.0*x*x*x*x*x*x*x*x*c*c+20160.0*x*x*x*x*x*x*c*c*c*c-16800.0*x*x*x*x*c*c*c*c*c*c+3150.0*x*x*c*c*c*c*c*c*c*c-63.0*pow(c,10.0))/sqrt(pow(x*x+c*c,21.0)); <span class="keywordflow">break</span>;
00085     <span class="keywordflow">case</span> 11 : value=-155925.0*x*(256.0*pow(x,10.0)-7040.0*x*x*x*x*x*x*x*x*c*c+31680.0*x*x*x*x*x*x*c*c*c*c-36960.0*x*x*x*x*c*c*c*c*c*c+11550.0*x*x*c*c*c*c*c*c*c*c-693.0*pow(c,10.0))/sqrt(pow(x*x+c*c,23.0)); <span class="keywordflow">break</span>;
00086     <span class="keywordflow">case</span> 12 : value=467775.0*(231.0*pow(c,12.0)+190080.0*x*x*x*x*x*x*x*x*c*c*c*c-16632.0*x*x*pow(c,10.0)-295680.0*x*x*x*x*x*x*c*c*c*c*c*c+138600.0*x*x*x*x*c*c*c*c*c*c*c*c+1024.0*pow(x,12.0)-33792.0*pow(x,10.0)*c*c)/sqrt(pow(x*x+c*c,25.0)); <span class="keywordflow">break</span>;
00087     <span class="keywordflow">default</span> : value=0.0;
00088   }
00089 
00090   <span class="keywordflow">return</span> value;
00091 }
00092 
00093 complex <span class="keywordtype">double</span> logarithm(<span class="keywordtype">double</span> x, <span class="keywordtype">int</span> der, <span class="keyword">const</span> <span class="keywordtype">double</span> *param)    <span class="comment">/* K(x)=log |x| */</span>
00094 {
00095   <span class="keywordtype">double</span> value=0.0;
00096 
00097   (void)param;
00098 
00099   <span class="keywordflow">if</span> (fabs(x)&lt;DBL_EPSILON) value=0.0;
00100   else switch (der)
00101   {
00102     <span class="keywordflow">case</span>  0 : value=log(fabs(x)); <span class="keywordflow">break</span>;
00103     <span class="keywordflow">case</span>  1 : value=(x&lt;0 ? -1 : 1)/fabs(x); <span class="keywordflow">break</span>;
00104     <span class="keywordflow">case</span>  2 : value=-1/(x*x); <span class="keywordflow">break</span>;
00105     <span class="keywordflow">case</span>  3 : value=2.0*(x&lt;0 ? -1 : 1)/pow(fabs(x),3.0); <span class="keywordflow">break</span>;
00106     <span class="keywordflow">case</span>  4 : value=-6.0/(x*x*x*x); <span class="keywordflow">break</span>;
00107     <span class="keywordflow">case</span>  5 : value=24.0*(x&lt;0 ? -1 : 1)/pow(fabs(x),5.0); <span class="keywordflow">break</span>;
00108     <span class="keywordflow">case</span>  6 : value=-120.0/(x*x*x*x*x*x); <span class="keywordflow">break</span>;
00109     <span class="keywordflow">case</span>  7 : value=720.0*(x&lt;0 ? -1 : 1)/pow(fabs(x),7.0); <span class="keywordflow">break</span>;
00110     <span class="keywordflow">case</span>  8 : value=-5040.0/(x*x*x*x*x*x*x*x); <span class="keywordflow">break</span>;
00111     <span class="keywordflow">case</span>  9 : value=40320.0*(x&lt;0 ? -1 : 1)/pow(fabs(x),9.0); <span class="keywordflow">break</span>;
00112     <span class="keywordflow">case</span> 10 : value=-362880.0/pow(x,10.0); <span class="keywordflow">break</span>;
00113     <span class="keywordflow">case</span> 11 : value=3628800.0*(x&lt;0 ? -1 : 1)/pow(fabs(x),11.0); <span class="keywordflow">break</span>;
00114     <span class="keywordflow">case</span> 12 : value=-39916800.0/pow(x,12.0); <span class="keywordflow">break</span>;
00115     <span class="keywordflow">case</span> 13 : value=479001600.0/pow(x,13.0); <span class="keywordflow">break</span>;
00116     <span class="keywordflow">case</span> 14 : value=-6227020800.0/pow(x,14.0); <span class="keywordflow">break</span>;
00117     <span class="keywordflow">case</span> 15 : value=87178291200.0/pow(x,15.0); <span class="keywordflow">break</span>;
00118     <span class="keywordflow">case</span> 16 : value=-1307674368000.0/pow(x,16.0); <span class="keywordflow">break</span>;
00119     <span class="keywordflow">case</span> 17 : value=20922789888000.0/pow(x,17.0); <span class="keywordflow">break</span>;
00120     <span class="keywordflow">default</span> : value=0.0;
00121   }
00122 
00123   <span class="keywordflow">return</span> value;
00124 }
00125 
00126 complex <span class="keywordtype">double</span> thinplate_spline(<span class="keywordtype">double</span> x, <span class="keywordtype">int</span> der, <span class="keyword">const</span> <span class="keywordtype">double</span> *param)    <span class="comment">/* K(x) = x^2 log |x| */</span>
00127 {
00128   <span class="keywordtype">double</span> value=0.0;
00129 
00130   (void)param;
00131 
00132   <span class="keywordflow">if</span> (fabs(x)&lt;DBL_EPSILON) value=0.0;
00133   else switch (der)
00134   {
00135     <span class="keywordflow">case</span>  0 : value=x*x*log(fabs(x)); <span class="keywordflow">break</span>;
00136     <span class="keywordflow">case</span>  1 : value=2.0*x*log(fabs(x))+x; <span class="keywordflow">break</span>;
00137     <span class="keywordflow">case</span>  2 : value=2.0*log(fabs(x))+3.0; <span class="keywordflow">break</span>;
00138     <span class="keywordflow">case</span>  3 : value=2.0/x; <span class="keywordflow">break</span>;
00139     <span class="keywordflow">case</span>  4 : value=-2.0/(x*x); <span class="keywordflow">break</span>;
00140     <span class="keywordflow">case</span>  5 : value=4.0/(x*x*x); <span class="keywordflow">break</span>;
00141     <span class="keywordflow">case</span>  6 : value=-12.0/(x*x*x*x); <span class="keywordflow">break</span>;
00142     <span class="keywordflow">case</span>  7 : value=48.0/(x*x*x*x*x); <span class="keywordflow">break</span>;
00143     <span class="keywordflow">case</span>  8 : value=-240.0/(x*x*x*x*x*x); <span class="keywordflow">break</span>;
00144     <span class="keywordflow">case</span>  9 : value=1440.0/(x*x*x*x*x*x*x); <span class="keywordflow">break</span>;
00145     <span class="keywordflow">case</span> 10 : value=-10080.0/(x*x*x*x*x*x*x*x); <span class="keywordflow">break</span>;
00146     <span class="keywordflow">case</span> 11 : value=80640.0/(x*x*x*x*x*x*x*x*x); <span class="keywordflow">break</span>;
00147     <span class="keywordflow">case</span> 12 : value=-725760.0/pow(x,10.0); <span class="keywordflow">break</span>;
00148     <span class="keywordflow">default</span> : value=0.0;
00149   }
00150 
00151   <span class="keywordflow">return</span> value;
00152 }
00153 
00154 complex <span class="keywordtype">double</span> one_over_square(<span class="keywordtype">double</span> x, <span class="keywordtype">int</span> der, <span class="keyword">const</span> <span class="keywordtype">double</span> *param)    <span class="comment">/* K(x) = 1/x^2 */</span>
00155 {
00156   <span class="keywordtype">double</span> value=0.0;
00157 
00158   (void)param;
00159 
00160   <span class="keywordflow">if</span> (fabs(x)&lt;DBL_EPSILON) value=0.0;
00161   else switch (der)
00162   {
00163     <span class="keywordflow">case</span>  0 : value=1.0/(x*x); <span class="keywordflow">break</span>;
00164     <span class="keywordflow">case</span>  1 : value=-2.0/(x*x*x); <span class="keywordflow">break</span>;
00165     <span class="keywordflow">case</span>  2 : value=6.0/(x*x*x*x); <span class="keywordflow">break</span>;
00166     <span class="keywordflow">case</span>  3 : value=-24.0/(x*x*x*x*x); <span class="keywordflow">break</span>;
00167     <span class="keywordflow">case</span>  4 : value=120.0/(x*x*x*x*x*x); <span class="keywordflow">break</span>;
00168     <span class="keywordflow">case</span>  5 : value=-720.0/(x*x*x*x*x*x*x); <span class="keywordflow">break</span>;
00169     <span class="keywordflow">case</span>  6 : value=5040.0/(x*x*x*x*x*x*x*x); <span class="keywordflow">break</span>;
00170     <span class="keywordflow">case</span>  7 : value=-40320.0/(x*x*x*x*x*x*x*x*x); <span class="keywordflow">break</span>;
00171     <span class="keywordflow">case</span>  8 : value=362880.0/pow(x,10.0); <span class="keywordflow">break</span>;
00172     <span class="keywordflow">case</span>  9 : value=-3628800.0/pow(x,11.0); <span class="keywordflow">break</span>;
00173     <span class="keywordflow">case</span> 10 : value=39916800.0/pow(x,12.0); <span class="keywordflow">break</span>;
00174     <span class="keywordflow">case</span> 11 : value=-479001600.0/pow(x,13.0); <span class="keywordflow">break</span>;
00175     <span class="keywordflow">case</span> 12 : value=6227020800.0/pow(x,14.0); <span class="keywordflow">break</span>;
00176     <span class="keywordflow">default</span> : value=0.0;
00177   }
00178 
00179   <span class="keywordflow">return</span> value;
00180 }
00181 
00182 complex <span class="keywordtype">double</span> one_over_modulus(<span class="keywordtype">double</span> x, <span class="keywordtype">int</span> der, <span class="keyword">const</span> <span class="keywordtype">double</span> *param)    <span class="comment">/* K(x) = 1/|x| */</span>
00183 {
00184   <span class="keywordtype">double</span> value=0.0;
00185 
00186   (void)param;
00187 
00188   <span class="keywordflow">if</span> (fabs(x)&lt;DBL_EPSILON) value=0.0;
00189   else switch (der)
00190   {
00191     <span class="keywordflow">case</span>  0 : value=1.0/fabs(x); <span class="keywordflow">break</span>;
00192     <span class="keywordflow">case</span>  1 : value=-1/x/fabs(x); <span class="keywordflow">break</span>;
00193     <span class="keywordflow">case</span>  2 : value=2.0/pow(fabs(x),3.0); <span class="keywordflow">break</span>;
00194     <span class="keywordflow">case</span>  3 : value=-6.0/(x*x*x)/fabs(x); <span class="keywordflow">break</span>;
00195     <span class="keywordflow">case</span>  4 : value=24.0/pow(fabs(x),5.0); <span class="keywordflow">break</span>;
00196     <span class="keywordflow">case</span>  5 : value=-120.0/(x*x*x*x*x)/fabs(x); <span class="keywordflow">break</span>;
00197     <span class="keywordflow">case</span>  6 : value=720.0/pow(fabs(x),7.0); <span class="keywordflow">break</span>;
00198     <span class="keywordflow">case</span>  7 : value=-5040.0/(x*x*x*x*x*x*x)/fabs(x); <span class="keywordflow">break</span>;
00199     <span class="keywordflow">case</span>  8 : value=40320.0/pow(fabs(x),9.0); <span class="keywordflow">break</span>;
00200     <span class="keywordflow">case</span>  9 : value=-362880.0/(x*x*x*x*x*x*x*x*x)/fabs(x); <span class="keywordflow">break</span>;
00201     <span class="keywordflow">case</span> 10 : value=3628800.0/pow(fabs(x),11.0); <span class="keywordflow">break</span>;
00202     <span class="keywordflow">case</span> 11 : value=-39916800.0/pow(x,11.0)/fabs(x); <span class="keywordflow">break</span>;
00203     <span class="keywordflow">case</span> 12 : value=479001600.0/pow(fabs(x),13.0); <span class="keywordflow">break</span>;
00204     <span class="keywordflow">default</span> : value=0.0;
00205   }
00206 
00207   <span class="keywordflow">return</span> value;
00208 }
00209 
00210 complex <span class="keywordtype">double</span> one_over_x(<span class="keywordtype">double</span> x, <span class="keywordtype">int</span> der, <span class="keyword">const</span> <span class="keywordtype">double</span> *param)    <span class="comment">/* K(x) = 1/x */</span>
00211 {
00212   <span class="keywordtype">double</span> value=0.0;
00213 
00214   (void)param;
00215 
00216   <span class="keywordflow">if</span> (fabs(x)&lt;DBL_EPSILON) value=0.0;
00217   else switch (der)
00218   {
00219     <span class="keywordflow">case</span>  0 : value=1.0/x; <span class="keywordflow">break</span>;
00220     <span class="keywordflow">case</span>  1 : value=-1.0/(x*x); <span class="keywordflow">break</span>;
00221     <span class="keywordflow">case</span>  2 : value=2.0/(x*x*x); <span class="keywordflow">break</span>;
00222     <span class="keywordflow">case</span>  3 : value=-6.0/(x*x*x*x); <span class="keywordflow">break</span>;
00223     <span class="keywordflow">case</span>  4 : value=24.0/(x*x*x*x*x); <span class="keywordflow">break</span>;
00224     <span class="keywordflow">case</span>  5 : value=-120.0/(x*x*x*x*x*x); <span class="keywordflow">break</span>;
00225     <span class="keywordflow">case</span>  6 : value=720.0/(x*x*x*x*x*x*x); <span class="keywordflow">break</span>;
00226     <span class="keywordflow">case</span>  7 : value=-5040.0/(x*x*x*x*x*x*x*x); <span class="keywordflow">break</span>;
00227     <span class="keywordflow">case</span>  8 : value=40320.0/(x*x*x*x*x*x*x*x*x); <span class="keywordflow">break</span>;
00228     <span class="keywordflow">case</span>  9 : value=-362880.0/pow(x,10.0); <span class="keywordflow">break</span>;
00229     <span class="keywordflow">case</span> 10 : value=3628800.0/pow(x,11.0); <span class="keywordflow">break</span>;
00230     <span class="keywordflow">case</span> 11 : value=-39916800.0/pow(x,12.0); <span class="keywordflow">break</span>;
00231     <span class="keywordflow">case</span> 12 : value=479001600.0/pow(x,13.0); <span class="keywordflow">break</span>;
00232     <span class="keywordflow">default</span> : value=0.0;
00233   }
00234 
00235   <span class="keywordflow">return</span> value;
00236 }
00237 
00238 complex <span class="keywordtype">double</span> inverse_multiquadric3(<span class="keywordtype">double</span> x, <span class="keywordtype">int</span> der, <span class="keyword">const</span> <span class="keywordtype">double</span> *param)    <span class="comment">/* K(x) = 1/sqrt(x^2+c^2)^3 */</span>
00239 {
00240   <span class="keywordtype">double</span> c=param[0];
00241   <span class="keywordtype">double</span> value=0.0;
00242 
00243   <span class="keywordflow">switch</span> (der)
00244   {
00245     <span class="keywordflow">case</span>  0 : value=1.0/(sqrt(pow(x*x+c*c,3.0))); <span class="keywordflow">break</span>;
00246     <span class="keywordflow">case</span>  1 : value=-3.0/sqrt(pow(x*x+c*c,5.0))*x; <span class="keywordflow">break</span>;
00247     <span class="keywordflow">case</span>  2 : value=3.0*(4.0*x*x-c*c)/sqrt(pow(x*x+c*c,7.0)); <span class="keywordflow">break</span>;
00248     <span class="keywordflow">case</span>  3 : value=-15.0*x*(4.0*x*x-3.0*c*c)/sqrt(pow(x*x+c*c,9.0)); <span class="keywordflow">break</span>;
00249     <span class="keywordflow">case</span>  4 : value=45.0*(8.0*x*x*x*x-12.0*x*x*c*c+c*c*c*c)/sqrt(pow(x*x+c*c,11.0)); <span class="keywordflow">break</span>;
00250     <span class="keywordflow">case</span>  5 : value=-315.0*x*(8.0*x*x*x*x-20.0*x*x*c*c+5.0*c*c*c*c)/sqrt(pow(x*x+c*c,13.0)); <span class="keywordflow">break</span>;
00251     <span class="keywordflow">case</span>  6 : value=315.0*(64.0*x*x*x*x*x*x-240.0*x*x*x*x*c*c+120.0*x*x*c*c*c*c-5.0*c*c*c*c*c*c)/sqrt(pow(x*x+c*c,15.0)); <span class="keywordflow">break</span>;
00252     <span class="keywordflow">case</span>  7 : value=-2835.0*x*(64.0*x*x*x*x*x*x-336.0*x*x*x*x*c*c+280.0*x*x*c*c*c*c-35.0*c*c*c*c*c*c)/sqrt(pow(x*x+c*c,17.0)); <span class="keywordflow">break</span>;
00253     <span class="keywordflow">case</span>  8 : value=14175.0*(128.0*x*x*x*x*x*x*x*x-896.0*x*x*x*x*x*x*c*c+1120.0*x*x*x*x*c*c*c*c-280.0*x*x*c*c*c*c*c*c+7.0*c*c*c*c*c*c*c*c)/sqrt(pow(x*x+c*c,19.0)); <span class="keywordflow">break</span>;
00254     <span class="keywordflow">case</span>  9 : value=-155925.0*x*(128.0*x*x*x*x*x*x*x*x-1152.0*x*x*x*x*x*x*c*c+2016.0*x*x*x*x*c*c*c*c-840.0*x*x*c*c*c*c*c*c+63.0*c*c*c*c*c*c*c*c)/sqrt(pow(x*x+c*c,21.0)); <span class="keywordflow">break</span>;
00255     <span class="keywordflow">case</span> 10 : value=467775.0*(512.0*pow(x,10.0)-5760.0*x*x*x*x*x*x*x*x*c*c+13440.0*x*x*x*x*x*x*c*c*c*c-8400.0*x*x*x*x*c*c*c*c*c*c+1260.0*x*x*c*c*c*c*c*c*c*c-21.0*pow(c,10.0))/sqrt(pow(x*x+c*c,23.0)); <span class="keywordflow">break</span>;
00256     <span class="keywordflow">case</span> 11 : value=-6081075.0*x*(512.0*pow(x,10.0)-7040.0*x*x*x*x*x*x*x*x*c*c+21120.0*x*x*x*x*x*x*c*c*c*c-18480.0*x*x*x*x*c*c*c*c*c*c+4620.0*x*x*c*c*c*c*c*c*c*c-231.0*pow(c,10.0))/sqrt(pow(x*x+c*c,25.0)); <span class="keywordflow">break</span>;
00257     <span class="keywordflow">case</span> 12 : value=42567525.0*(1024.0*pow(x,12.0)+27720.0*x*x*x*x*c*c*c*c*c*c*c*c+33.0*pow(c,12.0)-2772.0*x*x*pow(c,10.0)-73920.0*x*x*x*x*x*x*c*c*c*c*c*c+63360.0*x*x*x*x*x*x*x*x*c*c*c*c-16896.0*pow(x,10.0)*c*c)/sqrt(pow(x*x+c*c,27.0)); <span class="keywordflow">break</span>;
00258     <span class="keywordflow">default</span> : value=0.0;
00259   }
00260 
00261   <span class="keywordflow">return</span> value;
00262 }
00263 
00264 complex <span class="keywordtype">double</span> sinc_kernel(<span class="keywordtype">double</span> x, <span class="keywordtype">int</span> der, <span class="keyword">const</span> <span class="keywordtype">double</span> *param)    <span class="comment">/* K(x) = sin(cx)/x */</span>
00265 {
00266   <span class="keywordtype">double</span> c=param[0];
00267   <span class="keywordtype">double</span> value=0.0;
00268 
00269   <span class="keywordflow">if</span> (fabs(x)&lt;DBL_EPSILON) value=0.0;
00270   else switch (der)
00271   {
00272     <span class="keywordflow">case</span>  0 : value=sin(c*x)/x; <span class="keywordflow">break</span>;
00273     <span class="keywordflow">case</span>  1 : value=(cos(c*x)*c*x-sin(c*x))/(x*x); <span class="keywordflow">break</span>;
00274     <span class="keywordflow">case</span>  2 : value=-(sin(c*x)*c*c*x*x+2.0*cos(c*x)*c*x-2.0*sin(c*x))/(x*x*x); <span class="keywordflow">break</span>;
00275     <span class="keywordflow">case</span>  3 : value=-(cos(c*x)*c*c*c*x*x*x-3.0*sin(c*x)*c*c*x*x-6.0*cos(c*x)*c*x+6.0*sin(c*x))/(x*x*x*x); <span class="keywordflow">break</span>;
00276     <span class="keywordflow">case</span>  4 : value=(sin(c*x)*c*c*c*c*x*x*x*x+4.0*cos(c*x)*c*c*c*x*x*x-12.0*sin(c*x)*c*c*x*x-24.0*cos(c*x)*c*x+24.0*sin(c*x))/(x*x*x*x*x); <span class="keywordflow">break</span>;
00277     <span class="keywordflow">case</span>  5 : value=(cos(c*x)*c*c*c*c*c*x*x*x*x*x-5.0*sin(c*x)*c*c*c*c*x*x*x*x-20.0*cos(c*x)*c*c*c*x*x*x+60.0*sin(c*x)*c*c*x*x+120.0*cos(c*x)*c*x-120.0*sin(c*x))/(x*x*x*x*x*x); <span class="keywordflow">break</span>;
00278     <span class="keywordflow">case</span>  6 : value=-(sin(c*x)*c*c*c*c*c*c*x*x*x*x*x*x+6.0*cos(c*x)*c*c*c*c*c*x*x*x*x*x-30.0*sin(c*x)*c*c*c*c*x*x*x*x-120.0*cos(c*x)*c*c*c*x*x*x+360.0*sin(c*x)*c*c*x*x+720.0*cos(c*x)*c*x-720.0*sin(c*x))/(x*x*x*x*x*x*x); <span class="keywordflow">break</span>;
00279     <span class="keywordflow">case</span>  7 : value=-(cos(c*x)*c*c*c*c*c*c*c*x*x*x*x*x*x*x-7.0*sin(c*x)*c*c*c*c*c*c*x*x*x*x*x*x-42.0*cos(c*x)*c*c*c*c*c*x*x*x*x*x+210.0*sin(c*x)*c*c*c*c*x*x*x*x+840.0*cos(c*x)*c*c*c*x*x*x-2520.0*sin(c*x)*c*c*x*x-5040.0*cos(c*x)*c*x+5040.0*sin(c*x))/(x*x*x*x*x*x*x*x); <span class="keywordflow">break</span>;
00280     <span class="keywordflow">case</span>  8 : value=(sin(c*x)*c*c*c*c*c*c*c*c*x*x*x*x*x*x*x*x+8.0*cos(c*x)*c*c*c*c*c*c*c*x*x*x*x*x*x*x-56.0*sin(c*x)*c*c*c*c*c*c*x*x*x*x*x*x-336.0*cos(c*x)*c*c*c*c*c*x*x*x*x*x+1680.0*sin(c*x)*c*c*c*c*x*x*x*x+6720.0*cos(c*x)*c*c*c*x*x*x-20160.0*sin(c*x)*c*c*x*x-40320.0*cos(c*x)*c*x+40320.0*sin(c*x))/(x*x*x*x*x*x*x*x*x); <span class="keywordflow">break</span>;
00281     <span class="keywordflow">case</span>  9 : value=(cos(c*x)*c*c*c*c*c*c*c*c*c*x*x*x*x*x*x*x*x*x-9.0*sin(c*x)*c*c*c*c*c*c*c*c*x*x*x*x*x*x*x*x-72.0*cos(c*x)*c*c*c*c*c*c*c*x*x*x*x*x*x*x+504.0*sin(c*x)*c*c*c*c*c*c*x*x*x*x*x*x+3024.0*cos(c*x)*c*c*c*c*c*x*x*x*x*x-15120.0*sin(c*x)*c*c*c*c*x*x*x*x-60480.0*cos(c*x)*c*c*c*x*x*x+181440.0*sin(c*x)*c*c*x*x+362880.0*cos(c*x)*c*x-362880.0*sin(c*x))/pow(x,10.0); <span class="keywordflow">break</span>;
00282     <span class="keywordflow">case</span> 10 : value=-(sin(c*x)*pow(c,10.0)*pow(x,10.0)+10.0*cos(c*x)*c*c*c*c*c*c*c*c*c*x*x*x*x*x*x*x*x*x-90.0*sin(c*x)*c*c*c*c*c*c*c*c*x*x*x*x*x*x*x*x-720.0*cos(c*x)*c*c*c*c*c*c*c*x*x*x*x*x*x*x+5040.0*sin(c*x)*c*c*c*c*c*c*x*x*x*x*x*x+30240.0*cos(c*x)*c*c*c*c*c*x*x*x*x*x-151200.0*sin(c*x)*c*c*c*c*x*x*x*x-604800.0*cos(c*x)*c*c*c*x*x*x+1814400.0*sin(c*x)*c*c*x*x+3628800.0*cos(c*x)*c*x-3628800.0*sin(c*x))/pow(x,11.0); <span class="keywordflow">break</span>;
00283     <span class="keywordflow">case</span> 11 : value=-(cos(c*x)*pow(c,11.0)*pow(x,11.0)-11.0*sin(c*x)*pow(c,10.0)*pow(x,10.0)-110.0*cos(c*x)*c*c*c*c*c*c*c*c*c*x*x*x*x*x*x*x*x*x+990.0*sin(c*x)*c*c*c*c*c*c*c*c*x*x*x*x*x*x*x*x+7920.0*cos(c*x)*c*c*c*c*c*c*c*x*x*x*x*x*x*x-55440.0*sin(c*x)*c*c*c*c*c*c*x*x*x*x*x*x-332640.0*cos(c*x)*c*c*c*c*c*x*x*x*x*x+1663200.0*sin(c*x)*c*c*c*c*x*x*x*x+6652800.0*cos(c*x)*c*c*c*x*x*x-19958400.0*sin(c*x)*c*c*x*x-39916800.0*cos(c*x)*c*x+39916800.0*sin(c*x))/pow(x,12.0); <span class="keywordflow">break</span>;
00284     <span class="keywordflow">case</span> 12 : value=(sin(c*x)*pow(c,12.0)*pow(x,12.0)+12.0*cos(c*x)*pow(c,11.0)*pow(x,11.0)-132.0*sin(c*x)*pow(c,10.0)*pow(x,10.0)-1320.0*cos(c*x)*c*c*c*c*c*c*c*c*c*x*x*x*x*x*x*x*x*x+11880.0*sin(c*x)*c*c*c*c*c*c*c*c*x*x*x*x*x*x*x*x+95040.0*cos(c*x)*c*c*c*c*c*c*c*x*x*x*x*x*x*x-665280.0*sin(c*x)*c*c*c*c*c*c*x*x*x*x*x*x-3991680.0*cos(c*x)*c*c*c*c*c*x*x*x*x*x+19958400.0*sin(c*x)*c*c*c*c*x*x*x*x+79833600.0*cos(c*x)*c*c*c*x*x*x-239500800.0*sin(c*x)*c*c*x*x-479001600.0*cos(c*x)*c*x+479001600.0*sin(c*x))/pow(x,13.0); <span class="keywordflow">break</span>;
00285     <span class="keywordflow">default</span> : value=0.0;
00286   }
00287 
00288   <span class="keywordflow">return</span> value;
00289 }
00290 
00291 complex <span class="keywordtype">double</span> cosc(<span class="keywordtype">double</span> x, <span class="keywordtype">int</span> der, <span class="keyword">const</span> <span class="keywordtype">double</span> *param)    <span class="comment">/* K(x) = cos(cx)/x */</span>
00292 {
00293   <span class="keywordtype">double</span> c=param[0];
00294   <span class="keywordtype">double</span> value=0.0;
00295   <span class="keywordtype">double</span> sign;
00296 
00297   <span class="keywordflow">if</span> (x&lt;0) sign=-1.0; else sign=1.0;
00298   x=fabs(x);
00299 
00300   if (fabs(x)&lt;DBL_EPSILON) value=0.0;
00301   else switch (der)
00302   {
00303     <span class="keywordflow">case</span>  0 : value=cos(c*x)/x; <span class="keywordflow">break</span>;
00304     <span class="keywordflow">case</span>  1 : value=-(sin(c*x)*c*x+cos(c*x))/(x*x); <span class="keywordflow">break</span>;
00305     <span class="keywordflow">case</span>  2 : value=(-cos(c*x)*c*c*x*x+2.0*sin(c*x)*c*x+2.0*cos(c*x))/(x*x*x); <span class="keywordflow">break</span>;
00306     <span class="keywordflow">case</span>  3 : value=(sin(c*x)*c*c*c*x*x*x+3.0*cos(c*x)*c*c*x*x-6.0*sin(c*x)*c*x-6.0*cos(c*x))/(x*x*x*x); <span class="keywordflow">break</span>;
00307     <span class="keywordflow">case</span>  4 : value=(cos(c*x)*c*c*c*c*x*x*x*x-4.0*sin(c*x)*c*c*c*x*x*x-12.0*cos(c*x)*c*c*x*x+24.0*sin(c*x)*c*x+24.0*cos(c*x))/(x*x*x*x*x); <span class="keywordflow">break</span>;
00308     <span class="keywordflow">case</span>  5 : value=-(sin(c*x)*c*c*c*c*c*x*x*x*x*x+5.0*cos(c*x)*c*c*c*c*x*x*x*x-20.0*sin(c*x)*c*c*c*x*x*x-60.0*cos(c*x)*c*c*x*x+120.0*sin(c*x)*c*x+120.0*cos(c*x))/(x*x*x*x*x*x); <span class="keywordflow">break</span>;
00309     <span class="keywordflow">case</span>  6 : value=-(cos(c*x)*c*c*c*c*c*c*x*x*x*x*x*x-6.0*sin(c*x)*c*c*c*c*c*x*x*x*x*x-30.0*cos(c*x)*c*c*c*c*x*x*x*x+120.0*sin(c*x)*c*c*c*x*x*x+360.0*cos(c*x)*c*c*x*x-720.0*sin(c*x)*c*x-720.0*cos(c*x))/(x*x*x*x*x*x*x); <span class="keywordflow">break</span>;
00310     <span class="keywordflow">case</span>  7 : value=(sin(c*x)*c*c*c*c*c*c*c*x*x*x*x*x*x*x+7.0*cos(c*x)*c*c*c*c*c*c*x*x*x*x*x*x-42.0*sin(c*x)*c*c*c*c*c*x*x*x*x*x-210.0*cos(c*x)*c*c*c*c*x*x*x*x+840.0*sin(c*x)*c*c*c*x*x*x+2520.0*cos(c*x)*c*c*x*x-5040.0*sin(c*x)*c*x-5040.0*cos(c*x))/(x*x*x*x*x*x*x*x); <span class="keywordflow">break</span>;
00311     <span class="keywordflow">case</span>  8 : value=(cos(c*x)*c*c*c*c*c*c*c*c*x*x*x*x*x*x*x*x-8.0*sin(c*x)*c*c*c*c*c*c*c*x*x*x*x*x*x*x-56.0*cos(c*x)*c*c*c*c*c*c*x*x*x*x*x*x+336.0*sin(c*x)*c*c*c*c*c*x*x*x*x*x+1680.0*cos(c*x)*c*c*c*c*x*x*x*x-6720.0*sin(c*x)*c*c*c*x*x*x-20160.0*cos(c*x)*c*c*x*x+40320.0*sin(c*x)*c*x+40320.0*cos(c*x))/(x*x*x*x*x*x*x*x*x); <span class="keywordflow">break</span>;
00312     <span class="keywordflow">case</span>  9 : value=-(sin(c*x)*c*c*c*c*c*c*c*c*c*x*x*x*x*x*x*x*x*x+9.0*cos(c*x)*c*c*c*c*c*c*c*c*x*x*x*x*x*x*x*x-72.0*sin(c*x)*c*c*c*c*c*c*c*x*x*x*x*x*x*x-504.0*cos(c*x)*c*c*c*c*c*c*x*x*x*x*x*x+3024.0*sin(c*x)*c*c*c*c*c*x*x*x*x*x+15120.0*cos(c*x)*c*c*c*c*x*x*x*x-60480.0*sin(c*x)*c*c*c*x*x*x-181440.0*cos(c*x)*c*c*x*x+362880.0*sin(c*x)*c*x+362880.0*cos(c*x))/pow(x,10.0); <span class="keywordflow">break</span>;
00313     <span class="keywordflow">case</span> 10 : value=-(cos(c*x)*pow(c,10.0)*pow(x,10.0)-10.0*sin(c*x)*c*c*c*c*c*c*c*c*c*x*x*x*x*x*x*x*x*x-90.0*cos(c*x)*c*c*c*c*c*c*c*c*x*x*x*x*x*x*x*x+720.0*sin(c*x)*c*c*c*c*c*c*c*x*x*x*x*x*x*x+5040.0*cos(c*x)*c*c*c*c*c*c*x*x*x*x*x*x-30240.0*sin(c*x)*c*c*c*c*c*x*x*x*x*x-151200.0*cos(c*x)*c*c*c*c*x*x*x*x+604800.0*sin(c*x)*c*c*c*x*x*x+1814400.0*cos(c*x)*c*c*x*x-3628800.0*sin(c*x)*c*x-3628800.0*cos(c*x))/pow(x,11.0); <span class="keywordflow">break</span>;
00314     <span class="keywordflow">case</span> 11 : value=(sin(c*x)*pow(c,11.0)*pow(x,11.0)+11.0*cos(c*x)*pow(c,10.0)*pow(x,10.0)-110.0*sin(c*x)*c*c*c*c*c*c*c*c*c*x*x*x*x*x*x*x*x*x-990.0*cos(c*x)*c*c*c*c*c*c*c*c*x*x*x*x*x*x*x*x+7920.0*sin(c*x)*c*c*c*c*c*c*c*x*x*x*x*x*x*x+55440.0*cos(c*x)*c*c*c*c*c*c*x*x*x*x*x*x-332640.0*sin(c*x)*c*c*c*c*c*x*x*x*x*x-1663200.0*cos(c*x)*c*c*c*c*x*x*x*x+6652800.0*sin(c*x)*c*c*c*x*x*x+19958400.0*cos(c*x)*c*c*x*x-39916800.0*sin(c*x)*c*x-39916800.0*cos(c*x))/pow(x,12.0); <span class="keywordflow">break</span>;
00315     <span class="keywordflow">case</span> 12 : value=(cos(c*x)*pow(c,12.0)*pow(x,12.0)-12.0*sin(c*x)*pow(c,11.0)*pow(x,11.0)-132.0*cos(c*x)*pow(c,10.0)*pow(x,10.0)+1320.0*sin(c*x)*c*c*c*c*c*c*c*c*c*x*x*x*x*x*x*x*x*x+11880.0*cos(c*x)*c*c*c*c*c*c*c*c*x*x*x*x*x*x*x*x-95040.0*sin(c*x)*c*c*c*c*c*c*c*x*x*x*x*x*x*x-665280.0*cos(c*x)*c*c*c*c*c*c*x*x*x*x*x*x+3991680.0*sin(c*x)*c*c*c*c*c*x*x*x*x*x+19958400.0*cos(c*x)*c*c*c*c*x*x*x*x-79833600.0*sin(c*x)*c*c*c*x*x*x-239500800.0*cos(c*x)*c*c*x*x+479001600.0*sin(c*x)*c*x+479001600.0*cos(c*x))/pow(x,13.0); <span class="keywordflow">break</span>;
00316     <span class="keywordflow">default</span> : value=0.0;
00317   }
00318   value*=pow(sign,der);
00319 
00320   <span class="keywordflow">return</span> value;
00321 }
00322 
00323 complex <span class="keywordtype">double</span> cot(<span class="keywordtype">double</span> x, <span class="keywordtype">int</span> der, <span class="keyword">const</span> <span class="keywordtype">double</span> *param)   <span class="comment">/* K(x) = cot(cx) */</span>
00324 {
00325   <span class="keywordtype">double</span> c=param[0];
00326   <span class="keywordtype">double</span> value=0.0;
00327 
00328   <span class="keywordflow">if</span> (fabs(x)&lt;DBL_EPSILON) value=0.0;
00329   else switch (der)
00330   {
00331     <span class="keywordflow">case</span>  0 : value = 1.0/tan(c * x); <span class="keywordflow">break</span>;
00332     <span class="keywordflow">case</span>  1 : value = -(1.0 + pow(1.0/tan(c * x), 2.0)) * c; <span class="keywordflow">break</span>;
00333     <span class="keywordflow">case</span>  2 : value = 2.0 * 1.0/tan(c * x) * (1.0 + pow(1.0/tan(c * x), 2.0)) * c * c; <span class="keywordflow">break</span>;
00334     <span class="keywordflow">case</span>  3 : value = -2.0 * (1.0 + pow(1.0/tan(c * x), 2.0)) * pow(c, 3.0) * (1.0 + 3.0 * pow(1.0/tan(c * x), 2.0)); <span class="keywordflow">break</span>;
00335     <span class="keywordflow">case</span>  4 : value = 8.0 * (1.0 + pow(1.0/tan(c * x), 2.0)) * pow(c, 4.0) * 1.0/tan(c * x) * (2.0 + 3.0 * pow(1.0/tan(c * x), 2.0)); <span class="keywordflow">break</span>;
00336     <span class="keywordflow">case</span>  5 : value = -0.8e1 * (0.1e1 + pow(1.0/tan(c * x), 0.2e1)) * pow(c, 0.5e1) * (0.15e2 * pow(1.0/tan(c * x), 0.2e1) + 0.15e2 * pow(1.0/tan(c * x), 0.4e1) + 0.2e1); <span class="keywordflow">break</span>;
00337     <span class="keywordflow">case</span>  6 : value = 0.16e2 * (0.1e1 + pow(1.0/tan(c * x), 0.2e1)) * pow(c, 0.6e1) * 1.0/tan(c * x) * (0.60e2 * pow(1.0/tan(c * x), 0.2e1) + 0.45e2 * pow(1.0/tan(c * x), 0.4e1) + 0.17e2); <span class="keywordflow">break</span>;
00338     <span class="keywordflow">case</span>  7 : value = -0.16e2 * (0.1e1 + pow(1.0/tan(c * x), 0.2e1)) * pow(c, 0.7e1) * (0.525e3 * pow(1.0/tan(c * x), 0.4e1) + 0.315e3 * pow(1.0/tan(c * x), 0.6e1) + 0.231e3 * pow(1.0/tan(c * x), 0.2e1) + 0.17e2); <span class="keywordflow">break</span>;
00339     <span class="keywordflow">case</span>  8 : value = 0.128e3 * (0.1e1 + pow(1.0/tan(c * x), 0.2e1)) * pow(c, 0.8e1) * 1.0/tan(c * x) * (0.630e3 * pow(1.0/tan(c * x), 0.4e1) + 0.315e3 * pow(1.0/tan(c * x), 0.6e1) + 0.378e3 * pow(1.0/tan(c * x), 0.2e1) + 0.62e2); <span class="keywordflow">break</span>;
00340     <span class="keywordflow">case</span>  9 : value = -0.128e3 * (0.1e1 + pow(1.0/tan(c * x), 0.2e1)) * pow(c, 0.9e1) * (0.6615e4 * pow(1.0/tan(c * x), 0.6e1) + 0.2835e4 * pow(1.0/tan(c * x), 0.8e1) + 0.5040e4 * pow(1.0/tan(c * x), 0.4e1) + 0.1320e4 * pow(1.0/tan(c * x), 0.2e1) + 0.62e2); <span class="keywordflow">break</span>;
00341     <span class="keywordflow">case</span> 10 : value = 0.256e3 * (0.1e1 + pow(1.0/tan(c * x), 0.2e1)) * pow(c, 0.10e2) * 1.0/tan(c * x) * (0.37800e5 * pow(1.0/tan(c * x), 0.6e1) + 0.14175e5 * pow(1.0/tan(c * x), 0.8e1) + 0.34965e5 * pow(1.0/tan(c * x), 0.4e1) + 0.12720e5 * pow(1.0/tan(c * x), 0.2e1) + 0.1382e4); <span class="keywordflow">break</span>;
00342     <span class="keywordflow">case</span> 11 : value = -0.256e3 * (0.1e1 + pow(1.0/tan(c * x), 0.2e1)) * pow(c, 0.11e2) * (0.467775e6 * pow(1.0/tan(c * x), 0.8e1) + 0.155925e6 * pow(1.0/tan(c * x), 0.10e2) + 0.509355e6 * pow(1.0/tan(c * x), 0.6e1) + 0.238425e6 * pow(1.0/tan(c * x), 0.4e1) + 0.42306e5 * pow(1.0/tan(c * x), 0.2e1) + 0.1382e4); <span class="keywordflow">break</span>;
00343     <span class="keywordflow">case</span> 12 : value = 0.1024e4 * (0.1e1 + pow(1.0/tan(c * x), 0.2e1)) * pow(c, 0.12e2) * 1.0/tan(c * x) * (0.1559250e7 * pow(1.0/tan(c * x), 0.8e1) + 0.467775e6 * pow(1.0/tan(c * x), 0.10e2) + 0.1954260e7 * pow(1.0/tan(c * x), 0.6e1) + 0.1121670e7 * pow(1.0/tan(c * x), 0.4e1) + 0.280731e6 * pow(1.0/tan(c * x), 0.2e1) + 0.21844e5); <span class="keywordflow">break</span>;
00344     <span class="keywordflow">default</span> : value=0.0;
00345   }
00346 
00347   <span class="keywordflow">return</span> value;
00348 }
00349 
00350 
00351 complex one_over_cube(<span class="keywordtype">double</span> x, <span class="keywordtype">int</span> der, <span class="keyword">const</span> <span class="keywordtype">double</span> *param)
00352 {
00353   <span class="keywordtype">double</span> value=0.0;
00354 
00355   <span class="keywordflow">if</span> (fabs(x)&lt;DBL_EPSILON) value=0.0;
00356   else switch (der)
00357   {
00358     <span class="keywordflow">case</span>  0 : value = 1.0/(x*x*x); <span class="keywordflow">break</span>;
00359     <span class="keywordflow">case</span>  1 : value = -3.0/(x*x*x*x); <span class="keywordflow">break</span>;
00360     <span class="keywordflow">case</span>  2 : value = 12.0/(x*x*x*x*x); <span class="keywordflow">break</span>;
00361     <span class="keywordflow">case</span>  3 : value = -60.0/(x*x*x*x*x*x); <span class="keywordflow">break</span>;
00362     <span class="keywordflow">case</span>  4 : value = 360.0/(x*x*x*x*x*x*x); <span class="keywordflow">break</span>;
00363     <span class="keywordflow">case</span>  5 : value = -2520.0/(x*x*x*x*x*x*x*x); <span class="keywordflow">break</span>;
00364     <span class="keywordflow">case</span>  6 : value = 20160.0/pow(x, 9.0); <span class="keywordflow">break</span>;
00365     <span class="keywordflow">case</span>  7 : value = -181440.0/pow(x, 10.0); <span class="keywordflow">break</span>;
00366     <span class="keywordflow">case</span>  8 : value = 1814400.0/pow(x, 11.0); <span class="keywordflow">break</span>;
00367     <span class="keywordflow">case</span>  9 : value = -19958400.0/pow(x, 12.0); <span class="keywordflow">break</span>;
00368     <span class="keywordflow">case</span>  10 : value = 239500800.0/pow(x, 13.0); <span class="keywordflow">break</span>;
00369     <span class="keywordflow">case</span>  11 : value = -3113510400.0/pow(x, 14.0); <span class="keywordflow">break</span>;
00370     <span class="keywordflow">case</span>  12 : value = 43589145600.0/pow(x, 15.0); <span class="keywordflow">break</span>;
00371     <span class="keywordflow">default</span> : value=0.0;
00372   }
00373 
00374   <span class="keywordflow">return</span> value;
00375 }
00376 
00377 
00378 <span class="comment">/* \} */</span>
00379 
00380 <span class="comment">/* kernels.c */</span>
</pre></div>    <hr size="1"/>
    Generated on 22 Jan 2007 by Doxygen 1.4.1
  </body>
</html>
