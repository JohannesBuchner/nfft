<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
    <title>
      NFFT 3.0.3 API Reference - NFFT: simple_test.c Source File
    </title>
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <table>
      <tr>
        <td valign="top">
          <img src="images/logo.png" alt="NFFT Logo">
        </td>
        <td align="left" valign="bottom" width="100%">
          <H1nc>3.0.3 API Reference</H1nc>
        </td>
      </tr>
    </table>  
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">examples</a>&nbsp;/&nbsp;<a class="el" href="dir_000031.html">nfsft</a></div>
<h1>nfsft/simple_test.c</h1><div class="fragment"><pre class="fragment">00001 <span class="comment">/* Include standard C headers. */</span>
00002 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00003 <span class="preprocessor">#include &lt;math.h&gt;</span>
00004 <span class="preprocessor">#include &lt;string.h&gt;</span>
00005 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00006 
00007 <span class="comment">/* Include NFFT3 library header. */</span>
00008 <span class="preprocessor">#include "<a class="code" href="nfft3_8h.html">nfft3.h</a>"</span>
00009 
00010 <span class="comment">/* Include NFFT 3 utilities headers. */</span>
00011 <span class="preprocessor">#include "<a class="code" href="util_8h.html">util.h</a>"</span>
00012 
00013 <span class="keywordtype">void</span> simple_test_nfsft()
00014 {
00015   <span class="keywordtype">int</span> j;                      
00016   <span class="keywordtype">int</span> k;                      
00017   <span class="keywordtype">int</span> n;                      
00018   <a class="code" href="structnfsft__plan.html">nfsft_plan</a> plan;            
00019   <span class="keyword">const</span> <span class="keywordtype">int</span> N = 8;            
00020   <span class="keyword">const</span> <span class="keywordtype">int</span> M = 8;            
00021   <span class="keyword">const</span> <span class="keywordtype">int</span> THRESHOLD = 1000; 
00024   <span class="comment">/* Precompute. */</span>
00025   <a class="code" href="group__nfsft.html#ga4">nfsft_precompute</a>(N,THRESHOLD,0U,0U);
00026 
00027   <span class="comment">/* Init a transform plan using the guru interface. All arrays for input and</span>
00028 <span class="comment">   * output variables are allocated by nfsft_init_guru(). Computations are</span>
00029 <span class="comment">   * performed with respect to L^2-normalized spherical harmonics Y_k^n. The</span>
00030 <span class="comment">   * array of spherical Fourier coefficients is preserved during</span>
00031 <span class="comment">   * transformations. The internal NFFT uses a cut-off parameter of 6.</span>
00032 <span class="comment">   */</span>
00033   <a class="code" href="group__nfsft.html#ga3">nfsft_init_guru</a>(&amp;plan, N, M, NFSFT_MALLOC_X | NFSFT_MALLOC_F |
00034     NFSFT_MALLOC_F_HAT | NFSFT_NORMALIZED | NFSFT_PRESERVE_F_HAT,
00035     ((N&gt;512)?(0U):(PRE_PHI_HUT | PRE_PSI)) | FFTW_INIT |
00036     FFT_OUT_OF_PLACE, 6);
00037 
00038   <span class="comment">/* Init pseudo random nodes. */</span>
00039   <span class="keywordflow">for</span> (j = 0; j &lt; plan.<a class="code" href="structnfsft__plan.html#o1">M_total</a>; j++)
00040   {
00041     plan.<a class="code" href="structnfsft__plan.html#o5">x</a>[2*j]=((double)rand())/RAND_MAX-0.5;
00042     plan.<a class="code" href="structnfsft__plan.html#o5">x</a>[2*j+1]=0.5*((double)rand())/RAND_MAX;
00043   }
00044 
00045   <span class="comment">/* Do precomputation for nodes. */</span>
00046   nfsft_precompute_x(&amp;plan);
00047 
00048   <span class="comment">/* Init pseudo random Fourier coefficients. */</span>
00049   <span class="keywordflow">for</span> (k = 0; k &lt;= plan.<a class="code" href="structnfsft__plan.html#o4">N</a>; k++)
00050   {
00051     <span class="keywordflow">for</span> (n = -k; n &lt;= k; n++)
00052     {
00053       plan.<a class="code" href="structnfsft__plan.html#o2">f_hat</a>[<a class="code" href="group__nfsft.html#ga40">NFSFT_INDEX</a>(k,n,&amp;plan)] =
00054         ((double)rand())/RAND_MAX - 0.5 +  I*(((double)rand())/RAND_MAX - 0.5);
00055     }
00056   }
00057 
00058   <span class="comment">/*for (k = 0; k &lt; plan.N_total; k++)</span>
00059 <span class="comment">  {</span>
00060 <span class="comment">     fprintf(stderr,"f_hat[%d] = %le +I*%le\n",k,creal(plan.f_hat[k]),</span>
00061 <span class="comment">       cimag(plan.f_hat[k]));</span>
00062 <span class="comment">  }*/</span>
00063 
00064   <span class="comment">//nfft_vpr_complex(plan.f_hat,plan.N_total,"given Fourier coefficients, vector f_hat");</span>
00065 
00066   <span class="comment">/* Compute direct transformation and display the result. */</span>
00067   <a class="code" href="group__nfsft.html#ga6">ndsft_trafo</a>(&amp;plan);
00068   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(plan.<a class="code" href="structnfsft__plan.html#o3">f</a>,plan.<a class="code" href="structnfsft__plan.html#o1">M_total</a>,<span class="stringliteral">"ndsft, vector f"</span>);
00069 
00070   <span class="comment">/* Compute approximate transformation and display the result. */</span>
00071   <a class="code" href="group__nfsft.html#ga8">nfsft_trafo</a>(&amp;plan);
00072   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(plan.<a class="code" href="structnfsft__plan.html#o3">f</a>, plan.<a class="code" href="structnfsft__plan.html#o1">M_total</a>,<span class="stringliteral">"nfsft, vector f"</span>);
00073   <span class="comment">/*for (k = 0; k &lt; plan.N_total; k++)</span>
00074 <span class="comment">  {</span>
00075 <span class="comment">     fprintf(stderr,"f_hat[%d] = %le +I*%le\n",k,creal(plan.f_hat[k]),</span>
00076 <span class="comment">       cimag(plan.f_hat[k]));</span>
00077 <span class="comment">  }*/</span>
00078 
00079   <span class="comment">/* Compute direct adjoint transformation and display the result. */</span>
00080   <a class="code" href="group__nfsft.html#ga9">nfsft_adjoint</a>(&amp;plan);
00081   <span class="keywordflow">for</span> (k = 0; k &lt;= plan.<a class="code" href="structnfsft__plan.html#o4">N</a>; k++)
00082   {
00083     <span class="keywordflow">for</span> (n = -k; n &lt;= k; n++)
00084     {
00085       fprintf(stdout,<span class="stringliteral">"f_hat[%d,%d] = %le + I*%le\n"</span>,k,n,
00086         creal(plan.<a class="code" href="structnfsft__plan.html#o2">f_hat</a>[<a class="code" href="group__nfsft.html#ga40">NFSFT_INDEX</a>(k,n,&amp;plan)]),
00087         cimag(plan.<a class="code" href="structnfsft__plan.html#o2">f_hat</a>[<a class="code" href="group__nfsft.html#ga40">NFSFT_INDEX</a>(k,n,&amp;plan)]));
00088     }
00089   }
00090   <span class="comment">//nfft_vpr_complex(plan.f_hat,plan.N_total,"adjoint ndsft, vector f_hat");</span>
00091 
00092   <span class="comment">/* COmpute approximate adjoint transformation and display the result */</span>
00093   <a class="code" href="group__nfsft.html#ga7">ndsft_adjoint</a>(&amp;plan);
00094   <span class="keywordflow">for</span> (k = 0; k &lt;= plan.<a class="code" href="structnfsft__plan.html#o4">N</a>; k++)
00095   {
00096     <span class="keywordflow">for</span> (n = -k; n &lt;= k; n++)
00097     {
00098       fprintf(stdout,<span class="stringliteral">"f_hat[%d,%d] = %le + I*%le\n"</span>,k,n,
00099         creal(plan.<a class="code" href="structnfsft__plan.html#o2">f_hat</a>[<a class="code" href="group__nfsft.html#ga40">NFSFT_INDEX</a>(k,n,&amp;plan)]),
00100         cimag(plan.<a class="code" href="structnfsft__plan.html#o2">f_hat</a>[<a class="code" href="group__nfsft.html#ga40">NFSFT_INDEX</a>(k,n,&amp;plan)]));
00101     }
00102   }
00103   <span class="comment">//nfft_vpr_complex(plan.f_hat,plan.N_total,"adjoint nfsft, vector f_hat");</span>
00104 
00105   <span class="comment">/* Finalise the plan. */</span>
00106   <a class="code" href="group__nfsft.html#ga10">nfsft_finalize</a>(&amp;plan);
00107   <a class="code" href="group__nfsft.html#ga5">nfsft_forget</a>();
00108 }
00109 
00110 <span class="keywordtype">int</span> <a class="code" href="flags_8c.html#a6">main</a>()
00111 {
00112   system(<span class="stringliteral">"clear"</span>);
00113   printf(<span class="stringliteral">"1) computing a ndsft, a nfsft, an adjoint ndsft, and an adjoint nfsft\n\n"</span>);
00114   simple_test_nfsft();
00115 
00116   <span class="keywordflow">return</span> EXIT_SUCCESS;
00117 }
</pre></div>    <hr size="1"/>
    Generated on 5 Feb 2007 by Doxygen 1.4.1
  </body>
</html>
