<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
    <title>
      NFFT 3.0.2 API Reference - NFFT: construct_data_3d.c Source File
    </title>
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <table>
      <tr>
        <td valign="top">
          <img src="images/logo.png" alt="NFFT Logo">
        </td>
        <td align="left" valign="bottom" width="100%">
          <H1nc>3.0.2 API Reference</H1nc>
        </td>
      </tr>
    </table>  
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="dir_000006.html">applications</a>&nbsp;/&nbsp;<a class="el" href="dir_000007.html">mri</a>&nbsp;/&nbsp;<a class="el" href="dir_000009.html">mri3d</a></div>
<h1>construct_data_3d.c</h1><div class="fragment"><pre class="fragment">00001 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00002 <span class="preprocessor">#include &lt;math.h&gt;</span>
00003 <span class="preprocessor">#include "<a class="code" href="util_8h.html">util.h</a>"</span>
00004 <span class="preprocessor">#include "<a class="code" href="nfft3_8h.html">nfft3.h</a>"</span>
00005 
00012 <span class="keywordtype">void</span> <a class="code" href="group__applications__mri2d__construct__data__2d.html#ga0">construct</a>(<span class="keywordtype">char</span> * file, <span class="keywordtype">int</span> N, <span class="keywordtype">int</span> M, <span class="keywordtype">int</span> Z)
00013 {
00014   <span class="keywordtype">int</span> j,k,l;                <span class="comment">/* some variables */</span>
00015   <span class="keywordtype">double</span> real;
00016   <a class="code" href="structnfft__plan.html">nfft_plan</a> my_plan;        <span class="comment">/* plan for the three dimensional nfft  */</span>
00017   FILE* fp,*fk;
00018   <span class="keywordtype">int</span> my_N[3],my_n[3];      <span class="comment">/* to init the nfft */</span>
00019 
00020 
00021   <span class="comment">/* initialise my_plan */</span>
00022   <span class="comment">//nfft_init_3d(&amp;my_plan,Z,N,N,M);</span>
00023   my_N[0]=Z; my_n[0]=ceil(Z*1.2);
00024   my_N[1]=N; my_n[1]=ceil(N*1.2);
00025   my_N[2]=N; my_n[2]=ceil(N*1.2);
00026   <a class="code" href="group__nfft.html#ga9">nfft_init_guru</a>(&amp;my_plan, 3, my_N, M, my_n, 6,
00027                       PRE_PHI_HUT| PRE_PSI |MALLOC_X| MALLOC_F_HAT|
00028                       MALLOC_F| FFTW_INIT| FFT_OUT_OF_PLACE,
00029                       FFTW_MEASURE| FFTW_DESTROY_INPUT);
00030 
00031   fp=fopen(<span class="stringliteral">"knots.dat"</span>,<span class="stringliteral">"r"</span>);
00032    
00033   <span class="keywordflow">for</span>(j=0;j&lt;M;j++)
00034     fscanf(fp,<span class="stringliteral">"%le %le %le"</span>,&amp;my_plan.<a class="code" href="structnfft__plan.html#o14">x</a>[3*(j)+1],
00035       &amp;my_plan.<a class="code" href="structnfft__plan.html#o14">x</a>[3*(j)+2],&amp;my_plan.<a class="code" href="structnfft__plan.html#o14">x</a>[3*(j)+0]);
00036 
00037   fclose(fp);
00038 
00039   fp=fopen(<span class="stringliteral">"input_f.dat"</span>,<span class="stringliteral">"r"</span>);
00040   fk=fopen(file,<span class="stringliteral">"w"</span>);
00041 
00042   <span class="keywordflow">for</span>(l=0;l&lt;Z;l++) {
00043     <span class="keywordflow">for</span>(j=0;j&lt;N;j++)
00044     {
00045       <span class="keywordflow">for</span>(k=0;k&lt;N;k++)
00046       {
00047         <span class="comment">//fscanf(fp,"%le ",&amp;my_plan.f_hat[(N*N*(Z-l)+N*j+k+N*N*Z/2)%(N*N*Z)][0]);</span>
00048         fscanf(fp,<span class="stringliteral">"%le "</span>,&amp;real);
00049         my_plan.<a class="code" href="structnfft__plan.html#o2">f_hat</a>[(N*N*l+N*j+k)] = real;
00050       }
00051     }
00052   }
00053     
00054     <span class="keywordflow">if</span>(my_plan.<a class="code" href="structnfft__plan.html#o12">nfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga20">PRE_PSI</a>)
00055       <a class="code" href="group__nfft.html#ga12">nfft_precompute_psi</a>(&amp;my_plan);
00056 
00057     <a class="code" href="group__nfft.html#ga2">nfft_trafo</a>(&amp;my_plan);
00058 
00059     
00060     <span class="keywordflow">for</span>(j=0;j&lt;my_plan.<a class="code" href="structnfft__plan.html#o1">M_total</a>;j++)
00061       fprintf(fk,<span class="stringliteral">"%le %le %le %le %le\n"</span>,my_plan.<a class="code" href="structnfft__plan.html#o14">x</a>[3*j+1],
00062       my_plan.<a class="code" href="structnfft__plan.html#o14">x</a>[3*j+2],my_plan.<a class="code" href="structnfft__plan.html#o14">x</a>[3*j+0],creal(my_plan.<a class="code" href="structnfft__plan.html#o3">f</a>[j]),cimag(my_plan.<a class="code" href="structnfft__plan.html#o3">f</a>[j]));
00063 
00064     
00065   
00066   fclose(fk);
00067   fclose(fp);
00068 
00069   <a class="code" href="group__nfft.html#ga15">nfft_finalize</a>(&amp;my_plan);
00070 }
00071 
00072 <span class="keywordtype">int</span> <a class="code" href="flags_8c.html#a6">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)
00073 { 
00074   <span class="keywordflow">if</span> (argc &lt;= 4) {
00075     printf(<span class="stringliteral">"usage: ./construct_data FILENAME N M Z\n"</span>);
00076     <span class="keywordflow">return</span> 1;
00077   }
00078 
00079   <a class="code" href="group__applications__mri2d__construct__data__2d.html#ga0">construct</a>(argv[1], atoi(argv[2]),atoi(argv[3]),atoi(argv[4]));
00080   
00081   <span class="keywordflow">return</span> 1;
00082 }
00083 <span class="comment">/* \} */</span>
</pre></div>    <hr size="1"/>
    Generated on 22 Jan 2007 by Doxygen 1.4.1
  </body>
</html>
