<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
    <title>
      NFFT 3.0.3 API Reference - NFFT: simple_test.c Source File
    </title>
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <table>
      <tr>
        <td valign="top">
          <img src="images/logo.png" alt="NFFT Logo">
        </td>
        <td align="left" valign="bottom" width="100%">
          <H1nc>3.0.3 API Reference</H1nc>
        </td>
      </tr>
    </table>  
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">examples</a>&nbsp;/&nbsp;<a class="el" href="dir_000030.html">fpt</a></div>
<h1>fpt/simple_test.c</h1><div class="fragment"><pre class="fragment">00001 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00002 <span class="preprocessor">#include &lt;math.h&gt;</span>
00003 <span class="preprocessor">#include &lt;string.h&gt;</span>
00004 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00005 <span class="preprocessor">#include "<a class="code" href="util_8h.html">util.h</a>"</span>
00006 <span class="preprocessor">#include "<a class="code" href="nfft3_8h.html">nfft3.h</a>"</span>
00007 
00008 <span class="keywordtype">void</span> simple_test_nfft_1d()
00009 {
00010   <span class="keywordtype">int</span> j,k;                              
00011   <a class="code" href="structnfft__plan.html">nfft_plan</a> my_plan;                    
00013   <span class="keywordtype">int</span> N[1],n[1];
00014   N[0]=14; n[0]=32;
00015 
00017  <a class="code" href="group__nfft.html#ga9">nfft_init_guru</a>(&amp;my_plan, 1, N, 19, n, 6,
00018                  PRE_PHI_HUT| PRE_LIN_PSI| MALLOC_X| MALLOC_F_HAT| MALLOC_F|
00019      FFTW_INIT| FFT_OUT_OF_PLACE,
00020      FFTW_ESTIMATE| FFTW_DESTROY_INPUT);
00021 
00023   <span class="keywordflow">for</span>(j=0;j&lt;my_plan.<a class="code" href="structnfft__plan.html#o1">M_total</a>;j++)
00024     {
00025       my_plan.<a class="code" href="structnfft__plan.html#o14">x</a>[j]=((double)rand())/RAND_MAX-0.5;
00026     }
00027 
00029   <span class="keywordflow">if</span>(my_plan.<a class="code" href="structnfft__plan.html#o12">nfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga27">PRE_ONE_PSI</a>)
00030       <a class="code" href="group__nfft.html#ga10">nfft_precompute_one_psi</a>(&amp;my_plan);
00031 
00033   <span class="keywordflow">for</span>(k=0;k&lt;my_plan.<a class="code" href="structnfft__plan.html#o0">N_total</a>;k++)
00034     my_plan.<a class="code" href="structnfft__plan.html#o2">f_hat</a>[k] = ((double)rand())/RAND_MAX + I* ((double)rand())/RAND_MAX;
00035 
00036   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_plan.<a class="code" href="structnfft__plan.html#o2">f_hat</a>,my_plan.<a class="code" href="structnfft__plan.html#o0">N_total</a>,<span class="stringliteral">"given Fourier coefficients, vector f_hat"</span>); 
00037 
00039   <a class="code" href="group__nfft.html#ga0">ndft_trafo</a>(&amp;my_plan);
00040   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_plan.<a class="code" href="structnfft__plan.html#o3">f</a>,my_plan.<a class="code" href="structnfft__plan.html#o1">M_total</a>,<span class="stringliteral">"ndft, vector f"</span>); 
00041 
00043   <a class="code" href="group__nfft.html#ga2">nfft_trafo</a>(&amp;my_plan);
00044   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_plan.<a class="code" href="structnfft__plan.html#o3">f</a>,my_plan.<a class="code" href="structnfft__plan.html#o1">M_total</a>,<span class="stringliteral">"nfft, vector f"</span>);
00045 
00047   <a class="code" href="group__nfft.html#ga1">ndft_adjoint</a>(&amp;my_plan);
00048   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_plan.<a class="code" href="structnfft__plan.html#o2">f_hat</a>,my_plan.<a class="code" href="structnfft__plan.html#o0">N_total</a>,<span class="stringliteral">"adjoint ndft, vector f_hat"</span>);
00049 
00051   <a class="code" href="group__nfft.html#ga3">nfft_adjoint</a>(&amp;my_plan);
00052   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_plan.<a class="code" href="structnfft__plan.html#o2">f_hat</a>,my_plan.<a class="code" href="structnfft__plan.html#o0">N_total</a>,<span class="stringliteral">"adjoint nfft, vector f_hat"</span>);
00053 
00055   <a class="code" href="group__nfft.html#ga15">nfft_finalize</a>(&amp;my_plan);
00056 }
00057 
00058 <span class="keywordtype">void</span> simple_test_nfft_2d()
00059 {
00060   <span class="keywordtype">int</span> j,k;                              
00061   <a class="code" href="structnfft__plan.html">nfft_plan</a> my_plan;                    
00063   <span class="keywordtype">int</span> N[2],n[2];
00064   N[0]=10; n[0]=32;
00065   N[1]=10; n[1]=64;
00066 
00068   <span class="comment">//nfft_init_2d(&amp;my_plan,12,12,19);</span>
00069   <a class="code" href="group__nfft.html#ga9">nfft_init_guru</a>(&amp;my_plan, 2, N, 19, n, 4,
00070      PRE_PHI_HUT| PRE_LIN_PSI| MALLOC_X| MALLOC_F_HAT| MALLOC_F|
00071      FFTW_INIT, FFTW_ESTIMATE| FFTW_DESTROY_INPUT);
00072 
00074   <span class="keywordflow">for</span>(j=0;j&lt;my_plan.<a class="code" href="structnfft__plan.html#o1">M_total</a>;j++)
00075     {
00076       my_plan.<a class="code" href="structnfft__plan.html#o14">x</a>[2*j]=((double)rand())/RAND_MAX-0.5;
00077       my_plan.<a class="code" href="structnfft__plan.html#o14">x</a>[2*j+1]=((double)rand())/RAND_MAX-0.5;
00078     }
00079 
00081   <span class="keywordflow">if</span>(my_plan.<a class="code" href="structnfft__plan.html#o12">nfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga27">PRE_ONE_PSI</a>)
00082       <a class="code" href="group__nfft.html#ga10">nfft_precompute_one_psi</a>(&amp;my_plan);
00083 
00085   <span class="keywordflow">for</span>(k=0;k&lt;my_plan.<a class="code" href="structnfft__plan.html#o0">N_total</a>;k++)
00086     my_plan.<a class="code" href="structnfft__plan.html#o2">f_hat</a>[k] = ((double)rand())/RAND_MAX + I* ((double)rand())/RAND_MAX;
00087 
00088   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_plan.<a class="code" href="structnfft__plan.html#o2">f_hat</a>,12,
00089   <span class="stringliteral">"given Fourier coefficients, vector f_hat (first 12 entries)"</span>);
00090 
00092   <a class="code" href="group__nfft.html#ga0">ndft_trafo</a>(&amp;my_plan);
00093   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_plan.<a class="code" href="structnfft__plan.html#o3">f</a>,my_plan.<a class="code" href="structnfft__plan.html#o1">M_total</a>,<span class="stringliteral">"ndft, vector f"</span>); 
00094 
00096   <a class="code" href="group__nfft.html#ga2">nfft_trafo</a>(&amp;my_plan);
00097   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_plan.<a class="code" href="structnfft__plan.html#o3">f</a>,my_plan.<a class="code" href="structnfft__plan.html#o1">M_total</a>,<span class="stringliteral">"nfft, vector f"</span>);
00098 
00100   <a class="code" href="group__nfft.html#ga1">ndft_adjoint</a>(&amp;my_plan);
00101   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_plan.<a class="code" href="structnfft__plan.html#o2">f_hat</a>,12,<span class="stringliteral">"adjoint ndft, vector f_hat (first 12 entries)"</span>);
00102 
00104   <a class="code" href="group__nfft.html#ga3">nfft_adjoint</a>(&amp;my_plan);
00105   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_plan.<a class="code" href="structnfft__plan.html#o2">f_hat</a>,12,<span class="stringliteral">"adjoint nfft, vector f_hat (first 12 entries)"</span>); 
00106 
00108   <a class="code" href="group__nfft.html#ga15">nfft_finalize</a>(&amp;my_plan);
00109 }
00110 
00111 <span class="keywordtype">void</span> simple_test_nfft_2d_huge()
00112 {
00113   <span class="keywordtype">int</span> j,k;                              
00114   <a class="code" href="structnfft__plan.html">nfft_plan</a> my_plan;                    
00116   <span class="keywordtype">int</span> N[2],n[2];
00117   N[0]=2050; n[0]=4096;
00118   N[1]=2050; n[1]=4096;
00119 
00122   <a class="code" href="group__nfft.html#ga9">nfft_init_guru</a>(&amp;my_plan, 2, N, 10, n, 
00123      6, PRE_PHI_HUT| PRE_PSI| MALLOC_F_HAT| MALLOC_X| MALLOC_F |
00124      FFTW_INIT| FFT_OUT_OF_PLACE,
00125      FFTW_ESTIMATE| FFTW_DESTROY_INPUT);
00126 
00128   <span class="keywordflow">for</span>(j=0;j&lt;my_plan.<a class="code" href="structnfft__plan.html#o1">M_total</a>;j++)
00129     {
00130       my_plan.<a class="code" href="structnfft__plan.html#o14">x</a>[2*j]=((double)rand())/RAND_MAX-0.5;
00131       my_plan.<a class="code" href="structnfft__plan.html#o14">x</a>[2*j+1]=((double)rand())/RAND_MAX-0.5;
00132     }
00133 
00135   <span class="keywordflow">if</span>(my_plan.<a class="code" href="structnfft__plan.html#o12">nfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga27">PRE_ONE_PSI</a>)
00136       <a class="code" href="group__nfft.html#ga10">nfft_precompute_one_psi</a>(&amp;my_plan);
00137 
00139   <span class="keywordflow">for</span>(k=0;k&lt;my_plan.<a class="code" href="structnfft__plan.html#o0">N_total</a>;k++)
00140     my_plan.<a class="code" href="structnfft__plan.html#o2">f_hat</a>[k] = ((double)rand())/RAND_MAX + I* ((double)rand())/RAND_MAX;
00141 
00142   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_plan.<a class="code" href="structnfft__plan.html#o2">f_hat</a>,12,
00143   <span class="stringliteral">"given Fourier coefficients, vector f_hat (first 12 entries)"</span>);
00144 
00146   <a class="code" href="group__nfft.html#ga0">ndft_trafo</a>(&amp;my_plan);
00147   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_plan.<a class="code" href="structnfft__plan.html#o3">f</a>,my_plan.<a class="code" href="structnfft__plan.html#o1">M_total</a>,<span class="stringliteral">"ndft, vector f"</span>); 
00148 
00150   <a class="code" href="group__nfft.html#ga2">nfft_trafo</a>(&amp;my_plan);
00151   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_plan.<a class="code" href="structnfft__plan.html#o3">f</a>,my_plan.<a class="code" href="structnfft__plan.html#o1">M_total</a>,<span class="stringliteral">"nfft, vector f"</span>);
00152 
00154   <a class="code" href="group__nfft.html#ga1">ndft_adjoint</a>(&amp;my_plan);
00155   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_plan.<a class="code" href="structnfft__plan.html#o2">f_hat</a>,12,<span class="stringliteral">"adjoint ndft, vector f_hat (first 12 entries)"</span>);
00156 
00158   <a class="code" href="group__nfft.html#ga3">nfft_adjoint</a>(&amp;my_plan);
00159   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_plan.<a class="code" href="structnfft__plan.html#o2">f_hat</a>,12,<span class="stringliteral">"adjoint nfft, vector f_hat (first 12 entries)"</span>); 
00160 
00162   <a class="code" href="group__nfft.html#ga15">nfft_finalize</a>(&amp;my_plan);
00163 }
00164 
00165 
00166 
00167 <span class="keywordtype">void</span> measure_time_nfft_1d()
00168 {
00169   <span class="keywordtype">int</span> j,k;                              
00170   <a class="code" href="structnfft__plan.html">nfft_plan</a> my_plan;                    
00171   <span class="keywordtype">int</span> my_N;
00172   <span class="keywordtype">double</span> t;
00173 
00174   <span class="keywordflow">for</span>(my_N=16; my_N&lt;=1024*1024; my_N*=2)
00175     {
00176       <a class="code" href="group__nfft.html#ga4">nfft_init_1d</a>(&amp;my_plan,my_N,my_N);
00177 
00178       <span class="keywordflow">for</span>(j=0;j&lt;my_plan.<a class="code" href="structnfft__plan.html#o1">M_total</a>;j++)
00179   my_plan.<a class="code" href="structnfft__plan.html#o14">x</a>[j]=((double)rand())/RAND_MAX-0.5;
00180 
00181       <span class="keywordflow">if</span>(my_plan.<a class="code" href="structnfft__plan.html#o12">nfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga27">PRE_ONE_PSI</a>)
00182         <a class="code" href="group__nfft.html#ga10">nfft_precompute_one_psi</a>(&amp;my_plan);
00183   
00184       <span class="keywordflow">for</span>(k=0;k&lt;my_plan.<a class="code" href="structnfft__plan.html#o0">N_total</a>;k++)
00185   my_plan.<a class="code" href="structnfft__plan.html#o2">f_hat</a>[k]=((double)rand())/RAND_MAX + I*((double)rand())/RAND_MAX;
00186 
00187       <span class="keywordflow">if</span>(my_N&lt;=8192)
00188   {
00189     t=<a class="code" href="group__nfftutil.html#ga0">nfft_second</a>();
00190     <a class="code" href="group__nfft.html#ga0">ndft_trafo</a>(&amp;my_plan);
00191     t=<a class="code" href="group__nfftutil.html#ga0">nfft_second</a>()-t;
00192     printf(<span class="stringliteral">"t_ndft=%e,\t"</span>,t);
00193   }
00194       <span class="keywordflow">else</span>
00195   printf(<span class="stringliteral">"t_ndft=nan\t"</span>);
00196 
00197       t=<a class="code" href="group__nfftutil.html#ga0">nfft_second</a>();
00198       <a class="code" href="group__nfft.html#ga2">nfft_trafo</a>(&amp;my_plan);
00199       t=<a class="code" href="group__nfftutil.html#ga0">nfft_second</a>()-t;
00200       printf(<span class="stringliteral">"t_nfft=%e\t"</span>,t);
00201       
00202       printf(<span class="stringliteral">"(N=M_total=%d)\n"</span>,my_N);
00203 
00204       <a class="code" href="group__nfft.html#ga15">nfft_finalize</a>(&amp;my_plan);  
00205     }
00206 } 
00207 
00208 <span class="keywordtype">void</span> <a class="code" href="group__examples__solver__simple.html#ga0">simple_test_infft_1d</a>()
00209 {
00210   <span class="keywordtype">int</span> j,k,l;                            
00211   <a class="code" href="structnfft__plan.html">nfft_plan</a> my_plan;                    
00212   <a class="code" href="structinfft__plan.html">infft_plan</a> my_iplan;                  
00215   <a class="code" href="group__nfft.html#ga4">nfft_init_1d</a>(&amp;my_plan, 8, 4);
00216 
00218   <a class="code" href="group__solver.html#ga0">infft_init</a>(&amp;my_iplan,&amp;my_plan);
00219 
00221   <a class="code" href="group__nfftutil.html#ga47">nfft_vrand_shifted_unit_double</a>(my_plan.<a class="code" href="structnfft__plan.html#o14">x</a>,my_plan.<a class="code" href="structnfft__plan.html#o1">M_total</a>);
00222   
00224   <span class="keywordflow">if</span>(my_plan.<a class="code" href="structnfft__plan.html#o12">nfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga27">PRE_ONE_PSI</a>)
00225     <a class="code" href="group__nfft.html#ga10">nfft_precompute_one_psi</a>(&amp;my_plan);
00226 
00228   <a class="code" href="group__nfftutil.html#ga46">nfft_vrand_unit_complex</a>(my_iplan.<a class="code" href="structinfft__plan.html#o4">y</a>,my_plan.<a class="code" href="structnfft__plan.html#o1">M_total</a>);
00229 
00230   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_iplan.<a class="code" href="structinfft__plan.html#o4">y</a>,my_plan.<a class="code" href="structnfft__plan.html#o1">M_total</a>,<span class="stringliteral">"given data, vector y"</span>);
00231 
00233   <span class="keywordflow">for</span>(k=0;k&lt;my_plan.<a class="code" href="structnfft__plan.html#o0">N_total</a>;k++)
00234       my_iplan.<a class="code" href="structinfft__plan.html#o5">f_hat_iter</a>[k]=0; 
00235 
00236   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_iplan.<a class="code" href="structinfft__plan.html#o5">f_hat_iter</a>,my_plan.<a class="code" href="structnfft__plan.html#o0">N_total</a>,
00237   <span class="stringliteral">"approximate solution, vector f_hat_iter"</span>);
00238 
00240   <a class="code" href="group__solver.html#ga2">infft_before_loop</a>(&amp;my_iplan);
00241   <span class="keywordflow">for</span>(l=0;l&lt;3;l++)
00242     {
00243       printf(<span class="stringliteral">"iteration l=%d\n"</span>,l);
00244       <a class="code" href="group__solver.html#ga3">infft_loop_one_step</a>(&amp;my_iplan);
00245       <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_iplan.<a class="code" href="structinfft__plan.html#o5">f_hat_iter</a>,my_plan.<a class="code" href="structnfft__plan.html#o0">N_total</a>,
00246       <span class="stringliteral">"approximate solution, vector f_hat_iter"</span>);
00247       
00248       <a class="code" href="group__nfftutil.html#ga55">NFFT_SWAP_complex</a>(my_iplan.<a class="code" href="structinfft__plan.html#o5">f_hat_iter</a>,my_plan.<a class="code" href="structnfft__plan.html#o2">f_hat</a>);
00249       <a class="code" href="group__nfft.html#ga2">nfft_trafo</a>(&amp;my_plan);
00250       <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_plan.<a class="code" href="structnfft__plan.html#o3">f</a>,my_plan.<a class="code" href="structnfft__plan.html#o1">M_total</a>,<span class="stringliteral">"fitting the data, vector f"</span>);
00251       <a class="code" href="group__nfftutil.html#ga55">NFFT_SWAP_complex</a>(my_iplan.<a class="code" href="structinfft__plan.html#o5">f_hat_iter</a>,my_plan.<a class="code" href="structnfft__plan.html#o2">f_hat</a>);
00252     }
00253   
00254   <a class="code" href="group__solver.html#ga4">infft_finalize</a>(&amp;my_iplan);  
00255   <a class="code" href="group__nfft.html#ga15">nfft_finalize</a>(&amp;my_plan);  
00256 }
00257 
00258 <span class="keywordtype">int</span> <a class="code" href="flags_8c.html#a6">main</a>()
00259 {
00260   <span class="keywordtype">int</span> l,m;
00261 
00262 printf(<span class="stringliteral">"%d, %d\n"</span>,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
00263 exit(-1);
00264 
00265   system(<span class="stringliteral">"clear"</span>);
00266   printf(<span class="stringliteral">"1) computing an one dimensional ndft, nfft and an adjoint nfft\n\n"</span>);
00267   simple_test_nfft_1d();
00268 
00269   getc(stdin);
00270 
00271   system(<span class="stringliteral">"clear"</span>); 
00272   printf(<span class="stringliteral">"2) computing a two dimensional ndft, nfft and an adjoint nfft\n\n"</span>);
00273   simple_test_nfft_2d();
00274 <span class="comment">/*</span>
00275 <span class="comment">  getc(stdin);</span>
00276 <span class="comment"></span>
00277 <span class="comment">  system("clear"); </span>
00278 <span class="comment">  printf("3) computing an one dimensional infft\n\n");</span>
00279 <span class="comment">  simple_test_infft_1d();</span>
00280 <span class="comment"></span>
00281 <span class="comment">  getc(stdin);</span>
00282 <span class="comment">    </span>
00283 <span class="comment">  system("clear"); </span>
00284 <span class="comment">  printf("3) computing times for one dimensional nfft\n\n");</span>
00285 <span class="comment">  measure_time_nfft_1d();</span>
00286 <span class="comment">*/</span>
00287   <span class="keywordflow">return</span> 1;
00288 }
</pre></div>    <hr size="1"/>
    Generated on 5 Feb 2007 by Doxygen 1.4.1
  </body>
</html>
