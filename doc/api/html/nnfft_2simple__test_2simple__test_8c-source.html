<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
    <title>
      NFFT 3.0.3 API Reference - NFFT: simple_test.c Source File
    </title>
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <table>
      <tr>
        <td valign="top">
          <img src="images/logo.png" alt="NFFT Logo">
        </td>
        <td align="left" valign="bottom" width="100%">
          <H1nc>3.0.3 API Reference</H1nc>
        </td>
      </tr>
    </table>  
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">examples</a>&nbsp;/&nbsp;<a class="el" href="dir_000001.html">nnfft</a>&nbsp;/&nbsp;<a class="el" href="dir_000033.html">simple_test</a></div>
<h1>nnfft/simple_test/simple_test.c</h1><div class="fragment"><pre class="fragment">00001 <span class="preprocessor">#include "<a class="code" href="util_8h.html">util.h</a>"</span>
00002 <span class="preprocessor">#include "<a class="code" href="nfft3_8h.html">nfft3.h</a>"</span>
00003 <span class="preprocessor">#include "stdlib.h"</span>
00004 
00005 <span class="keywordtype">void</span> simple_test_nnfft_1d()
00006 {
00007   <span class="keywordtype">int</span> j,k;                              
00008   <a class="code" href="structnnfft__plan.html">nnfft_plan</a> my_plan;                    
00010   <span class="keywordtype">int</span> N[1];
00011   N[0]=12;
00012 
00014   <a class="code" href="group__nnfft.html#ga0">nnfft_init</a>(&amp;my_plan, 1, 12, 19, N);
00015   
00017   <span class="keywordflow">for</span>(j=0;j&lt;my_plan.<a class="code" href="structnnfft__plan.html#o1">M_total</a>;j++)
00018   {
00019     my_plan.<a class="code" href="structnnfft__plan.html#o17">x</a>[j]=((double)rand())/RAND_MAX-0.5;
00020   }  
00022   <span class="keywordflow">for</span>(j=0;j&lt;my_plan.<a class="code" href="structnnfft__plan.html#o0">N_total</a>;j++)
00023   {
00024     my_plan.<a class="code" href="structnnfft__plan.html#o18">v</a>[j]=((double)rand())/RAND_MAX-0.5;
00025   }
00026 
00028   <span class="keywordflow">if</span>(my_plan.<a class="code" href="structnnfft__plan.html#o15">nnfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga20">PRE_PSI</a>)
00029     <a class="code" href="group__nnfft.html#ga7">nnfft_precompute_psi</a>(&amp;my_plan);
00030       
00031   <span class="keywordflow">if</span>(my_plan.<a class="code" href="structnnfft__plan.html#o15">nnfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga21">PRE_FULL_PSI</a>)
00032     <a class="code" href="group__nnfft.html#ga8">nnfft_precompute_full_psi</a>(&amp;my_plan);
00033     
00034   <span class="keywordflow">if</span>(my_plan.<a class="code" href="structnnfft__plan.html#o15">nnfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga18">PRE_LIN_PSI</a>)
00035     <a class="code" href="group__nnfft.html#ga6">nnfft_precompute_lin_psi</a>(&amp;my_plan);
00036   
00038   <span class="keywordflow">if</span>(my_plan.<a class="code" href="structnnfft__plan.html#o15">nnfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga16">PRE_PHI_HUT</a>)
00039     <a class="code" href="group__nnfft.html#ga9">nnfft_precompute_phi_hut</a>(&amp;my_plan);
00040     
00042   <span class="keywordflow">for</span>(k=0;k&lt;my_plan.<a class="code" href="structnnfft__plan.html#o0">N_total</a>;k++)
00043     my_plan.<a class="code" href="structnnfft__plan.html#o2">f_hat</a>[k] = ((double)rand())/RAND_MAX +I*((double)rand())/RAND_MAX;
00044 
00045   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_plan.<a class="code" href="structnnfft__plan.html#o2">f_hat</a>,my_plan.<a class="code" href="structnnfft__plan.html#o0">N_total</a>,<span class="stringliteral">"given Fourier coefficients, vector f_hat"</span>); 
00046 
00048   <a class="code" href="group__nnfft.html#ga2">nndft_trafo</a>(&amp;my_plan);
00049   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_plan.<a class="code" href="structnnfft__plan.html#o3">f</a>,my_plan.<a class="code" href="structnnfft__plan.html#o1">M_total</a>,<span class="stringliteral">"nndft, vector f"</span>); 
00050 
00052   <a class="code" href="group__nnfft.html#ga4">nnfft_trafo</a>(&amp;my_plan);
00053   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_plan.<a class="code" href="structnnfft__plan.html#o3">f</a>,my_plan.<a class="code" href="structnnfft__plan.html#o1">M_total</a>,<span class="stringliteral">"nnfft, vector f"</span>);
00054 
00056   <a class="code" href="group__nnfft.html#ga10">nnfft_finalize</a>(&amp;my_plan);
00057 }
00058 
00059 <span class="keywordtype">void</span> simple_test_nnfft_2d()
00060 {
00061   <span class="keywordtype">int</span> j,k;                              
00062   <a class="code" href="structnnfft__plan.html">nnfft_plan</a> my_plan;                    
00064   <span class="keywordtype">int</span> N[2];
00065   N[0]=12;
00066   N[1]=14;
00067 
00069   <a class="code" href="group__nnfft.html#ga0">nnfft_init</a>(&amp;my_plan, 2,12*14,19, N);
00070 
00072   <span class="keywordflow">for</span>(j=0;j&lt;my_plan.<a class="code" href="structnnfft__plan.html#o1">M_total</a>;j++)
00073   {
00074     my_plan.<a class="code" href="structnnfft__plan.html#o17">x</a>[2*j]=((double)rand())/RAND_MAX-0.5;
00075     my_plan.<a class="code" href="structnnfft__plan.html#o17">x</a>[2*j+1]=((double)rand())/RAND_MAX-0.5;
00076   }
00077     
00079   <span class="keywordflow">for</span>(j=0;j&lt;my_plan.<a class="code" href="structnnfft__plan.html#o0">N_total</a>;j++)
00080   {
00081     my_plan.<a class="code" href="structnnfft__plan.html#o18">v</a>[2*j]=((double)rand())/RAND_MAX-0.5;
00082     my_plan.<a class="code" href="structnnfft__plan.html#o18">v</a>[2*j+1]=((double)rand())/RAND_MAX-0.5;
00083   }
00084 
00086   <span class="keywordflow">if</span>(my_plan.<a class="code" href="structnnfft__plan.html#o15">nnfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga20">PRE_PSI</a>)
00087     <a class="code" href="group__nnfft.html#ga7">nnfft_precompute_psi</a>(&amp;my_plan);
00088       
00089   <span class="keywordflow">if</span>(my_plan.<a class="code" href="structnnfft__plan.html#o15">nnfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga21">PRE_FULL_PSI</a>)
00090     <a class="code" href="group__nnfft.html#ga8">nnfft_precompute_full_psi</a>(&amp;my_plan);
00091   
00092   <span class="keywordflow">if</span>(my_plan.<a class="code" href="structnnfft__plan.html#o15">nnfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga18">PRE_LIN_PSI</a>)
00093     <a class="code" href="group__nnfft.html#ga6">nnfft_precompute_lin_psi</a>(&amp;my_plan);
00094         
00096   <span class="keywordflow">if</span>(my_plan.<a class="code" href="structnnfft__plan.html#o15">nnfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga16">PRE_PHI_HUT</a>)
00097     <a class="code" href="group__nnfft.html#ga9">nnfft_precompute_phi_hut</a>(&amp;my_plan);
00098     
00100   <span class="keywordflow">for</span>(k=0;k&lt;my_plan.<a class="code" href="structnnfft__plan.html#o0">N_total</a>;k++)
00101     my_plan.<a class="code" href="structnnfft__plan.html#o2">f_hat</a>[k] = ((double)rand())/RAND_MAX + I*((double)rand())/RAND_MAX;
00102 
00103   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_plan.<a class="code" href="structnnfft__plan.html#o2">f_hat</a>,12,
00104         <span class="stringliteral">"given Fourier coefficients, vector f_hat (first 12 entries)"</span>);
00105 
00107   <a class="code" href="group__nnfft.html#ga2">nndft_trafo</a>(&amp;my_plan);
00108   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_plan.<a class="code" href="structnnfft__plan.html#o3">f</a>,my_plan.<a class="code" href="structnnfft__plan.html#o1">M_total</a>,<span class="stringliteral">"ndft, vector f"</span>); 
00109 
00111   <a class="code" href="group__nnfft.html#ga4">nnfft_trafo</a>(&amp;my_plan);
00112   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_plan.<a class="code" href="structnnfft__plan.html#o3">f</a>,my_plan.<a class="code" href="structnnfft__plan.html#o1">M_total</a>,<span class="stringliteral">"nfft, vector f"</span>);
00113 
00115   <a class="code" href="group__nnfft.html#ga10">nnfft_finalize</a>(&amp;my_plan);
00116 }
00117 
00118 <span class="keywordtype">void</span> simple_test_innfft_1d()
00119 {
00120   <span class="keywordtype">int</span> j,k,l,N=8;                        
00121   <a class="code" href="structnnfft__plan.html">nnfft_plan</a> my_plan;                    
00122   <a class="code" href="structinnfft__plan.html">innfft_plan</a> my_iplan;                  
00125   <a class="code" href="group__nnfft.html#ga0">nnfft_init</a>(&amp;my_plan,1 ,8 ,8 ,&amp;N);
00126 
00128   <a class="code" href="group__solver.html#ga16">innfft_init_advanced</a>(&amp;my_iplan,&amp;my_plan,CGNR);
00129 
00131   <span class="keywordflow">for</span>(j=0;j&lt;my_plan.<a class="code" href="structnnfft__plan.html#o1">M_total</a>;j++)
00132     my_plan.<a class="code" href="structnnfft__plan.html#o17">x</a>[j]=((double)rand())/RAND_MAX-0.5;
00133   
00135   <span class="keywordflow">for</span>(j=0;j&lt;my_plan.<a class="code" href="structnnfft__plan.html#o0">N_total</a>;j++)
00136     my_plan.<a class="code" href="structnnfft__plan.html#o18">v</a>[j]=((double)rand())/RAND_MAX-0.5;
00137     
00139   <span class="keywordflow">if</span>(my_plan.<a class="code" href="structnnfft__plan.html#o15">nnfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga20">PRE_PSI</a>)
00140     <a class="code" href="group__nnfft.html#ga7">nnfft_precompute_psi</a>(&amp;my_plan);
00141   
00142   <span class="keywordflow">if</span>(my_plan.<a class="code" href="structnnfft__plan.html#o15">nnfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga21">PRE_FULL_PSI</a>)
00143       <a class="code" href="group__nnfft.html#ga8">nnfft_precompute_full_psi</a>(&amp;my_plan);
00144   
00146   <span class="keywordflow">if</span>(my_plan.<a class="code" href="structnnfft__plan.html#o15">nnfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga16">PRE_PHI_HUT</a>)
00147     <a class="code" href="group__nnfft.html#ga9">nnfft_precompute_phi_hut</a>(&amp;my_plan);
00148     
00150   <span class="keywordflow">for</span>(j=0;j&lt;my_plan.<a class="code" href="structnnfft__plan.html#o1">M_total</a>;j++)
00151     my_iplan.<a class="code" href="structinnfft__plan.html#o4">y</a>[j] = ((double)rand())/RAND_MAX;
00152 
00153   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_iplan.<a class="code" href="structinnfft__plan.html#o4">y</a>,my_plan.<a class="code" href="structnnfft__plan.html#o1">M_total</a>,<span class="stringliteral">"given data, vector given_f"</span>);
00154 
00156   <span class="keywordflow">for</span>(k=0;k&lt;my_plan.<a class="code" href="structnnfft__plan.html#o0">N_total</a>;k++)
00157     my_iplan.<a class="code" href="structinnfft__plan.html#o5">f_hat_iter</a>[k] = 0.0;
00158 
00159   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_iplan.<a class="code" href="structinnfft__plan.html#o5">f_hat_iter</a>,my_plan.<a class="code" href="structnnfft__plan.html#o0">N_total</a>,
00160         <span class="stringliteral">"approximate solution, vector f_hat_iter"</span>);
00161 
00163   <a class="code" href="group__solver.html#ga17">innfft_before_loop</a>(&amp;my_iplan);
00164   <span class="keywordflow">for</span>(l=0;l&lt;8;l++)
00165   {
00166     printf(<span class="stringliteral">"iteration l=%d\n"</span>,l);
00167     <a class="code" href="group__solver.html#ga18">innfft_loop_one_step</a>(&amp;my_iplan);
00168     <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_iplan.<a class="code" href="structinnfft__plan.html#o5">f_hat_iter</a>,my_plan.<a class="code" href="structnnfft__plan.html#o0">N_total</a>,
00169           <span class="stringliteral">"approximate solution, vector f_hat_iter"</span>);
00170       
00171     <a class="code" href="group__nfftutil.html#ga55">NFFT_SWAP_complex</a>(my_iplan.<a class="code" href="structinnfft__plan.html#o5">f_hat_iter</a>,my_plan.<a class="code" href="structnnfft__plan.html#o2">f_hat</a>);
00172     <a class="code" href="group__nnfft.html#ga4">nnfft_trafo</a>(&amp;my_plan);
00173     <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(my_plan.<a class="code" href="structnnfft__plan.html#o3">f</a>,my_plan.<a class="code" href="structnnfft__plan.html#o1">M_total</a>,<span class="stringliteral">"fitting the data, vector f"</span>);
00174     <a class="code" href="group__nfftutil.html#ga55">NFFT_SWAP_complex</a>(my_iplan.<a class="code" href="structinnfft__plan.html#o5">f_hat_iter</a>,my_plan.<a class="code" href="structnnfft__plan.html#o2">f_hat</a>);
00175   }
00176   
00177   <a class="code" href="group__solver.html#ga19">innfft_finalize</a>(&amp;my_iplan);  
00178   <a class="code" href="group__nnfft.html#ga10">nnfft_finalize</a>(&amp;my_plan);  
00179 }
00180 
00181 <span class="keywordtype">void</span> measure_time_nnfft_1d()
00182 {
00183   <span class="keywordtype">int</span> j,k;                              
00184   <a class="code" href="structnnfft__plan.html">nnfft_plan</a> my_plan;                    
00185   <span class="keywordtype">int</span> my_N,N=4;
00186   <span class="keywordtype">double</span> t;
00187 
00188   <span class="keywordflow">for</span>(my_N=16; my_N&lt;=16384; my_N*=2)
00189   {
00190     <a class="code" href="group__nnfft.html#ga0">nnfft_init</a>(&amp;my_plan,1,my_N,my_N,&amp;N);
00191 
00192     <span class="keywordflow">for</span>(j=0;j&lt;my_plan.<a class="code" href="structnnfft__plan.html#o1">M_total</a>;j++)
00193       my_plan.<a class="code" href="structnnfft__plan.html#o17">x</a>[j]=((double)rand())/RAND_MAX-0.5;
00194 
00195     <span class="keywordflow">for</span>(j=0;j&lt;my_plan.<a class="code" href="structnnfft__plan.html#o0">N_total</a>;j++)
00196       my_plan.<a class="code" href="structnnfft__plan.html#o18">v</a>[j]=((double)rand())/RAND_MAX-0.5;        
00197         
00198     <span class="keywordflow">if</span>(my_plan.<a class="code" href="structnnfft__plan.html#o15">nnfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga20">PRE_PSI</a>)
00199       <a class="code" href="group__nnfft.html#ga7">nnfft_precompute_psi</a>(&amp;my_plan);
00200       
00201     <span class="keywordflow">if</span>(my_plan.<a class="code" href="structnnfft__plan.html#o15">nnfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga21">PRE_FULL_PSI</a>)
00202         <a class="code" href="group__nnfft.html#ga8">nnfft_precompute_full_psi</a>(&amp;my_plan);
00203 
00204     <span class="keywordflow">if</span>(my_plan.<a class="code" href="structnnfft__plan.html#o15">nnfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga16">PRE_PHI_HUT</a>)
00205       <a class="code" href="group__nnfft.html#ga9">nnfft_precompute_phi_hut</a>(&amp;my_plan);
00206       
00207     <span class="keywordflow">for</span>(k=0;k&lt;my_plan.<a class="code" href="structnnfft__plan.html#o0">N_total</a>;k++)
00208       my_plan.<a class="code" href="structnnfft__plan.html#o2">f_hat</a>[k] = ((double)rand())/RAND_MAX + I*((double)rand())/RAND_MAX;
00209 
00210     t=<a class="code" href="group__nfftutil.html#ga0">nfft_second</a>();
00211     <a class="code" href="group__nnfft.html#ga2">nndft_trafo</a>(&amp;my_plan);
00212     t=<a class="code" href="group__nfftutil.html#ga0">nfft_second</a>()-t;
00213     printf(<span class="stringliteral">"t_nndft=%e,\t"</span>,t);
00214 
00215     t=<a class="code" href="group__nfftutil.html#ga0">nfft_second</a>();
00216     <a class="code" href="group__nnfft.html#ga4">nnfft_trafo</a>(&amp;my_plan);
00217     t=<a class="code" href="group__nfftutil.html#ga0">nfft_second</a>()-t;
00218     printf(<span class="stringliteral">"t_nnfft=%e\t"</span>,t);
00219       
00220     printf(<span class="stringliteral">"(N=M=%d)\n"</span>,my_N);
00221 
00222     <a class="code" href="group__nnfft.html#ga10">nnfft_finalize</a>(&amp;my_plan);  
00223   }
00224 } 
00225 
00226 <span class="keywordtype">int</span> <a class="code" href="flags_8c.html#a6">main</a>()
00227 { 
00228   system(<span class="stringliteral">"clear"</span>);
00229   printf(<span class="stringliteral">"1) computing an one dimensional nndft, nnfft\n\n"</span>);
00230   simple_test_nnfft_1d();
00231 
00232   getc(stdin);
00233 
00234   system(<span class="stringliteral">"clear"</span>); 
00235   printf(<span class="stringliteral">"2) computing a two dimensional nndft, nfft\n\n"</span>);
00236   simple_test_nnfft_2d();
00237   
00238   getc(stdin);
00239   
00240   system(<span class="stringliteral">"clear"</span>); 
00241   printf(<span class="stringliteral">"3) computing an one dimensional infft\n\n"</span>);
00242   simple_test_innfft_1d();
00243   
00244   getc(stdin);
00245   
00246   system(<span class="stringliteral">"clear"</span>); 
00247   printf(<span class="stringliteral">"4) computing times for one dimensional nnfft\n\n"</span>);
00248   measure_time_nnfft_1d();
00249 
00250   <span class="keywordflow">return</span> 1;
00251 }
</pre></div>    <hr size="1"/>
    Generated on 5 Feb 2007 by Doxygen 1.4.1
  </body>
</html>
