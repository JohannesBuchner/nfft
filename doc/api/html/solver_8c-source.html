<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
    <title>
      NFFT 3.0.2 API Reference - NFFT: solver.c Source File
    </title>
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <table>
      <tr>
        <td valign="top">
          <img src="images/logo.png" alt="NFFT Logo">
        </td>
        <td align="left" valign="bottom" width="100%">
          <H1nc>3.0.2 API Reference</H1nc>
        </td>
      </tr>
    </table>  
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="dir_000003.html">kernel</a>&nbsp;/&nbsp;<a class="el" href="dir_000034.html">solver</a></div>
<h1>solver.c</h1><div class="fragment"><pre class="fragment">00001 
00007 <span class="preprocessor">#include "<a class="code" href="util_8h.html">util.h</a>"</span>
00008 <span class="preprocessor">#include "<a class="code" href="nfft3_8h.html">nfft3.h</a>"</span>
00009 
00021 <span class="preprocessor">#define F(MV, FLT, FLT_TYPE, NAME, ...) void i ## MV ## _ ## NAME(__VA_ARGS__)</span>
00022 <span class="preprocessor"></span>
00023 
00024 <span class="preprocessor">#define MACRO_SOLVER_IMPL(MV, FLT, FLT_TYPE)                                  \</span>
00025 <span class="preprocessor">                                                                              \</span>
00026 <span class="preprocessor">F(MV, FLT, FLT_TYPE, init_advanced, i ## MV ## _plan *ths, MV ## _plan *mv,   \</span>
00027 <span class="preprocessor">                                    unsigned i ## MV ## _flags)               \</span>
00028 <span class="preprocessor">{                                                                             \</span>
00029 <span class="preprocessor">  ths-&gt;mv = mv;                                                               \</span>
00030 <span class="preprocessor">  ths-&gt;flags = i ## MV ## _flags;                                             \</span>
00031 <span class="preprocessor">                                                                              \</span>
00032 <span class="preprocessor">  ths-&gt;y          = (FLT_TYPE*)fftw_malloc(ths-&gt;mv-&gt;M_total*sizeof(FLT_TYPE));\</span>
00033 <span class="preprocessor">  ths-&gt;r_iter     = (FLT_TYPE*)fftw_malloc(ths-&gt;mv-&gt;M_total*sizeof(FLT_TYPE));\</span>
00034 <span class="preprocessor">  ths-&gt;f_hat_iter = (FLT_TYPE*)fftw_malloc(ths-&gt;mv-&gt;N_total*sizeof(FLT_TYPE));\</span>
00035 <span class="preprocessor">  ths-&gt;p_hat_iter = (FLT_TYPE*)fftw_malloc(ths-&gt;mv-&gt;N_total*sizeof(FLT_TYPE));\</span>
00036 <span class="preprocessor">                                                                              \</span>
00037 <span class="preprocessor">  if(ths-&gt;flags &amp; LANDWEBER)                                                  \</span>
00038 <span class="preprocessor">    ths-&gt;z_hat_iter = ths-&gt;p_hat_iter;                                        \</span>
00039 <span class="preprocessor">                                                                              \</span>
00040 <span class="preprocessor">  if(ths-&gt;flags &amp; STEEPEST_DESCENT)                                           \</span>
00041 <span class="preprocessor">    {                                                                         \</span>
00042 <span class="preprocessor">      ths-&gt;z_hat_iter = ths-&gt;p_hat_iter;                                      \</span>
00043 <span class="preprocessor">      ths-&gt;v_iter     = (FLT_TYPE*)fftw_malloc(ths-&gt;mv-&gt;M_total*              \</span>
00044 <span class="preprocessor">                                               sizeof(FLT_TYPE));             \</span>
00045 <span class="preprocessor">    }                                                                         \</span>
00046 <span class="preprocessor">                                                                              \</span>
00047 <span class="preprocessor">  if(ths-&gt;flags &amp; CGNR)                                                       \</span>
00048 <span class="preprocessor">    {                                                                         \</span>
00049 <span class="preprocessor">      ths-&gt;z_hat_iter = (FLT_TYPE*)fftw_malloc(ths-&gt;mv-&gt;N_total*              \</span>
00050 <span class="preprocessor">                                               sizeof(FLT_TYPE));             \</span>
00051 <span class="preprocessor">      ths-&gt;v_iter     = (FLT_TYPE*)fftw_malloc(ths-&gt;mv-&gt;M_total*              \</span>
00052 <span class="preprocessor">                                               sizeof(FLT_TYPE));             \</span>
00053 <span class="preprocessor">    }                                                                         \</span>
00054 <span class="preprocessor">                                                                              \</span>
00055 <span class="preprocessor">  if(ths-&gt;flags &amp; CGNE)                                                       \</span>
00056 <span class="preprocessor">    ths-&gt;z_hat_iter = ths-&gt;p_hat_iter;                                        \</span>
00057 <span class="preprocessor">                                                                              \</span>
00058 <span class="preprocessor">  if(ths-&gt;flags &amp; PRECOMPUTE_WEIGHT)                                          \</span>
00059 <span class="preprocessor">    ths-&gt;w = (double*) fftw_malloc(ths-&gt;mv-&gt;M_total*sizeof(double));          \</span>
00060 <span class="preprocessor">                                                                              \</span>
00061 <span class="preprocessor">  if(ths-&gt;flags &amp; PRECOMPUTE_DAMP)                                            \</span>
00062 <span class="preprocessor">    ths-&gt;w_hat = (double*) fftw_malloc(ths-&gt;mv-&gt;N_total*sizeof(double));      \</span>
00063 <span class="preprocessor">}                                                                             \</span>
00064 <span class="preprocessor">                                                                              \</span>
00065 <span class="preprocessor">                                                        \</span>
00066 <span class="preprocessor">F(MV, FLT, FLT_TYPE, init, i ## MV ## _plan *ths, MV ## _plan *mv)            \</span>
00067 <span class="preprocessor">{                                                                             \</span>
00068 <span class="preprocessor">  i ## MV ## _init_advanced(ths, mv, CGNR);                                   \</span>
00069 <span class="preprocessor">} </span><span class="comment">/* void i&lt;mv&gt;_init */</span>                                                       \
00070                                                                               \
00071                                                  \
00072 F(MV, FLT, FLT_TYPE, before_loop,   i ## MV ## _plan *ths)                    \
00073 {                                                                             \
00074   nfft_cp_ ## FLT(ths-&gt;mv-&gt;f_hat, ths-&gt;f_hat_iter, ths-&gt;mv-&gt;N_total);         \
00075                                                                               \
00076   NFFT_SWAP_ ## FLT(ths-&gt;r_iter, ths-&gt;mv-&gt;f);                                 \
00077   MV ## _trafo(ths-&gt;mv);                                                      \
00078   NFFT_SWAP_ ## FLT(ths-&gt;r_iter, ths-&gt;mv-&gt;f);                                 \
00079                                                                               \
00080   nfft_upd_axpy_ ## FLT(ths-&gt;r_iter, -1.0, ths-&gt;y, ths-&gt;mv-&gt;M_total);         \
00081                                                                               \
00082   if((!(ths-&gt;flags &amp; LANDWEBER)) || (ths-&gt;flags &amp; NORMS_FOR_LANDWEBER))       \
00083     {                                                                         \
00084       if(ths-&gt;flags &amp; PRECOMPUTE_WEIGHT)                                      \
00085   ths-&gt;dot_r_iter =                                                           \
00086       nfft_dot_w_ ## FLT(ths-&gt;r_iter, ths-&gt;w, ths-&gt;mv-&gt;M_total);              \
00087       else                                                                    \
00088   ths-&gt;dot_r_iter = nfft_dot_ ## FLT(ths-&gt;r_iter, ths-&gt;mv-&gt;M_total);          \
00089     }                                                                         \
00090                                                                               \
00091   <span class="comment">/*-----------------*/</span>                                                       \
00092   if(ths-&gt;flags &amp; PRECOMPUTE_WEIGHT)                                          \
00093     nfft_cp_w_ ## FLT(ths-&gt;mv-&gt;f, ths-&gt;w, ths-&gt;r_iter, ths-&gt;mv-&gt;M_total);     \
00094   else                                                                        \
00095     nfft_cp_ ## FLT(ths-&gt;mv-&gt;f, ths-&gt;r_iter, ths-&gt;mv-&gt;M_total);               \
00096                                                                               \
00097   NFFT_SWAP_ ## FLT(ths-&gt;z_hat_iter, ths-&gt;mv-&gt;f_hat);                         \
00098   MV ## _adjoint(ths-&gt;mv);                                                    \
00099   NFFT_SWAP_ ## FLT(ths-&gt;z_hat_iter, ths-&gt;mv-&gt;f_hat);                         \
00100                                                                               \
00101   if((!(ths-&gt;flags &amp; LANDWEBER)) || (ths-&gt;flags &amp; NORMS_FOR_LANDWEBER))       \
00102     {                                                                         \
00103       if(ths-&gt;flags &amp; PRECOMPUTE_DAMP)                                        \
00104   ths-&gt;dot_z_hat_iter =                                                       \
00105     nfft_dot_w_ ## FLT(ths-&gt;z_hat_iter, ths-&gt;w_hat, ths-&gt;mv-&gt;N_total);        \
00106       else                                                                    \
00107   ths-&gt;dot_z_hat_iter = nfft_dot_ ## FLT(ths-&gt;z_hat_iter, ths-&gt;mv-&gt;N_total);  \
00108     }                                                                         \
00109                                                                               \
00110   if(ths-&gt;flags &amp; CGNE)                                                       \
00111     ths-&gt;dot_p_hat_iter = ths-&gt;dot_z_hat_iter;                                \
00112                                                                               \
00113   if(ths-&gt;flags &amp; CGNR)                                                       \
00114     nfft_cp_ ## FLT(ths-&gt;p_hat_iter, ths-&gt;z_hat_iter, ths-&gt;mv-&gt;N_total);      \
00115 } <span class="comment">/* void i&lt;mv&gt;_before_loop */</span>                                                \
00116                                                                               \
00117                                      \
00118 F(MV, FLT, FLT_TYPE, loop_one_step_landweber, i ## MV ## _plan *ths)          \
00119 {                                                                             \
00120   if(ths-&gt;flags &amp; PRECOMPUTE_DAMP)                                            \
00121     nfft_upd_xpawy_ ## FLT(ths-&gt;f_hat_iter, ths-&gt;alpha_iter, ths-&gt;w_hat,      \
00122           ths-&gt;z_hat_iter, ths-&gt;mv-&gt;N_total);                                 \
00123   else                                                                        \
00124     nfft_upd_xpay_ ## FLT(ths-&gt;f_hat_iter, ths-&gt;alpha_iter, ths-&gt;z_hat_iter,  \
00125          ths-&gt;mv-&gt;N_total);                                                   \
00126                                                                               \
00127   <span class="comment">/*-----------------*/</span>                                                       \
00128   nfft_cp_ ## FLT(ths-&gt;mv-&gt;f_hat, ths-&gt;f_hat_iter, ths-&gt;mv-&gt;N_total);         \
00129                                                                               \
00130   NFFT_SWAP_ ## FLT(ths-&gt;r_iter,ths-&gt;mv-&gt;f);                                  \
00131   MV ## _trafo(ths-&gt;mv);                                                      \
00132   NFFT_SWAP_ ## FLT(ths-&gt;r_iter,ths-&gt;mv-&gt;f);                                  \
00133                                                                               \
00134   nfft_upd_axpy_ ## FLT(ths-&gt;r_iter, -1.0, ths-&gt;y, ths-&gt;mv-&gt;M_total);         \
00135                                                                               \
00136   if(ths-&gt;flags &amp; NORMS_FOR_LANDWEBER)                                        \
00137     {                                                                         \
00138       if(ths-&gt;flags &amp; PRECOMPUTE_WEIGHT)                                      \
00139   ths-&gt;dot_r_iter = nfft_dot_w_ ## FLT(ths-&gt;r_iter,ths-&gt;w, ths-&gt;mv-&gt;M_total); \
00140       else                                                                    \
00141   ths-&gt;dot_r_iter = nfft_dot_ ## FLT(ths-&gt;r_iter, ths-&gt;mv-&gt;M_total);          \
00142     }                                                                         \
00143                                                                               \
00144   <span class="comment">/*-----------------*/</span>                                                       \
00145   if(ths-&gt;flags &amp; PRECOMPUTE_WEIGHT)                                          \
00146     nfft_cp_w_ ## FLT(ths-&gt;mv-&gt;f, ths-&gt;w, ths-&gt;r_iter, ths-&gt;mv-&gt;M_total);     \
00147   else                                                                        \
00148     nfft_cp_ ## FLT(ths-&gt;mv-&gt;f, ths-&gt;r_iter, ths-&gt;mv-&gt;M_total);               \
00149                                                                               \
00150   NFFT_SWAP_ ## FLT(ths-&gt;z_hat_iter,ths-&gt;mv-&gt;f_hat);                          \
00151   MV ## _adjoint(ths-&gt;mv);                                                    \
00152   NFFT_SWAP_ ## FLT(ths-&gt;z_hat_iter,ths-&gt;mv-&gt;f_hat);                          \
00153                                                                               \
00154   if(ths-&gt;flags &amp; NORMS_FOR_LANDWEBER)                                        \
00155     {                                                                         \
00156       if(ths-&gt;flags &amp; PRECOMPUTE_DAMP)                                        \
00157   ths-&gt;dot_z_hat_iter =                                                       \
00158     nfft_dot_w_ ## FLT(ths-&gt;z_hat_iter, ths-&gt;w_hat, ths-&gt;mv-&gt;N_total);        \
00159       else                                                                    \
00160   ths-&gt;dot_z_hat_iter = nfft_dot_ ## FLT(ths-&gt;z_hat_iter, ths-&gt;mv-&gt;N_total);  \
00161     }                                                                         \
00162 } <span class="comment">/* void i&lt;mv&gt;_loop_one_step_landweber */</span>                                    \
00163                                                                               \
00164                               \
00165 F(MV, FLT, FLT_TYPE, loop_one_step_steepest_descent, i ## MV ## _plan *ths)   \
00166 {                                                                             \
00167   if(ths-&gt;flags &amp; PRECOMPUTE_DAMP)                                            \
00168     nfft_cp_w_ ## FLT(ths-&gt;mv-&gt;f_hat, ths-&gt;w_hat, ths-&gt;z_hat_iter,            \
00169      ths-&gt;mv-&gt;N_total);                                                       \
00170   else                                                                        \
00171     nfft_cp_ ## FLT(ths-&gt;mv-&gt;f_hat, ths-&gt;z_hat_iter, ths-&gt;mv-&gt;N_total);       \
00172                                                                               \
00173   NFFT_SWAP_ ## FLT(ths-&gt;v_iter,ths-&gt;mv-&gt;f);                                  \
00174   MV ## _trafo(ths-&gt;mv);                                                      \
00175   NFFT_SWAP_ ## FLT(ths-&gt;v_iter,ths-&gt;mv-&gt;f);                                  \
00176                                                                               \
00177   if(ths-&gt;flags &amp; PRECOMPUTE_WEIGHT)                                          \
00178     ths-&gt;dot_v_iter = nfft_dot_w_ ## FLT(ths-&gt;v_iter, ths-&gt;w,                 \
00179                                          ths-&gt;mv-&gt;M_total);                   \
00180   else                                                                        \
00181     ths-&gt;dot_v_iter = nfft_dot_ ## FLT(ths-&gt;v_iter, ths-&gt;mv-&gt;M_total);        \
00182                                                                               \
00183   <span class="comment">/*-----------------*/</span>                                                       \
00184   ths-&gt;alpha_iter = ths-&gt;dot_z_hat_iter / ths-&gt;dot_v_iter;                    \
00185                                                                               \
00186   <span class="comment">/*-----------------*/</span>                                                       \
00187   if(ths-&gt;flags &amp; PRECOMPUTE_DAMP)                                            \
00188     nfft_upd_xpawy_ ## FLT(ths-&gt;f_hat_iter, ths-&gt;alpha_iter, ths-&gt;w_hat,      \
00189           ths-&gt;z_hat_iter, ths-&gt;mv-&gt;N_total);                                 \
00190   else                                                                        \
00191     nfft_upd_xpay_ ## FLT(ths-&gt;f_hat_iter, ths-&gt;alpha_iter, ths-&gt;z_hat_iter,  \
00192          ths-&gt;mv-&gt;N_total);                                                   \
00193                                                                               \
00194   <span class="comment">/*-----------------*/</span>                                                       \
00195   nfft_upd_xpay_ ## FLT(ths-&gt;r_iter, -ths-&gt;alpha_iter, ths-&gt;v_iter,           \
00196        ths-&gt;mv-&gt;M_total);                                                     \
00197                                                                               \
00198   if(ths-&gt;flags &amp; PRECOMPUTE_WEIGHT)                                          \
00199     ths-&gt;dot_r_iter = nfft_dot_w_ ## FLT(ths-&gt;r_iter, ths-&gt;w,                 \
00200                                          ths-&gt;mv-&gt;M_total);                   \
00201   else                                                                        \
00202     ths-&gt;dot_r_iter = nfft_dot_ ## FLT(ths-&gt;r_iter, ths-&gt;mv-&gt;M_total);        \
00203                                                                               \
00204   <span class="comment">/*-----------------*/</span>                                                       \
00205   if(ths-&gt;flags &amp; PRECOMPUTE_WEIGHT)                                          \
00206     nfft_cp_w_ ## FLT(ths-&gt;mv-&gt;f, ths-&gt;w, ths-&gt;r_iter, ths-&gt;mv-&gt;M_total);     \
00207   else                                                                        \
00208     nfft_cp_ ## FLT(ths-&gt;mv-&gt;f, ths-&gt;r_iter, ths-&gt;mv-&gt;M_total);               \
00209                                                                               \
00210   NFFT_SWAP_ ## FLT(ths-&gt;z_hat_iter,ths-&gt;mv-&gt;f_hat);                          \
00211   MV ## _adjoint(ths-&gt;mv);                                                    \
00212   NFFT_SWAP_ ## FLT(ths-&gt;z_hat_iter,ths-&gt;mv-&gt;f_hat);                          \
00213                                                                               \
00214   if(ths-&gt;flags &amp; PRECOMPUTE_DAMP)                                            \
00215     ths-&gt;dot_z_hat_iter =                                                     \
00216       nfft_dot_w_ ## FLT(ths-&gt;z_hat_iter, ths-&gt;w_hat, ths-&gt;mv-&gt;N_total);      \
00217   else                                                                        \
00218     ths-&gt;dot_z_hat_iter = nfft_dot_ ## FLT(ths-&gt;z_hat_iter, ths-&gt;mv-&gt;N_total);\
00219 } <span class="comment">/* void i&lt;mv&gt;_loop_one_step_steepest_descent */</span>                             \
00220                                                                               \
00221                                           \
00222 F(MV, FLT, FLT_TYPE, loop_one_step_cgnr, i ## MV ## _plan *ths)               \
00223 {                                                                             \
00224   if(ths-&gt;flags &amp; PRECOMPUTE_DAMP)                                            \
00225     nfft_cp_w_ ## FLT(ths-&gt;mv-&gt;f_hat, ths-&gt;w_hat, ths-&gt;p_hat_iter,            \
00226      ths-&gt;mv-&gt;N_total);                                                       \
00227   else                                                                        \
00228     nfft_cp_ ## FLT(ths-&gt;mv-&gt;f_hat, ths-&gt;p_hat_iter, ths-&gt;mv-&gt;N_total);       \
00229                                                                               \
00230   NFFT_SWAP_ ## FLT(ths-&gt;v_iter,ths-&gt;mv-&gt;f);                                  \
00231   MV ## _trafo(ths-&gt;mv);                                                      \
00232   NFFT_SWAP_ ## FLT(ths-&gt;v_iter,ths-&gt;mv-&gt;f);                                  \
00233                                                                               \
00234   if(ths-&gt;flags &amp; PRECOMPUTE_WEIGHT)                                          \
00235     ths-&gt;dot_v_iter = nfft_dot_w_ ## FLT(ths-&gt;v_iter, ths-&gt;w,                 \
00236                                          ths-&gt;mv-&gt;M_total);                   \
00237   else                                                                        \
00238     ths-&gt;dot_v_iter = nfft_dot_ ## FLT(ths-&gt;v_iter, ths-&gt;mv-&gt;M_total);        \
00239                                                                               \
00240   <span class="comment">/*-----------------*/</span>                                                       \
00241   ths-&gt;alpha_iter = ths-&gt;dot_z_hat_iter / ths-&gt;dot_v_iter;                    \
00242                                                                               \
00243   <span class="comment">/*-----------------*/</span>                                                       \
00244   if(ths-&gt;flags &amp; PRECOMPUTE_DAMP)                                            \
00245     nfft_upd_xpawy_ ## FLT(ths-&gt;f_hat_iter, ths-&gt;alpha_iter, ths-&gt;w_hat,      \
00246           ths-&gt;p_hat_iter, ths-&gt;mv-&gt;N_total);                                 \
00247   else                                                                        \
00248     nfft_upd_xpay_ ## FLT(ths-&gt;f_hat_iter, ths-&gt;alpha_iter, ths-&gt;p_hat_iter,  \
00249          ths-&gt;mv-&gt;N_total);                                                   \
00250                                                                               \
00251   <span class="comment">/*-----------------*/</span>                                                       \
00252   nfft_upd_xpay_ ## FLT(ths-&gt;r_iter, -ths-&gt;alpha_iter, ths-&gt;v_iter,           \
00253        ths-&gt;mv-&gt;M_total);                                                     \
00254                                                                               \
00255   if(ths-&gt;flags &amp; PRECOMPUTE_WEIGHT)                                          \
00256     ths-&gt;dot_r_iter = nfft_dot_w_ ## FLT(ths-&gt;r_iter, ths-&gt;w,                 \
00257                                          ths-&gt;mv-&gt;M_total);                   \
00258   else                                                                        \
00259     ths-&gt;dot_r_iter = nfft_dot_ ## FLT(ths-&gt;r_iter, ths-&gt;mv-&gt;M_total);        \
00260                                                                               \
00261   <span class="comment">/*-----------------*/</span>                                                       \
00262   if(ths-&gt;flags &amp; PRECOMPUTE_WEIGHT)                                          \
00263     nfft_cp_w_ ## FLT(ths-&gt;mv-&gt;f, ths-&gt;w, ths-&gt;r_iter, ths-&gt;mv-&gt;M_total);     \
00264   else                                                                        \
00265     nfft_cp_ ## FLT(ths-&gt;mv-&gt;f, ths-&gt;r_iter, ths-&gt;mv-&gt;M_total);               \
00266                                                                               \
00267   NFFT_SWAP_ ## FLT(ths-&gt;z_hat_iter,ths-&gt;mv-&gt;f_hat);                          \
00268   MV ## _adjoint(ths-&gt;mv);                                                    \
00269   NFFT_SWAP_ ## FLT(ths-&gt;z_hat_iter,ths-&gt;mv-&gt;f_hat);                          \
00270                                                                               \
00271   ths-&gt;dot_z_hat_iter_old = ths-&gt;dot_z_hat_iter;                              \
00272   if(ths-&gt;flags &amp; PRECOMPUTE_DAMP)                                            \
00273     ths-&gt;dot_z_hat_iter =                                                     \
00274       nfft_dot_w_ ## FLT(ths-&gt;z_hat_iter, ths-&gt;w_hat, ths-&gt;mv-&gt;N_total);      \
00275   else                                                                        \
00276     ths-&gt;dot_z_hat_iter = nfft_dot_ ## FLT(ths-&gt;z_hat_iter, ths-&gt;mv-&gt;N_total);\
00277                                                                               \
00278   <span class="comment">/*-----------------*/</span>                                                       \
00279   ths-&gt;beta_iter = ths-&gt;dot_z_hat_iter / ths-&gt;dot_z_hat_iter_old;             \
00280                                                                               \
00281   <span class="comment">/*-----------------*/</span>                                                       \
00282   nfft_upd_axpy_ ## FLT(ths-&gt;p_hat_iter, ths-&gt;beta_iter, ths-&gt;z_hat_iter,     \
00283        ths-&gt;mv-&gt;N_total);                                                     \
00284 } <span class="comment">/* void i&lt;mv&gt;_loop_one_step_cgnr */</span>                                         \
00285                                                                               \
00286                                           \
00287 F(MV, FLT, FLT_TYPE, loop_one_step_cgne, i ## MV ## _plan *ths)               \
00288 {                                                                             \
00289   ths-&gt;alpha_iter = ths-&gt;dot_r_iter / ths-&gt;dot_p_hat_iter;                    \
00290                                                                               \
00291   <span class="comment">/*-----------------*/</span>                                                       \
00292   if(ths-&gt;flags &amp; PRECOMPUTE_DAMP)                                            \
00293     nfft_upd_xpawy_ ## FLT(ths-&gt;f_hat_iter, ths-&gt;alpha_iter, ths-&gt;w_hat,      \
00294           ths-&gt;p_hat_iter, ths-&gt;mv-&gt;N_total);                                 \
00295   else                                                                        \
00296     nfft_upd_xpay_ ## FLT(ths-&gt;f_hat_iter, ths-&gt;alpha_iter, ths-&gt;p_hat_iter,  \
00297                           ths-&gt;mv-&gt;N_total);                                  \
00298                                                                               \
00299   <span class="comment">/*-----------------*/</span>                                                       \
00300   if(ths-&gt;flags &amp; PRECOMPUTE_DAMP)                                            \
00301     nfft_cp_w_ ## FLT(ths-&gt;mv-&gt;f_hat, ths-&gt;w_hat, ths-&gt;p_hat_iter,            \
00302                       ths-&gt;mv-&gt;N_total);                                      \
00303   else                                                                        \
00304     nfft_cp_ ## FLT(ths-&gt;mv-&gt;f_hat, ths-&gt;p_hat_iter, ths-&gt;mv-&gt;N_total);       \
00305                                                                               \
00306   MV ## _trafo(ths-&gt;mv);                                                      \
00307                                                                               \
00308   nfft_upd_xpay_ ## FLT(ths-&gt;r_iter, -ths-&gt;alpha_iter, ths-&gt;mv-&gt;f,            \
00309                         ths-&gt;mv-&gt;M_total);                                    \
00310                                                                               \
00311   ths-&gt;dot_r_iter_old = ths-&gt;dot_r_iter;                                      \
00312   if(ths-&gt;flags &amp; PRECOMPUTE_WEIGHT)                                          \
00313     ths-&gt;dot_r_iter = nfft_dot_w_ ## FLT(ths-&gt;r_iter, ths-&gt;w,                 \
00314                                          ths-&gt;mv-&gt;M_total);                   \
00315   else                                                                        \
00316     ths-&gt;dot_r_iter = nfft_dot_ ## FLT(ths-&gt;r_iter, ths-&gt;mv-&gt;M_total);        \
00317                                                                               \
00318   <span class="comment">/*-----------------*/</span>                                                       \
00319   ths-&gt;beta_iter = ths-&gt;dot_r_iter / ths-&gt;dot_r_iter_old;                     \
00320                                                                               \
00321   <span class="comment">/*-----------------*/</span>                                                       \
00322   if(ths-&gt;flags &amp; PRECOMPUTE_WEIGHT)                                          \
00323     nfft_cp_w_ ## FLT(ths-&gt;mv-&gt;f, ths-&gt;w, ths-&gt;r_iter, ths-&gt;mv-&gt;M_total);     \
00324   else                                                                        \
00325     nfft_cp_ ## FLT(ths-&gt;mv-&gt;f, ths-&gt;r_iter, ths-&gt;mv-&gt;M_total);               \
00326                                                                               \
00327   MV ## _adjoint(ths-&gt;mv);                                                    \
00328                                                                               \
00329   nfft_upd_axpy_ ## FLT(ths-&gt;p_hat_iter, ths-&gt;beta_iter, ths-&gt;mv-&gt;f_hat,      \
00330        ths-&gt;mv-&gt;N_total);                                                     \
00331                                                                               \
00332   if(ths-&gt;flags &amp; PRECOMPUTE_DAMP)                                            \
00333     ths-&gt;dot_p_hat_iter =                                                     \
00334       nfft_dot_w_ ## FLT(ths-&gt;p_hat_iter, ths-&gt;w_hat, ths-&gt;mv-&gt;N_total);      \
00335   else                                                                        \
00336     ths-&gt;dot_p_hat_iter = nfft_dot_ ## FLT(ths-&gt;p_hat_iter, ths-&gt;mv-&gt;N_total);\
00337 } <span class="comment">/* void i&lt;mv&gt;_loop_one_step_cgne */</span>                                         \
00338                                                                               \
00339                                                \
00340 F(MV, FLT, FLT_TYPE, loop_one_step, i ## MV ## _plan *ths)                    \
00341 {                                                                             \
00342   if(ths-&gt;flags &amp; LANDWEBER)                                                  \
00343     i ## MV ## _loop_one_step_landweber(ths);                                 \
00344                                                                               \
00345   if(ths-&gt;flags &amp; STEEPEST_DESCENT)                                           \
00346     i ## MV ## _loop_one_step_steepest_descent(ths);                          \
00347                                                                               \
00348   if(ths-&gt;flags &amp; CGNR)                                                       \
00349     i ## MV ## _loop_one_step_cgnr(ths);                                      \
00350                                                                               \
00351   if(ths-&gt;flags &amp; CGNE)                                                       \
00352     i ## MV ## _loop_one_step_cgne(ths);                                      \
00353 } <span class="comment">/* void i&lt;mv&gt;_loop_one_step */</span>                                              \
00354                                                                               \
00355                                                     \
00356 F(MV, FLT, FLT_TYPE, finalize, i ## MV ## _plan *ths)                         \
00357 {                                                                             \
00358   if(ths-&gt;flags &amp; PRECOMPUTE_WEIGHT)                                          \
00359     fftw_free(ths-&gt;w);                                                        \
00360                                                                               \
00361   if(ths-&gt;flags &amp; PRECOMPUTE_DAMP)                                            \
00362     fftw_free(ths-&gt;w_hat);                                                    \
00363                                                                               \
00364   if(ths-&gt;flags &amp; CGNR)                                                       \
00365     {                                                                         \
00366       fftw_free(ths-&gt;v_iter);                                                 \
00367       fftw_free(ths-&gt;z_hat_iter);                                             \
00368     }                                                                         \
00369                                                                               \
00370   if(ths-&gt;flags &amp; STEEPEST_DESCENT)                                           \
00371     fftw_free(ths-&gt;v_iter);                                                   \
00372                                                                               \
00373   fftw_free(ths-&gt;p_hat_iter);                                                 \
00374   fftw_free(ths-&gt;f_hat_iter);                                                 \
00375                                                                               \
00376   fftw_free(ths-&gt;r_iter);                                                     \
00377   fftw_free(ths-&gt;y);                                                          \
00378 } 
00380 MACRO_SOLVER_IMPL(nfft, complex, double complex)
00381 MACRO_SOLVER_IMPL(nfct, <span class="keywordtype">double</span>, <span class="keywordtype">double</span>)
00382 MACRO_SOLVER_IMPL(nfst, <span class="keywordtype">double</span>, <span class="keywordtype">double</span>)
00383 MACRO_SOLVER_IMPL(nnfft, complex, <span class="keywordtype">double</span> complex)
00384 MACRO_SOLVER_IMPL(mri_inh_2d1d, complex, <span class="keywordtype">double</span> complex)
00385 MACRO_SOLVER_IMPL(mri_inh_3d, complex, <span class="keywordtype">double</span> complex)
00386 MACRO_SOLVER_IMPL(nfsft, complex, <span class="keywordtype">double</span> complex)
</pre></div>    <hr size="1"/>
    Generated on 22 Jan 2007 by Doxygen 1.4.1
  </body>
</html>
