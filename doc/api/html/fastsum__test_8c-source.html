<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
    <title>
      NFFT 3.0.3 API Reference - NFFT: fastsum_test.c Source File
    </title>
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <table>
      <tr>
        <td valign="top">
          <img src="images/logo.png" alt="NFFT Logo">
        </td>
        <td align="left" valign="bottom" width="100%">
          <H1nc>3.0.3 API Reference</H1nc>
        </td>
      </tr>
    </table>  
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="dir_000006.html">applications</a>&nbsp;/&nbsp;<a class="el" href="dir_000016.html">fastsum</a></div>
<h1>fastsum_test.c</h1><a href="fastsum__test_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 
00008 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00009 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00010 <span class="preprocessor">#include &lt;string.h&gt;</span>
00011 <span class="preprocessor">#include &lt;complex.h&gt;</span>
00012 <span class="preprocessor">#include &lt;math.h&gt;</span>
00013 
00014 <span class="preprocessor">#include "<a class="code" href="fastsum_8h.html">fastsum.h</a>"</span>
00015 <span class="preprocessor">#include "<a class="code" href="kernels_8h.html">kernels.h</a>"</span>
00016 
00023 <span class="keywordtype">int</span> <a class="code" href="flags_8c.html#a6">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)
00024 {
00025   <span class="keywordtype">int</span> j,k,t;                                         
00026   <span class="keywordtype">int</span> d;                                             
00027   <span class="keywordtype">int</span> N;                                             
00028   <span class="keywordtype">int</span> M;                                             
00029   <span class="keywordtype">int</span> n;                                             
00030   <span class="keywordtype">int</span> m;                                             
00031   <span class="keywordtype">int</span> p;                                             
00032   <span class="keywordtype">char</span> *s;                                           
00033   complex double (*kernel)(double , int , <span class="keyword">const</span> <span class="keywordtype">double</span> *);  
00034   <span class="keywordtype">double</span> c;                                          
00035   <a class="code" href="structfastsum__plan__.html">fastsum_plan</a> my_fastsum_plan;                      
00036   complex <span class="keywordtype">double</span> *direct;                                   
00037   <span class="keywordtype">double</span> time;                                       
00038   <span class="keywordtype">double</span> error=0.0;                                  
00039   <span class="keywordtype">double</span> eps_I;                                      
00040   <span class="keywordtype">double</span> eps_B;                                      
00042   <span class="keywordflow">if</span> (argc!=11)
00043   {
00044     printf(<span class="stringliteral">"\nfastsum_test d N M n m p kernel c eps_I eps_B\n\n"</span>);
00045     printf(<span class="stringliteral">"  d       dimension                 \n"</span>);
00046     printf(<span class="stringliteral">"  N       number of source nodes    \n"</span>);
00047     printf(<span class="stringliteral">"  M       number of target nodes    \n"</span>);
00048     printf(<span class="stringliteral">"  n       expansion degree          \n"</span>);
00049     printf(<span class="stringliteral">"  m       cut-off parameter         \n"</span>);
00050     printf(<span class="stringliteral">"  p       degree of smoothness      \n"</span>);
00051     printf(<span class="stringliteral">"  kernel  kernel function  (e.g., gaussian)\n"</span>);
00052     printf(<span class="stringliteral">"  c       kernel parameter          \n"</span>);
00053     printf(<span class="stringliteral">"  eps_I   inner boundary            \n"</span>);
00054     printf(<span class="stringliteral">"  eps_B   outer boundary            \n\n"</span>);
00055     exit(-1);
00056   }
00057   <span class="keywordflow">else</span>
00058   {
00059     d=atoi(argv[1]);
00060     N=atoi(argv[2]); c=1.0/pow((<span class="keywordtype">double</span>)N,1.0/(<span class="keywordtype">double</span>)d);
00061     M=atoi(argv[3]);
00062     n=atoi(argv[4]);
00063     m=atoi(argv[5]);
00064     p=atoi(argv[6]);
00065     s=argv[7];
00066     c=atof(argv[8]);
00067     eps_I=atof(argv[9]);
00068     eps_B=atof(argv[10]);
00069     <span class="keywordflow">if</span> (strcmp(s,<span class="stringliteral">"gaussian"</span>)==0)
00070       kernel = gaussian;
00071     else if (strcmp(s,"multiquadric")==0)
00072       kernel = multiquadric;
00073     else if (strcmp(s,"inverse_multiquadric")==0)
00074       kernel = inverse_multiquadric;
00075     else if (strcmp(s,"logarithm")==0)
00076       kernel = logarithm;
00077     else if (strcmp(s,"thinplate_spline")==0)
00078       kernel = thinplate_spline;
00079     else if (strcmp(s,"one_over_square")==0)
00080       kernel = one_over_square;
00081     else if (strcmp(s,"one_over_modulus")==0)
00082       kernel = one_over_modulus;
00083     else if (strcmp(s,"one_over_x")==0)
00084       kernel = one_over_x;
00085     else if (strcmp(s,"inverse_multiquadric3")==0)
00086       kernel = inverse_multiquadric3;
00087     else if (strcmp(s,"sinc_kernel")==0)
00088       kernel = sinc_kernel;
00089     else if (strcmp(s,"cosc")==0)
00090       kernel = cosc;
00091     else if (strcmp(s,"cot")==0)
00092       kernel = cot;
00093     else
00094     {
00095       s=<span class="stringliteral">"multiquadric"</span>;
00096       kernel = multiquadric;
00097     }
00098   }
00099   printf(<span class="stringliteral">"d=%d, N=%d, M=%d, n=%d, m=%d, p=%d, kernel=%s, c=%g, eps_I=%g, eps_B=%g \n"</span>,d,N,M,n,m,p,s,c,eps_I,eps_B);
00100 
00102   <a class="code" href="group__applications__fastsum.html#ga13">fastsum_init_guru</a>(&amp;my_fastsum_plan, d, N, M, kernel, &amp;c, 0, n, m, p, eps_I, eps_B);
00103   <span class="comment">/*fastsum_init_guru(&amp;my_fastsum_plan, d, N, M, kernel, &amp;c, EXACT_NEARFIELD, n, m, p);*/</span>
00104 
00106   <span class="keywordflow">for</span> (k=0; k&lt;N; k++)
00107   {
00108     <span class="keywordtype">double</span> r=(0.25-my_fastsum_plan.<a class="code" href="structfastsum__plan__.html#o15">eps_B</a>/2.0)*pow((<span class="keywordtype">double</span>)rand()/(<span class="keywordtype">double</span>)RAND_MAX,1.0/d);
00109     my_fastsum_plan.<a class="code" href="structfastsum__plan__.html#o5">x</a>[k*d+0] = r;
00110     <span class="keywordflow">for</span> (j=1; j&lt;d; j++)
00111     {
00112       <span class="keywordtype">double</span> phi=2.0*<a class="code" href="group__nfftutil.html#ga57">PI</a>*(double)rand()/(double)RAND_MAX;
00113       my_fastsum_plan.<a class="code" href="structfastsum__plan__.html#o5">x</a>[k*d+j] = r;
00114       <span class="keywordflow">for</span> (t=0; t&lt;j; t++)
00115       {
00116         my_fastsum_plan.<a class="code" href="structfastsum__plan__.html#o5">x</a>[k*d+t] *= cos(phi);
00117       }
00118       my_fastsum_plan.<a class="code" href="structfastsum__plan__.html#o5">x</a>[k*d+j] *= sin(phi);
00119     }
00120 
00121     my_fastsum_plan.<a class="code" href="structfastsum__plan__.html#o3">alpha</a>[k] = (double)rand()/(double)RAND_MAX + I*(double)rand()/(double)RAND_MAX;
00122   }
00123 
00125   <span class="keywordflow">for</span> (k=0; k&lt;M; k++)
00126   {
00127     <span class="keywordtype">double</span> r=(0.25-my_fastsum_plan.<a class="code" href="structfastsum__plan__.html#o15">eps_B</a>/2.0)*pow((<span class="keywordtype">double</span>)rand()/(<span class="keywordtype">double</span>)RAND_MAX,1.0/d);
00128     my_fastsum_plan.<a class="code" href="structfastsum__plan__.html#o6">y</a>[k*d+0] = r;
00129     <span class="keywordflow">for</span> (j=1; j&lt;d; j++)
00130     {
00131       <span class="keywordtype">double</span> phi=2.0*<a class="code" href="group__nfftutil.html#ga57">PI</a>*(double)rand()/(double)RAND_MAX;
00132       my_fastsum_plan.<a class="code" href="structfastsum__plan__.html#o6">y</a>[k*d+j] = r;
00133       <span class="keywordflow">for</span> (t=0; t&lt;j; t++)
00134       {
00135         my_fastsum_plan.<a class="code" href="structfastsum__plan__.html#o6">y</a>[k*d+t] *= cos(phi);
00136       }
00137       my_fastsum_plan.<a class="code" href="structfastsum__plan__.html#o6">y</a>[k*d+j] *= sin(phi);
00138     }
00139   }
00140 
00142   printf(<span class="stringliteral">"direct computation: "</span>); fflush(NULL);
00143   time=<a class="code" href="group__nfftutil.html#ga0">nfft_second</a>();
00144   <a class="code" href="group__applications__fastsum.html#ga15">fastsum_exact</a>(&amp;my_fastsum_plan);
00145   time=<a class="code" href="group__nfftutil.html#ga0">nfft_second</a>()-time;
00146   printf(<span class="stringliteral">"%fsec\n"</span>,time);
00147 
00149   direct = (complex <span class="keywordtype">double</span> *)malloc(my_fastsum_plan.<a class="code" href="structfastsum__plan__.html#o2">M_total</a>*(<span class="keyword">sizeof</span>(complex <span class="keywordtype">double</span>)));
00150   <span class="keywordflow">for</span> (j=0; j&lt;my_fastsum_plan.<a class="code" href="structfastsum__plan__.html#o2">M_total</a>; j++)
00151     direct[j]=my_fastsum_plan.f[j];
00152 
00154   printf("pre-computation:    "); fflush(NULL);
00155   time=nfft_second();
00156   fastsum_precompute(&amp;my_fastsum_plan);
00157   time=nfft_second()-time;
00158   printf("%fsec\n",time);
00159 
00161   printf("fast computation:   "); fflush(NULL);
00162   time=nfft_second();
00163   fastsum_trafo(&amp;my_fastsum_plan);
00164   time=nfft_second()-time;
00165   printf("%fsec\n",time);
00166 
00168   error=0.0;
00169   for (j=0; j&lt;my_fastsum_plan.M_total; j++)
00170   {
00171     <span class="keywordflow">if</span> (cabs(direct[j]-my_fastsum_plan.f[j])/cabs(direct[j])&gt;error)
00172       error=cabs(direct[j]-my_fastsum_plan.f[j])/cabs(direct[j]);
00173   }
00174   printf("max relative error: %e\n",error);
00175 
00177   fastsum_finalize(&amp;my_fastsum_plan);
00178 
00179   return 0;
00180 }
00181 <span class="comment">/* \} */</span>
</pre></div>    <hr size="1"/>
    Generated on 5 Feb 2007 by Doxygen 1.4.1
  </body>
</html>
