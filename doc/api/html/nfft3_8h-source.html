<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
    <title>
      NFFT 3.0.2 API Reference - NFFT: nfft3.h Source File
    </title>
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <table>
      <tr>
        <td valign="top">
          <img src="images/logo.png" alt="NFFT Logo">
        </td>
        <td align="left" valign="bottom" width="100%">
          <H1nc>3.0.2 API Reference</H1nc>
        </td>
      </tr>
    </table>  
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="dir_000005.html">include</a></div>
<h1>nfft3.h</h1><a href="nfft3_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 
00004 <span class="preprocessor">#ifndef NFFT3_H</span>
00005 <span class="preprocessor"></span><span class="preprocessor">#define NFFT3_H</span>
00006 <span class="preprocessor"></span>
00008 <span class="preprocessor">#include &lt;complex.h&gt;</span>
00009 
00011 <span class="preprocessor">#include &lt;fftw3.h&gt;</span>
00012 
<a name="l00014"></a><a class="code" href="nfft3_8h.html#a0">00014</a> <span class="preprocessor">#define MACRO_MV_PLAN(float_type)                                             \</span>
00015 <span class="preprocessor">  int N_total;                          \</span>
00017 <span class="preprocessor">  int M_total;                          \</span>
00018 <span class="preprocessor">                                                                              \</span>
00019 <span class="preprocessor">  float_type *f_hat;                    \</span>
00021 <span class="preprocessor">  float_type *f;                        \</span>
00023 <span class="preprocessor"></span>
00024 <span class="preprocessor"></span><span class="comment">/*###########################################################################*/</span>
00025 <span class="comment">/*###########################################################################*/</span>
00026 <span class="comment">/*###########################################################################*/</span>
00027 
00075 <span class="comment">/* Planner flags, i.e. constant symbols for precomputation and memory usage */</span>
00076 
00087 <span class="preprocessor">#define PRE_PHI_HUT      (1U&lt;&lt; 0)</span>
00088 <span class="preprocessor"></span>
00100 <span class="preprocessor">#define FG_PSI           (1U&lt;&lt; 1)</span>
00101 <span class="preprocessor"></span>
00117 <span class="preprocessor">#define PRE_LIN_PSI      (1U&lt;&lt; 2)</span>
00118 <span class="preprocessor"></span>
00130 <span class="preprocessor">#define PRE_FG_PSI       (1U&lt;&lt; 3)</span>
00131 <span class="preprocessor"></span>
00142 <span class="preprocessor">#define PRE_PSI          (1U&lt;&lt; 4)</span>
00143 <span class="preprocessor"></span>
00155 <span class="preprocessor">#define PRE_FULL_PSI     (1U&lt;&lt; 5)</span>
00156 <span class="preprocessor"></span>
00166 <span class="preprocessor">#define MALLOC_X         (1U&lt;&lt; 6)</span>
00167 <span class="preprocessor"></span>
00178 <span class="preprocessor">#define MALLOC_F_HAT     (1U&lt;&lt; 7)</span>
00179 <span class="preprocessor"></span>
00189 <span class="preprocessor">#define MALLOC_F         (1U&lt;&lt; 8)</span>
00190 <span class="preprocessor"></span>
00200 <span class="preprocessor">#define FFT_OUT_OF_PLACE (1U&lt;&lt; 9)</span>
00201 <span class="preprocessor"></span>
00211 <span class="preprocessor">#define FFTW_INIT        (1U&lt;&lt; 10)</span>
00212 <span class="preprocessor"></span>
00226 <span class="preprocessor">#define PRE_ONE_PSI (PRE_LIN_PSI| PRE_FG_PSI| PRE_PSI| PRE_FULL_PSI)</span>
00227 <span class="preprocessor"></span>
00229 <span class="keyword">typedef</span> <span class="keyword">struct</span>
00230 <span class="keyword"></span>{
<a name="l00231"></a><a class="code" href="group__nfft.html#ga27">00231</a>   <span class="comment">/* api */</span>
00232   <a class="code" href="nfft3_8h.html#a0">MACRO_MV_PLAN</a>(<span class="keywordtype">double</span> complex)
00233 
<a name="l00234"></a><a class="code" href="structnfft__plan.html">00234</a>   <span class="keywordtype">int</span> d;                                
00235   <span class="keywordtype">int</span> *N;                               
00236   <span class="keywordtype">double</span> *sigma;                        
<a name="l00237"></a><a class="code" href="structnfft__plan.html#o0">00237</a>   <span class="keywordtype">int</span> *n;                               
00240   <span class="keywordtype">int</span> n_total;                          
00241   <span class="keywordtype">int</span> m;                                
00247   <span class="keywordtype">double</span> *b;                            
<a name="l00249"></a><a class="code" href="structnfft__plan.html#o9">00249</a>   <span class="keywordtype">int</span> K;                                
00253   <span class="keywordtype">unsigned</span> nfft_flags;                  
00260   <span class="keywordtype">unsigned</span> fftw_flags;                  
00264   <span class="keywordtype">double</span> *x;                            
00267   <span class="keywordtype">double</span> MEASURE_TIME_t[3];             
00270   <span class="comment">/* internal*/</span>
00271   fftw_plan  my_fftw_plan1;             
<a name="l00272"></a><a class="code" href="structnfft__plan.html#o14">00272</a>   fftw_plan  my_fftw_plan2;             
00274   <span class="keywordtype">double</span> **c_phi_inv;                   
00277   <span class="keywordtype">double</span> *psi;                          
<a name="l00280"></a><a class="code" href="structnfft__plan.html#o17">00280</a>   <span class="keywordtype">int</span> *psi_index_g;                     
<a name="l00282"></a><a class="code" href="structnfft__plan.html#o18">00282</a>   <span class="keywordtype">int</span> *psi_index_f;                     
<a name="l00285"></a><a class="code" href="structnfft__plan.html#o19">00285</a>   <span class="keywordtype">double</span> complex *g;                    
<a name="l00288"></a><a class="code" href="structnfft__plan.html#o20">00288</a>   <span class="keywordtype">double</span> complex *g_hat;                
00291   <span class="keywordtype">double</span> complex *g1;                   
00292   <span class="keywordtype">double</span> complex *g2;                   
00294   <span class="keywordtype">double</span> *spline_coeffs;                
00297 } <a class="code" href="structnfft__plan.html">nfft_plan</a>;
00298 
<a name="l00299"></a><a class="code" href="structnfft__plan.html#o24">00299</a> 
00307 <span class="keywordtype">void</span> <a class="code" href="group__nfft.html#ga0">ndft_trafo</a>(<a class="code" href="structnfft__plan.html">nfft_plan</a> *ths);
00308 
00316 <span class="keywordtype">void</span> <a class="code" href="group__nfft.html#ga1">ndft_adjoint</a>(<a class="code" href="structnfft__plan.html">nfft_plan</a> *ths);
00317 
00325 <span class="keywordtype">void</span> <a class="code" href="group__nfft.html#ga2">nfft_trafo</a>(<a class="code" href="structnfft__plan.html">nfft_plan</a> *ths);
00326 
00334 <span class="keywordtype">void</span> <a class="code" href="group__nfft.html#ga3">nfft_adjoint</a>(<a class="code" href="structnfft__plan.html">nfft_plan</a> *ths);
00335 
00345 <span class="keywordtype">void</span> <a class="code" href="group__nfft.html#ga4">nfft_init_1d</a>(<a class="code" href="structnfft__plan.html">nfft_plan</a> *ths, <span class="keywordtype">int</span> N1, <span class="keywordtype">int</span> M);
00346 
00357 <span class="keywordtype">void</span> <a class="code" href="group__nfft.html#ga5">nfft_init_2d</a>(<a class="code" href="structnfft__plan.html">nfft_plan</a> *ths, <span class="keywordtype">int</span> N1, <span class="keywordtype">int</span> N2, <span class="keywordtype">int</span> M);
00358 
00370 <span class="keywordtype">void</span> <a class="code" href="group__nfft.html#ga6">nfft_init_3d</a>(<a class="code" href="structnfft__plan.html">nfft_plan</a> *ths, <span class="keywordtype">int</span> N1, <span class="keywordtype">int</span> N2, <span class="keywordtype">int</span> N3, <span class="keywordtype">int</span> M);
00371 
00382 <span class="keywordtype">void</span> <a class="code" href="group__nfft.html#ga7">nfft_init</a>(<a class="code" href="structnfft__plan.html">nfft_plan</a> *ths, <span class="keywordtype">int</span> d, <span class="keywordtype">int</span> *N, <span class="keywordtype">int</span> M);
00383 
00397 <span class="keywordtype">void</span> <a class="code" href="group__nfft.html#ga8">nfft_init_advanced</a>(<a class="code" href="structnfft__plan.html">nfft_plan</a> *ths, <span class="keywordtype">int</span> d, <span class="keywordtype">int</span> *N, <span class="keywordtype">int</span> M,
00398                         <span class="keywordtype">unsigned</span> nfft_flags_on, <span class="keywordtype">unsigned</span> nfft_flags_off);
00399 
00414 <span class="keywordtype">void</span> <a class="code" href="group__nfft.html#ga9">nfft_init_guru</a>(<a class="code" href="structnfft__plan.html">nfft_plan</a> *ths, <span class="keywordtype">int</span> d, <span class="keywordtype">int</span> *N, <span class="keywordtype">int</span> M, <span class="keywordtype">int</span> *n,
00415                     <span class="keywordtype">int</span> m, <span class="keywordtype">unsigned</span> nfft_flags, <span class="keywordtype">unsigned</span> fftw_flags);
00416 
00417 
00430 <span class="keywordtype">void</span> <a class="code" href="group__nfft.html#ga10">nfft_precompute_one_psi</a>(<a class="code" href="structnfft__plan.html">nfft_plan</a> *ths);
00431 
00436 <span class="keywordtype">void</span> <a class="code" href="group__nfft.html#ga11">nfft_precompute_full_psi</a>(<a class="code" href="structnfft__plan.html">nfft_plan</a> *ths);
00437 
00442 <span class="keywordtype">void</span> <a class="code" href="group__nfft.html#ga12">nfft_precompute_psi</a>(<a class="code" href="structnfft__plan.html">nfft_plan</a> *ths);
00443 
00448 <span class="keywordtype">void</span> <a class="code" href="group__nfft.html#ga13">nfft_precompute_lin_psi</a>(<a class="code" href="structnfft__plan.html">nfft_plan</a> *ths);
00449 
00457 <span class="keywordtype">void</span> <a class="code" href="group__nfft.html#ga14">nfft_check</a>(<a class="code" href="structnfft__plan.html">nfft_plan</a> *ths);
00458 
00466 <span class="keywordtype">void</span> <a class="code" href="group__nfft.html#ga15">nfft_finalize</a>(<a class="code" href="structnfft__plan.html">nfft_plan</a> *ths);
00467 
00471 <span class="comment">/*###########################################################################*/</span>
00472 <span class="comment">/*###########################################################################*/</span>
00473 <span class="comment">/*###########################################################################*/</span>
00474 
00482 <span class="keyword">typedef</span> <span class="keyword">struct</span>
00483 <span class="keyword"></span>{
00484   <span class="comment">/* api */</span>
00485   <a class="code" href="nfft3_8h.html#a0">MACRO_MV_PLAN</a>(<span class="keywordtype">double</span>)
00486 
00487   int d;                                
00488   <span class="keywordtype">int</span> *N;                               
00489   <span class="keywordtype">int</span> *n;                               
<a name="l00490"></a><a class="code" href="structnfct__plan.html">00490</a>   <span class="keywordtype">double</span> *sigma;                        
00491   <span class="keywordtype">int</span> m;                                
<a name="l00493"></a><a class="code" href="structnfct__plan.html#o0">00493</a>   <span class="keywordtype">double</span> nfct_full_psi_eps;
<a name="l00494"></a><a class="code" href="structnfct__plan.html#o1">00494</a>   <span class="keywordtype">double</span> *b;                            
00496   <span class="keywordtype">unsigned</span> nfct_flags;                  
00497   <span class="keywordtype">unsigned</span> fftw_flags;                  
<a name="l00499"></a><a class="code" href="structnfct__plan.html#o5">00499</a>   <span class="keywordtype">double</span> *x;                            
<a name="l00501"></a><a class="code" href="structnfct__plan.html#o7">00501</a>   <span class="keywordtype">double</span> MEASURE_TIME_t[3];             
00504   fftw_plan  my_fftw_r2r_plan;          
<a name="l00505"></a><a class="code" href="structnfct__plan.html#o10">00505</a>   fftw_r2r_kind *r2r_kind;              
<a name="l00507"></a><a class="code" href="structnfct__plan.html#o11">00507</a>   <span class="keywordtype">double</span> **c_phi_inv;                   
<a name="l00508"></a><a class="code" href="structnfct__plan.html#o12">00508</a>   <span class="keywordtype">double</span> *psi;                          
00509   <span class="keywordtype">int</span> size_psi;                         
<a name="l00510"></a><a class="code" href="structnfct__plan.html#o13">00510</a>   <span class="keywordtype">int</span> *psi_index_g;                     
00511   <span class="keywordtype">int</span> *psi_index_f;                     
00513   <span class="keywordtype">double</span> *g;
00514   <span class="keywordtype">double</span> *g_hat;
<a name="l00515"></a><a class="code" href="structnfct__plan.html#o15">00515</a>   <span class="keywordtype">double</span> *g1;                           
<a name="l00516"></a><a class="code" href="structnfct__plan.html#o16">00516</a>   <span class="keywordtype">double</span> *g2;                           
<a name="l00518"></a><a class="code" href="structnfct__plan.html#o17">00518</a>   <span class="keywordtype">double</span> *spline_coeffs;                
<a name="l00520"></a><a class="code" href="structnfct__plan.html#o19">00520</a> } <a class="code" href="structnfct__plan.html">nfct_plan</a>;
<a name="l00521"></a><a class="code" href="structnfct__plan.html#o20">00521</a> 
<a name="l00522"></a><a class="code" href="structnfct__plan.html#o21">00522</a> 
00532 <span class="keywordtype">void</span> nfct_init_1d( <a class="code" href="structnfct__plan.html">nfct_plan</a> *ths_plan, <span class="keywordtype">int</span> N0, <span class="keywordtype">int</span> M_total);
00533 
00544 <span class="keywordtype">void</span> nfct_init_2d( <a class="code" href="structnfct__plan.html">nfct_plan</a> *ths_plan, <span class="keywordtype">int</span> N0, <span class="keywordtype">int</span> N1, <span class="keywordtype">int</span> M_total);
00545 
00557 <span class="keywordtype">void</span> nfct_init_3d( <a class="code" href="structnfct__plan.html">nfct_plan</a> *ths_plan, <span class="keywordtype">int</span> N0, <span class="keywordtype">int</span> N1, <span class="keywordtype">int</span> N2, <span class="keywordtype">int</span> M_total);
00558 
00569 <span class="keywordtype">void</span> nfct_init( <a class="code" href="structnfct__plan.html">nfct_plan</a> *ths_plan, <span class="keywordtype">int</span> d, <span class="keywordtype">int</span> *N, <span class="keywordtype">int</span> M_total);
00570 
00585 <span class="keywordtype">void</span> nfct_init_guru( <a class="code" href="structnfct__plan.html">nfct_plan</a> *ths_plan, <span class="keywordtype">int</span> d, <span class="keywordtype">int</span> *N, <span class="keywordtype">int</span> M_total, <span class="keywordtype">int</span> *n,
00586                          <span class="keywordtype">int</span> m, <span class="keywordtype">unsigned</span> nfct_flags, <span class="keywordtype">unsigned</span> fftw_flags);
00587 
00597 <span class="keywordtype">void</span> nfct_precompute_psi( <a class="code" href="structnfct__plan.html">nfct_plan</a> *ths_plan);
00598 
00599 
00608 <span class="keywordtype">void</span> nfct_trafo( <a class="code" href="structnfct__plan.html">nfct_plan</a> *ths_plan);
00609 
00618 <span class="keywordtype">void</span> ndct_trafo( <a class="code" href="structnfct__plan.html">nfct_plan</a> *ths_plan);
00619 
00628 <span class="keywordtype">void</span> nfct_adjoint( <a class="code" href="structnfct__plan.html">nfct_plan</a> *ths_plan);
00629 
00638 <span class="keywordtype">void</span> ndct_adjoint( <a class="code" href="structnfct__plan.html">nfct_plan</a> *ths_plan);
00639 
00647 <span class="keywordtype">void</span> nfct_finalize( <a class="code" href="structnfct__plan.html">nfct_plan</a> *ths_plan);
00648 
00658 <span class="keywordtype">double</span> nfct_phi_hut( <a class="code" href="structnfct__plan.html">nfct_plan</a> *ths_plan, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> d);
00659 
00669 <span class="keywordtype">double</span> nfct_phi ( <a class="code" href="structnfct__plan.html">nfct_plan</a> *ths_plan, <span class="keywordtype">double</span> x, <span class="keywordtype">int</span> d);
00670 
00678 <span class="keywordtype">int</span> nfct_fftw_2N( <span class="keywordtype">int</span> n);
00679 
00687 <span class="keywordtype">int</span> nfct_fftw_2N_rev(<span class="keywordtype">int</span> n);
00688 
00689 <span class="comment">/*###########################################################################*/</span>
00690 
00692 typedef struct
00693 {
00694   <span class="comment">/* api */</span>
00695   <a class="code" href="nfft3_8h.html#a0">MACRO_MV_PLAN</a>(<span class="keywordtype">double</span>)
00696 
00697   <span class="keywordtype">int</span> d;                                
00698   <span class="keywordtype">int</span> *N;                               
00699   <span class="keywordtype">int</span> *n;                               
00700   <span class="keywordtype">double</span> *sigma;                        
00701   <span class="keywordtype">int</span> m;                                
<a name="l00703"></a><a class="code" href="structnfst__plan.html">00703</a>   <span class="keywordtype">double</span> nfst_full_psi_eps;
00704   <span class="keywordtype">double</span> *b;                            
<a name="l00706"></a><a class="code" href="structnfst__plan.html#o0">00706</a>   <span class="keywordtype">unsigned</span> nfst_flags;                  
<a name="l00707"></a><a class="code" href="structnfst__plan.html#o1">00707</a>   <span class="keywordtype">unsigned</span> fftw_flags;                  
00709   <span class="keywordtype">double</span> *x;                            
<a name="l00711"></a><a class="code" href="structnfst__plan.html#o4">00711</a>   <span class="keywordtype">double</span> MEASURE_TIME_t[3];             
<a name="l00714"></a><a class="code" href="structnfst__plan.html#o7">00714</a>   fftw_plan  my_fftw_r2r_plan;         
<a name="l00715"></a><a class="code" href="structnfst__plan.html#o8">00715</a>   fftw_r2r_kind *r2r_kind;              
00717   <span class="keywordtype">double</span> **c_phi_inv;                   
<a name="l00718"></a><a class="code" href="structnfst__plan.html#o10">00718</a>   <span class="keywordtype">double</span> *psi;                          
00719   <span class="keywordtype">int</span> size_psi;                         
<a name="l00720"></a><a class="code" href="structnfst__plan.html#o11">00720</a>   <span class="keywordtype">int</span> *psi_index_g;                     
<a name="l00721"></a><a class="code" href="structnfst__plan.html#o12">00721</a>   <span class="keywordtype">int</span> *psi_index_f;                     
00724   <span class="keywordtype">double</span> *g;
<a name="l00725"></a><a class="code" href="structnfst__plan.html#o14">00725</a>   <span class="keywordtype">double</span> *g_hat;
00726   <span class="keywordtype">double</span> *g1;                           
00727   <span class="keywordtype">double</span> *g2;                           
<a name="l00729"></a><a class="code" href="structnfst__plan.html#o16">00729</a>   <span class="keywordtype">double</span> *spline_coeffs;                
<a name="l00731"></a><a class="code" href="structnfst__plan.html#o17">00731</a> } <a class="code" href="structnfst__plan.html">nfst_plan</a>;
<a name="l00732"></a><a class="code" href="structnfst__plan.html#o18">00732</a> 
<a name="l00733"></a><a class="code" href="structnfst__plan.html#o19">00733</a> 
<a name="l00743"></a><a class="code" href="structnfst__plan.html#o26">00743</a> <span class="keywordtype">void</span> <a class="code" href="group__nfsct.html#ga15">nfst_init_1d</a>( <a class="code" href="structnfst__plan.html">nfst_plan</a> *ths_plan, <span class="keywordtype">int</span> N0, <span class="keywordtype">int</span> M_total);
00744 
00755 <span class="keywordtype">void</span> <a class="code" href="group__nfsct.html#ga16">nfst_init_2d</a>( <a class="code" href="structnfst__plan.html">nfst_plan</a> *ths_plan, <span class="keywordtype">int</span> N0, <span class="keywordtype">int</span> N1, <span class="keywordtype">int</span> M_total);
00756 
00768 <span class="keywordtype">void</span> <a class="code" href="group__nfsct.html#ga17">nfst_init_3d</a>( <a class="code" href="structnfst__plan.html">nfst_plan</a> *ths_plan, <span class="keywordtype">int</span> N0, <span class="keywordtype">int</span> N1, <span class="keywordtype">int</span> N2, <span class="keywordtype">int</span> M_total);
00769 
00780 <span class="keywordtype">void</span> <a class="code" href="group__nfsct.html#ga18">nfst_init</a>( <a class="code" href="structnfst__plan.html">nfst_plan</a> *ths_plan, <span class="keywordtype">int</span> d, <span class="keywordtype">int</span> *N, <span class="keywordtype">int</span> M_total);
00781 
00794 <span class="keywordtype">void</span> <a class="code" href="group__nfsct.html#ga19">nfst_init_m</a>( <a class="code" href="structnfst__plan.html">nfst_plan</a> *ths_plan, <span class="keywordtype">int</span> d, <span class="keywordtype">int</span> *N, <span class="keywordtype">int</span> M_total, <span class="keywordtype">int</span> m);
00795 
00810 <span class="keywordtype">void</span> <a class="code" href="group__nfsct.html#ga20">nfst_init_guru</a>( <a class="code" href="structnfst__plan.html">nfst_plan</a> *ths_plan, <span class="keywordtype">int</span> d, <span class="keywordtype">int</span> *N, <span class="keywordtype">int</span> M_total, <span class="keywordtype">int</span> *n,
00811                      <span class="keywordtype">int</span> m, <span class="keywordtype">unsigned</span> nfst_flags, <span class="keywordtype">unsigned</span> fftw_flags);
00812 
00822 <span class="keywordtype">void</span> <a class="code" href="group__nfsct.html#ga21">nfst_precompute_psi</a>( <a class="code" href="structnfst__plan.html">nfst_plan</a> *ths_plan);
00823 
00832 <span class="keywordtype">void</span> <a class="code" href="group__nfsct.html#ga22">nfst_trafo</a>( <a class="code" href="structnfst__plan.html">nfst_plan</a> *ths_plan);
00833 
00842 <span class="keywordtype">void</span> <a class="code" href="group__nfsct.html#ga23">ndst_trafo</a>( <a class="code" href="structnfst__plan.html">nfst_plan</a> *ths_plan);
00843 
00844 
00845 
00854 <span class="keywordtype">void</span> <a class="code" href="group__nfsct.html#ga24">nfst_adjoint</a>( <a class="code" href="structnfst__plan.html">nfst_plan</a> *ths_plan);
00855 
00864 <span class="keywordtype">void</span> <a class="code" href="group__nfsct.html#ga25">ndst_adjoint</a>( <a class="code" href="structnfst__plan.html">nfst_plan</a> *ths_plan);
00865 
00873 <span class="keywordtype">void</span> <a class="code" href="group__nfsct.html#ga26">nfst_finalize</a>( <a class="code" href="structnfst__plan.html">nfst_plan</a> *ths_plan);
00874 
00881 <span class="keywordtype">void</span> <a class="code" href="group__nfsct.html#ga27">nfst_full_psi</a>( <a class="code" href="structnfst__plan.html">nfst_plan</a> *ths_plan, <span class="keywordtype">double</span> eps);
00882 
00892 <span class="keywordtype">double</span> <a class="code" href="group__nfsct.html#ga28">nfst_phi_hut</a>( <a class="code" href="structnfst__plan.html">nfst_plan</a> *ths_plan, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> d);
00893 
00903 <span class="keywordtype">double</span> <a class="code" href="group__nfsct.html#ga29">nfst_phi</a> ( <a class="code" href="structnfst__plan.html">nfst_plan</a> *ths_plan, <span class="keywordtype">double</span> x, <span class="keywordtype">int</span> d);
00904 
00912 <span class="keywordtype">int</span> <a class="code" href="group__nfsct.html#ga30">nfst_fftw_2N</a>( <span class="keywordtype">int</span> n);
00913 
00921 <span class="keywordtype">int</span> <a class="code" href="group__nfsct.html#ga31">nfst_fftw_2N_rev</a>( <span class="keywordtype">int</span> n);
00922 
00926 <span class="comment">/*###########################################################################*/</span>
00927 <span class="comment">/*###########################################################################*/</span>
00928 <span class="comment">/*###########################################################################*/</span>
00929 
00944 <span class="preprocessor">#define MALLOC_V         (1U&lt;&lt; 11)</span>
00945 <span class="preprocessor"></span>
00947 <span class="keyword">typedef</span> <span class="keyword">struct</span>
00948 <span class="keyword"></span>{
00949   <span class="comment">/* api */</span>
00950   <a class="code" href="nfft3_8h.html#a0">MACRO_MV_PLAN</a>(<span class="keywordtype">double</span> complex)
00951 
00952   <span class="keywordtype">int</span> d;                                
00953   <span class="keywordtype">double</span> *sigma;                        
00954   <span class="keywordtype">double</span> *a;                            
00955   <span class="keywordtype">int</span> *N;                               
00956   <span class="keywordtype">int</span> *N1;                              
00957   <span class="keywordtype">int</span> *aN1;                             
<a name="l00958"></a><a class="code" href="group__nnfft.html#ga11">00958</a>   <span class="keywordtype">int</span> m;                                
00959   <span class="keywordtype">double</span> *b;                            
00960   <span class="keywordtype">int</span> K;                                
00962   <span class="keywordtype">int</span> aN1_total;                        
<a name="l00964"></a><a class="code" href="structnnfft__plan.html#o0">00964</a>   <a class="code" href="structnfft__plan.html">nfft_plan</a> *direct_plan;               
<a name="l00965"></a><a class="code" href="structnnfft__plan.html#o1">00965</a>   <span class="keywordtype">unsigned</span> nnfft_flags;                 
<a name="l00966"></a><a class="code" href="structnnfft__plan.html#o3">00966</a>   <span class="keywordtype">int</span> *n;                               
00968   <span class="keywordtype">double</span> *x;                            
<a name="l00969"></a><a class="code" href="structnnfft__plan.html#o4">00969</a>   <span class="keywordtype">double</span> *v;                            
<a name="l00971"></a><a class="code" href="structnnfft__plan.html#o6">00971</a>   <span class="keywordtype">double</span> *c_phi_inv;                    
<a name="l00972"></a><a class="code" href="structnnfft__plan.html#o7">00972</a>   <span class="keywordtype">double</span> *psi;                          
<a name="l00973"></a><a class="code" href="structnnfft__plan.html#o8">00973</a>   <span class="keywordtype">int</span> size_psi;                         
<a name="l00974"></a><a class="code" href="structnnfft__plan.html#o9">00974</a>   <span class="keywordtype">int</span> *psi_index_g;                     
<a name="l00975"></a><a class="code" href="structnnfft__plan.html#o10">00975</a>   <span class="keywordtype">int</span> *psi_index_f;                     
<a name="l00976"></a><a class="code" href="structnnfft__plan.html#o11">00976</a>   <span class="keywordtype">double</span> complex *F;
<a name="l00977"></a><a class="code" href="structnnfft__plan.html#o12">00977</a> 
00978   <span class="keywordtype">double</span> *spline_coeffs;                
00980 } <a class="code" href="structnnfft__plan.html">nnfft_plan</a>;
<a name="l00981"></a><a class="code" href="structnnfft__plan.html#o14">00981</a> 
<a name="l00982"></a><a class="code" href="structnnfft__plan.html#o15">00982</a> 
00994 <span class="keywordtype">void</span> <a class="code" href="group__nnfft.html#ga0">nnfft_init</a>(<a class="code" href="structnnfft__plan.html">nnfft_plan</a> *ths_plan, <span class="keywordtype">int</span> d, <span class="keywordtype">int</span> N_total, <span class="keywordtype">int</span> M_total, <span class="keywordtype">int</span> *N);
<a name="l00995"></a><a class="code" href="structnnfft__plan.html#o25">00995</a> 
01010 <span class="keywordtype">void</span> <a class="code" href="group__nnfft.html#ga1">nnfft_init_guru</a>(<a class="code" href="structnnfft__plan.html">nnfft_plan</a> *ths_plan, <span class="keywordtype">int</span> d, <span class="keywordtype">int</span> N_total, <span class="keywordtype">int</span> M_total,
01011                      <span class="keywordtype">int</span> *N, <span class="keywordtype">int</span> *N1, <span class="keywordtype">int</span> m, <span class="keywordtype">unsigned</span> nnfft_flags);
01012 
01024 <span class="keywordtype">void</span> <a class="code" href="group__nnfft.html#ga2">nndft_trafo</a>(<a class="code" href="structnnfft__plan.html">nnfft_plan</a> *ths_plan);
01025 
01037 <span class="keywordtype">void</span> <a class="code" href="group__nnfft.html#ga3">nndft_adjoint</a>(<a class="code" href="structnnfft__plan.html">nnfft_plan</a> *ths_plan);
01038 
01050 <span class="keywordtype">void</span> <a class="code" href="group__nnfft.html#ga4">nnfft_trafo</a>(<a class="code" href="structnnfft__plan.html">nnfft_plan</a> *ths_plan);
01051 
01063 <span class="keywordtype">void</span> <a class="code" href="group__nnfft.html#ga5">nnfft_adjoint</a>(<a class="code" href="structnnfft__plan.html">nnfft_plan</a> *ths_plan);
01064 
01076 <span class="keywordtype">void</span> <a class="code" href="group__nnfft.html#ga6">nnfft_precompute_lin_psi</a>(<a class="code" href="structnnfft__plan.html">nnfft_plan</a> *ths_plan);
01077 
01090 <span class="keywordtype">void</span> <a class="code" href="group__nnfft.html#ga7">nnfft_precompute_psi</a>(<a class="code" href="structnnfft__plan.html">nnfft_plan</a> *ths_plan);
01091 
01105 <span class="keywordtype">void</span> <a class="code" href="group__nnfft.html#ga8">nnfft_precompute_full_psi</a>(<a class="code" href="structnnfft__plan.html">nnfft_plan</a> *ths_plan);
01106 
01119 <span class="keywordtype">void</span> <a class="code" href="group__nnfft.html#ga9">nnfft_precompute_phi_hut</a>(<a class="code" href="structnnfft__plan.html">nnfft_plan</a> *ths_plan);
01120 
01128 <span class="keywordtype">void</span> <a class="code" href="group__nnfft.html#ga10">nnfft_finalize</a>(<a class="code" href="structnnfft__plan.html">nnfft_plan</a> *ths_plan);
01129 
01133 <span class="comment">/*###########################################################################*/</span>
01134 <span class="comment">/*###########################################################################*/</span>
01135 <span class="comment">/*###########################################################################*/</span>
01136 
01151 <span class="preprocessor">#define NSDFT            (1U&lt;&lt; 12)</span>
01152 <span class="preprocessor"></span>
01154 <span class="keyword">typedef</span> <span class="keyword">struct</span>
01155 <span class="keyword"></span>{
01156   <a class="code" href="nfft3_8h.html#a0">MACRO_MV_PLAN</a>(<span class="keywordtype">double</span> complex)
01157 
01158   <span class="keywordtype">int</span> d;                                
01159   <span class="keywordtype">int</span> J;                                
01163   <span class="keywordtype">int</span> sigma;                            
01165   <span class="keywordtype">unsigned</span> flags;                       
01167   <span class="keywordtype">int</span> *index_sparse_to_full;            
01170   <span class="keywordtype">int</span> r_act_nfft_plan;                  
<a name="l01171"></a><a class="code" href="structnsfft__plan.html">01171</a>   <a class="code" href="structnfft__plan.html">nfft_plan</a> *act_nfft_plan;             
01172   <a class="code" href="structnfft__plan.html">nfft_plan</a> *center_nfft_plan;          
<a name="l01174"></a><a class="code" href="structnsfft__plan.html#o1">01174</a>   fftw_plan* set_fftw_plan1;            
<a name="l01175"></a><a class="code" href="structnsfft__plan.html#o3">01175</a>   fftw_plan* set_fftw_plan2;            
01177   <a class="code" href="structnfft__plan.html">nfft_plan</a> *set_nfft_plan_1d;          
<a name="l01178"></a><a class="code" href="structnsfft__plan.html#o4">01178</a>   <a class="code" href="structnfft__plan.html">nfft_plan</a> *set_nfft_plan_2d;          
01180   <span class="keywordtype">double</span> *x_transposed;                 
01181   <span class="keywordtype">double</span> *x_102,*x_201,*x_120,*x_021;   
<a name="l01183"></a><a class="code" href="structnsfft__plan.html#o6">01183</a> } <a class="code" href="structnsfft__plan.html">nsfft_plan</a>;
01184 
<a name="l01195"></a><a class="code" href="structnsfft__plan.html#o13">01195</a> <span class="keywordtype">void</span> <a class="code" href="group__nsfft.html#ga0">nsdft_trafo</a>(<a class="code" href="structnsfft__plan.html">nsfft_plan</a> *ths);
01196 
01207 <span class="keywordtype">void</span> <a class="code" href="group__nsfft.html#ga1">nsdft_adjoint</a>(<a class="code" href="structnsfft__plan.html">nsfft_plan</a> *ths);
01208 
01220 <span class="keywordtype">void</span> <a class="code" href="group__nsfft.html#ga2">nsfft_trafo</a>(<a class="code" href="structnsfft__plan.html">nsfft_plan</a> *ths);
01221 
01233 <span class="keywordtype">void</span> <a class="code" href="group__nsfft.html#ga3">nsfft_adjoint</a>(<a class="code" href="structnsfft__plan.html">nsfft_plan</a> *ths);
01234 
01242 <span class="keywordtype">void</span> <a class="code" href="group__nsfft.html#ga4">nsfft_cp</a>(<a class="code" href="structnsfft__plan.html">nsfft_plan</a> *ths, <a class="code" href="structnfft__plan.html">nfft_plan</a> *ths_nfft);
01243 
01251 <span class="keywordtype">void</span> <a class="code" href="group__nsfft.html#ga5">nsfft_init_random_nodes_coeffs</a>(<a class="code" href="structnsfft__plan.html">nsfft_plan</a> *ths);
01252 
01265 <span class="keywordtype">void</span> <a class="code" href="group__nsfft.html#ga6">nsfft_init</a>(<a class="code" href="structnsfft__plan.html">nsfft_plan</a> *ths, <span class="keywordtype">int</span> d, <span class="keywordtype">int</span> J, <span class="keywordtype">int</span> M, <span class="keywordtype">int</span> m, <span class="keywordtype">unsigned</span> flags);
01266 
01274 <span class="keywordtype">void</span> <a class="code" href="group__nsfft.html#ga7">nsfft_finalize</a>(<a class="code" href="structnsfft__plan.html">nsfft_plan</a> *ths);
01275 
01279 <span class="comment">/*###########################################################################*/</span>
01280 <span class="comment">/*###########################################################################*/</span>
01281 <span class="comment">/*###########################################################################*/</span>
01282 
01290 <span class="keyword">typedef</span> <span class="keyword">struct</span>
01291 <span class="keyword"></span>{
01292   <span class="comment">/* api */</span>
01293   <a class="code" href="nfft3_8h.html#a0">MACRO_MV_PLAN</a>(<span class="keywordtype">double</span> complex)
01294 
01295   <a class="code" href="structnfft__plan.html">nfft_plan</a> plan;
01296 
01297   <span class="keywordtype">int</span> N3;
01298   <span class="keywordtype">double</span> sigma3;
01299   <span class="keywordtype">double</span> *t;
01300   <span class="keywordtype">double</span> *w;
01301 } <a class="code" href="structmri__inh__2d1d__plan.html">mri_inh_2d1d_plan</a>;
01302 
01306 <span class="keyword">typedef</span> <span class="keyword">struct</span>
01307 <span class="keyword"></span>{
01308   <span class="comment">/* api */</span>
01309   <a class="code" href="nfft3_8h.html#a0">MACRO_MV_PLAN</a>(<span class="keywordtype">double</span> complex)
<a name="l01310"></a><a class="code" href="structmri__inh__2d1d__plan.html">01310</a> 
01311   <a class="code" href="structnfft__plan.html">nfft_plan</a> plan;
01312 
<a name="l01313"></a><a class="code" href="structmri__inh__2d1d__plan.html#o0">01313</a>   <span class="keywordtype">int</span> N3;
<a name="l01314"></a><a class="code" href="structmri__inh__2d1d__plan.html#o1">01314</a>   <span class="keywordtype">double</span> sigma3;
<a name="l01315"></a><a class="code" href="structmri__inh__2d1d__plan.html#o3">01315</a>   <span class="keywordtype">double</span> *t;
01316   <span class="keywordtype">double</span> *w;
01317 } <a class="code" href="structmri__inh__3d__plan.html">mri_inh_3d_plan</a>;
01318 
01319 
<a name="l01332"></a><a class="code" href="structmri__inh__3d__plan.html#o0">01332</a> <span class="keywordtype">void</span> <a class="code" href="group__mri.html#ga0">mri_inh_2d1d_trafo</a>(<a class="code" href="structmri__inh__2d1d__plan.html">mri_inh_2d1d_plan</a> *ths);
<a name="l01333"></a><a class="code" href="structmri__inh__3d__plan.html#o1">01333</a> 
01346 <span class="keywordtype">void</span> <a class="code" href="group__mri.html#ga1">mri_inh_2d1d_adjoint</a>(<a class="code" href="structmri__inh__2d1d__plan.html">mri_inh_2d1d_plan</a> *ths);
01347 
01361 <span class="keywordtype">void</span> <a class="code" href="group__mri.html#ga2">mri_inh_2d1d_init_guru</a>(<a class="code" href="structmri__inh__2d1d__plan.html">mri_inh_2d1d_plan</a> *ths, <span class="keywordtype">int</span> *N, <span class="keywordtype">int</span> M, <span class="keywordtype">int</span> *n,
01362                     <span class="keywordtype">int</span> m, <span class="keywordtype">double</span> sigma, <span class="keywordtype">unsigned</span> nfft_flags, <span class="keywordtype">unsigned</span> fftw_flags);
01363 
01371 <span class="keywordtype">void</span> <a class="code" href="group__mri.html#ga3">mri_inh_2d1d_finalize</a>(<a class="code" href="structmri__inh__2d1d__plan.html">mri_inh_2d1d_plan</a> *ths);
01372 
01385 <span class="keywordtype">void</span> <a class="code" href="group__mri.html#ga4">mri_inh_3d_trafo</a>(<a class="code" href="structmri__inh__3d__plan.html">mri_inh_3d_plan</a> *ths);
01386 
01399 <span class="keywordtype">void</span> <a class="code" href="group__mri.html#ga5">mri_inh_3d_adjoint</a>(<a class="code" href="structmri__inh__3d__plan.html">mri_inh_3d_plan</a> *ths);
01400 
01401 <span class="keywordtype">void</span> mri_inh_3d_init_guru(<a class="code" href="structmri__inh__3d__plan.html">mri_inh_3d_plan</a> *ths, <span class="keywordtype">int</span> *N, <span class="keywordtype">int</span> M, <span class="keywordtype">int</span> *n,
01402                     <span class="keywordtype">int</span> m, <span class="keywordtype">double</span> sigma, <span class="keywordtype">unsigned</span> nfft_flags, <span class="keywordtype">unsigned</span> fftw_flags);
01403 
01411 <span class="keywordtype">void</span> <a class="code" href="group__mri.html#ga7">mri_inh_3d_finalize</a>(<a class="code" href="structmri__inh__3d__plan.html">mri_inh_3d_plan</a> *ths);
01412 
01416 <span class="comment">/*###########################################################################*/</span>
01417 <span class="comment">/*###########################################################################*/</span>
01418 <span class="comment">/*###########################################################################*/</span>
01419 
01671 <span class="comment">/* Planner flags */</span>
01672 
01692 <span class="preprocessor">#define NFSFT_NORMALIZED    (1U &lt;&lt; 0)</span>
01693 <span class="preprocessor"></span>
01704 <span class="preprocessor">#define NFSFT_USE_NDFT      (1U &lt;&lt; 1)</span>
01705 <span class="preprocessor"></span>
01717 <span class="preprocessor">#define NFSFT_USE_DPT       (1U &lt;&lt; 2)</span>
<a name="l01718"></a><a class="code" href="group__nfsft.html#ga25">01718</a> <span class="preprocessor"></span>
01732 <span class="preprocessor">#define NFSFT_MALLOC_X      (1U &lt;&lt; 3)</span>
01733 <span class="preprocessor"></span>
01747 <span class="preprocessor">#define NFSFT_MALLOC_F_HAT  (1U &lt;&lt; 5)</span>
01748 <span class="preprocessor"></span>
01762 <span class="preprocessor">#define NFSFT_MALLOC_F      (1U &lt;&lt; 6)</span>
01763 <span class="preprocessor"></span>
01774 <span class="preprocessor">#define NFSFT_PRESERVE_F_HAT (1U &lt;&lt; 7)</span>
01775 <span class="preprocessor"></span>
01787 <span class="preprocessor">#define NFSFT_PRESERVE_X     (1U &lt;&lt; 8)</span>
<a name="l01788"></a><a class="code" href="group__nfsft.html#ga30">01788</a> <span class="preprocessor"></span>
01799 <span class="preprocessor">#define NFSFT_PRESERVE_F     (1U &lt;&lt; 9)</span>
<a name="l01800"></a><a class="code" href="group__nfsft.html#ga31">01800</a> <span class="preprocessor"></span>
01810 <span class="preprocessor">#define NFSFT_DESTROY_F_HAT    (1U &lt;&lt; 10)</span>
01811 <span class="preprocessor"></span>
01822 <span class="preprocessor">#define NFSFT_DESTROY_X      (1U &lt;&lt; 11)</span>
01823 <span class="preprocessor"></span>
01833 <span class="preprocessor">#define NFSFT_DESTROY_F      (1U &lt;&lt; 12)</span>
01834 <span class="preprocessor"></span>
01835 <span class="comment">/* Precomputation flags */</span>
<a name="l01836"></a><a class="code" href="group__nfsft.html#ga34">01836</a> 
01846 <span class="preprocessor">#define NFSFT_NO_DIRECT_ALGORITHM    (1U &lt;&lt; 13)</span>
01847 <span class="preprocessor"></span>
01857 <span class="preprocessor">#define NFSFT_NO_FAST_ALGORITHM      (1U &lt;&lt; 14)</span>
01858 <span class="preprocessor"></span>
01866 <span class="preprocessor">#define NFSFT_ZERO_F_HAT             (1U &lt;&lt; 16)</span>
01867 <span class="preprocessor"></span>
01868 <span class="comment">/* */</span>
01869 
01878 <span class="preprocessor">#define NFSFT_INDEX(k,n,plan)        ((2*(plan)-&gt;N+2)*((plan)-&gt;N-n+1)+(plan)-&gt;N+k+1)</span>
01879 <span class="preprocessor"></span>
01884 <span class="preprocessor">#define NFSFT_F_HAT_SIZE(N)          ((2*N+2)*(2*N+2))</span>
01885 <span class="preprocessor"></span>
01887 <span class="keyword">typedef</span> <span class="keyword">struct</span>
01888 <span class="keyword"></span>{
01890   <a class="code" href="nfft3_8h.html#a0">MACRO_MV_PLAN</a>(<span class="keywordtype">double</span> complex)
01891 
<a name="l01892"></a><a class="code" href="group__nfsft.html#ga39">01892</a>   <span class="comment">/* Public members */</span>
01893   <span class="keywordtype">int</span> N;                              
01894   <span class="keywordtype">double</span> *x;                          
01901   <span class="comment">/* Private members */</span>
01902   <span class="comment">/*int NPT;*/</span>                        
<a name="l01904"></a><a class="code" href="group__nfsft.html#ga40">01904</a>   <span class="keywordtype">int</span> t;                              
01906   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags;                 
01907   <a class="code" href="structnfft__plan.html">nfft_plan</a> plan_nfft;                
01908   <span class="keywordtype">double</span> complex *f_hat_intern;              
<a name="l01910"></a><a class="code" href="group__nfsft.html#ga41">01910</a> } <a class="code" href="structnfsft__plan.html">nfsft_plan</a>;
01911 
01921 <span class="keywordtype">void</span> <a class="code" href="group__nfsft.html#ga1">nfsft_init</a>(<a class="code" href="structnfsft__plan.html">nfsft_plan</a> *plan, <span class="keywordtype">int</span> N, <span class="keywordtype">int</span> M);
<a name="l01922"></a><a class="code" href="structnfsft__plan.html#o4">01922</a> 
<a name="l01933"></a><a class="code" href="structnfsft__plan.html#o6">01933</a> <span class="keywordtype">void</span> <a class="code" href="group__nfsft.html#ga2">nfsft_init_advanced</a>(<a class="code" href="structnfsft__plan.html">nfsft_plan</a>* plan, <span class="keywordtype">int</span> N, <span class="keywordtype">int</span> M, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>
01934                          nfsft_flags);
<a name="l01935"></a><a class="code" href="structnfsft__plan.html#o7">01935</a> 
01947 <span class="keywordtype">void</span> <a class="code" href="group__nfsft.html#ga3">nfsft_init_guru</a>(<a class="code" href="structnfsft__plan.html">nfsft_plan</a> *plan, <span class="keywordtype">int</span> N, <span class="keywordtype">int</span> M, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nfsft_flags,
01948   <span class="keywordtype">int</span> nfft_flags, <span class="keywordtype">int</span> nfft_cutoff);
01949 
01963 <span class="keywordtype">void</span> <a class="code" href="group__nfsft.html#ga4">nfsft_precompute</a>(<span class="keywordtype">int</span> N, <span class="keywordtype">double</span> kappa, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nfsft_flags,
01964   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> fpt_flags);
01965 
01971 <span class="keywordtype">void</span> <a class="code" href="group__nfsft.html#ga5">nfsft_forget</a>();
01972 
01984 <span class="keywordtype">void</span> <a class="code" href="group__nfsft.html#ga6">ndsft_trafo</a>(<a class="code" href="structnfsft__plan.html">nfsft_plan</a>* plan);
01985 
01998 <span class="keywordtype">void</span> <a class="code" href="group__nfsft.html#ga7">ndsft_adjoint</a>(<a class="code" href="structnfsft__plan.html">nfsft_plan</a>* plan);
01999 
02011 <span class="keywordtype">void</span> <a class="code" href="group__nfsft.html#ga8">nfsft_trafo</a>(<a class="code" href="structnfsft__plan.html">nfsft_plan</a>* plan);
02012 
02025 <span class="keywordtype">void</span> <a class="code" href="group__nfsft.html#ga9">nfsft_adjoint</a>(<a class="code" href="structnfsft__plan.html">nfsft_plan</a>* plan);
02026 
02034 <span class="keywordtype">void</span> <a class="code" href="group__nfsft.html#ga10">nfsft_finalize</a>(<a class="code" href="structnfsft__plan.html">nfsft_plan</a>* plan);
02035 
02036 <span class="keywordtype">void</span> nfsft_precompute_x(<a class="code" href="structnfsft__plan.html">nfsft_plan</a> *plan);
02037 
02038 
02042 <span class="comment">/*###########################################################################*/</span>
02043 <span class="comment">/*###########################################################################*/</span>
02044 <span class="comment">/*###########################################################################*/</span>
02045 
02054 <span class="comment">/* Flags for fpt_init() */</span>
02055 <span class="preprocessor">#define FPT_NO_FAST_ALGORITHM (1U &lt;&lt; 2) </span>
02056 <span class="preprocessor">#define FPT_NO_DIRECT_ALGORITHM (1U &lt;&lt; 3) </span>
02057 <span class="preprocessor">#define FPT_NO_STABILIZATION  (1U &lt;&lt; 0) </span>
02060 <span class="preprocessor">#define FPT_PERSISTENT_DATA   (1U &lt;&lt; 4) </span>
02062 <span class="preprocessor"></span><span class="comment">/* Flags for fpt_trafo(), dpt_transposed(), fpt_trafo(), fpt_transposed() */</span>
02063 <span class="preprocessor">#define FPT_FUNCTION_VALUES   (1U &lt;&lt; 5) </span>
02066 <span class="preprocessor">#define FPT_AL_SYMMETRY       (1U &lt;&lt; 6) </span>
02068 <span class="preprocessor"></span><span class="comment">/* Data structures */</span>
02069 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structfpt__set__s__.html">fpt_set_s_</a> *<a class="code" href="structfpt__set__s__.html">fpt_set</a>;     
<a name="l02086"></a><a class="code" href="group__fpt.html#ga10">02086</a> <a class="code" href="group__fpt.html#ga0">fpt_set</a> <a class="code" href="group__fpt.html#ga1">fpt_init</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> M, <span class="keyword">const</span> <span class="keywordtype">int</span> t, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags);
02087 
02108 <span class="keywordtype">void</span> <a class="code" href="group__fpt.html#ga2">fpt_precompute</a>(fpt_set set, <span class="keyword">const</span> <span class="keywordtype">int</span> m, <span class="keyword">const</span> <span class="keywordtype">double</span> *alpha,
02109                     <span class="keyword">const</span> <span class="keywordtype">double</span> *beta, <span class="keyword">const</span> <span class="keywordtype">double</span> *gamma, <span class="keywordtype">int</span> k_start,
02110                     <span class="keyword">const</span> <span class="keywordtype">double</span> threshold);
02111 
02122 <span class="keywordtype">void</span> <a class="code" href="group__fpt.html#ga3">dpt_trafo</a>(fpt_set set, <span class="keyword">const</span> <span class="keywordtype">int</span> m, <span class="keyword">const</span> <span class="keywordtype">double</span> complex *x, <span class="keywordtype">double</span> complex *y,
02123   <span class="keyword">const</span> <span class="keywordtype">int</span> k_end, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags);
02124 
02135 <span class="keywordtype">void</span> <a class="code" href="group__fpt.html#ga4">fpt_trafo</a>(fpt_set set, <span class="keyword">const</span> <span class="keywordtype">int</span> m, <span class="keyword">const</span> <span class="keywordtype">double</span> complex *x, <span class="keywordtype">double</span> complex *y,
02136   <span class="keyword">const</span> <span class="keywordtype">int</span> k_end, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags);
02137 
02148 <span class="keywordtype">void</span> <a class="code" href="group__fpt.html#ga5">dpt_transposed</a>(fpt_set set, <span class="keyword">const</span> <span class="keywordtype">int</span> m, <span class="keywordtype">double</span> complex *x, 
02149   <span class="keywordtype">double</span> complex *y, <span class="keyword">const</span> <span class="keywordtype">int</span> k_end, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags);
02150 
02161 <span class="keywordtype">void</span> <a class="code" href="group__fpt.html#ga6">fpt_transposed</a>(fpt_set set, <span class="keyword">const</span> <span class="keywordtype">int</span> m, <span class="keywordtype">double</span> complex *x, 
02162   <span class="keyword">const</span> <span class="keywordtype">double</span> complex *y, <span class="keyword">const</span> <span class="keywordtype">int</span> k_end, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags);
02163 
02164 <span class="keywordtype">void</span> <a class="code" href="group__fpt.html#ga7">fpt_finalize</a>(fpt_set set);
02165 
02169 <span class="comment">/*###########################################################################*/</span>
02170 <span class="comment">/*###########################################################################*/</span>
02171 <span class="comment">/*###########################################################################*/</span>
02172 
02177 <span class="comment">/* Planner flags, i.e. constant symbols for methods */</span>
02178 
02185 <span class="preprocessor">#define LANDWEBER             (1U&lt;&lt; 0)</span>
02186 <span class="preprocessor"></span>
02193 <span class="preprocessor">#define STEEPEST_DESCENT      (1U&lt;&lt; 1)</span>
02194 <span class="preprocessor"></span>
02202 <span class="preprocessor">#define CGNR                  (1U&lt;&lt; 2)</span>
02203 <span class="preprocessor"></span>
02211 <span class="preprocessor">#define CGNE                  (1U&lt;&lt; 3)</span>
02212 <span class="preprocessor"></span>
02219 <span class="preprocessor">#define NORMS_FOR_LANDWEBER   (1U&lt;&lt; 4)</span>
02220 <span class="preprocessor"></span>
02227 <span class="preprocessor">#define PRECOMPUTE_WEIGHT     (1U&lt;&lt; 5)</span>
02228 <span class="preprocessor"></span>
02235 <span class="preprocessor">#define PRECOMPUTE_DAMP       (1U&lt;&lt; 6)</span>
02236 <span class="preprocessor"></span>
02246 <span class="preprocessor">#define MACRO_SOLVER_PLAN(MV, FLT, FLT_TYPE)                                  \</span>
02247 <span class="preprocessor">                                                                              \</span>
<a name="l02248"></a><a class="code" href="group__solver.html#ga39">02248</a> <span class="preprocessor">                               \</span>
02249 <span class="preprocessor">typedef struct                                                                \</span>
02250 <span class="preprocessor">{                                                                             \</span>
02251 <span class="preprocessor">  MV ## _plan *mv;                      \</span>
02252 <span class="preprocessor">  unsigned flags;                       \</span>
02253 <span class="preprocessor">                                                                              \</span>
02254 <span class="preprocessor">  double *w;                            \</span>
02255 <span class="preprocessor">  double *w_hat;                        \</span>
<a name="l02256"></a><a class="code" href="group__solver.html#ga40">02256</a> <span class="preprocessor">                                                                              \</span>
02257 <span class="preprocessor">  FLT_TYPE *y;                          \</span>
02258 <span class="preprocessor">                                                                              \</span>
02259 <span class="preprocessor">  FLT_TYPE *f_hat_iter;                 \</span>
02260 <span class="preprocessor">                                                                              \</span>
02261 <span class="preprocessor">  FLT_TYPE *r_iter;                     \</span>
02262 <span class="preprocessor">  FLT_TYPE *z_hat_iter;                 \</span>
<a name="l02264"></a><a class="code" href="group__solver.html#ga41">02264</a> <span class="preprocessor">  FLT_TYPE *p_hat_iter;                 \</span>
02265 <span class="preprocessor">  FLT_TYPE *v_iter;                     \</span>
02266 <span class="preprocessor">                                                                              \</span>
02267 <span class="preprocessor">  double alpha_iter;                    \</span>
02268 <span class="preprocessor">  double beta_iter;                     \</span>
02269 <span class="preprocessor">                                                                              \</span>
02270 <span class="preprocessor">  double dot_r_iter;                    \</span>
02271 <span class="preprocessor">  double dot_r_iter_old;                \</span>
02272 <span class="preprocessor">  double dot_z_hat_iter;                \</span>
02274 <span class="preprocessor">  double dot_z_hat_iter_old;            \</span>
<a name="l02275"></a><a class="code" href="group__solver.html#ga42">02275</a> <span class="preprocessor">  double dot_p_hat_iter;                \</span>
02277 <span class="preprocessor">  double dot_v_iter;                    \</span>
02278 <span class="preprocessor">} i ## MV ## _plan;                                                           \</span>
02279 <span class="preprocessor">                                                                              \</span>
02280 <span class="preprocessor">                                                 \</span>
02281 <span class="preprocessor">void i ## MV ## _init(i ## MV ## _plan *ths, MV ## _plan *mv);                \</span>
02282 <span class="preprocessor">                                               \</span>
02283 <span class="preprocessor">void i ## MV ## _init_advanced(i ## MV ## _plan *ths, MV ## _plan *mv,        \</span>
02284 <span class="preprocessor">                               unsigned i ## MV ## _flags);                   \</span>
02285 <span class="preprocessor">                      \</span>
02286 <span class="preprocessor">void i ## MV ## _before_loop(i ## MV ## _plan *ths);                          \</span>
02287 <span class="preprocessor">                                       \</span>
02288 <span class="preprocessor">void i ## MV ## _loop_one_step(i ## MV ## _plan *ths);                        \</span>
02289 <span class="preprocessor">                           \</span>
02290 <span class="preprocessor">void i ## MV ## _finalize(i ## MV ## _plan *ths);                             \</span>
02291 <span class="preprocessor"></span>
02292 <span class="preprocessor"></span><span class="comment">/* previous function declarations didn't work with doxygen ....</span>
02293 <span class="comment">  F(MV, FLT, FLT_TYPE, init,    i ## MV ## _plan *ths, MV ## _plan *mv);</span>
02294 <span class="comment">  F(MV, FLT, FLT_TYPE, init_advanced, i ## MV ## _plan *ths, MV ## _plan *mv,</span>
02295 <span class="comment">                                      unsigned i ## MV ## _flags);</span>
02296 <span class="comment">  F(MV, FLT, FLT_TYPE, before_loop,   i ## MV ## _plan *ths);</span>
02297 <span class="comment">  F(MV, FLT, FLT_TYPE, loop_one_step, i ## MV ## _plan *ths);</span>
02298 <span class="comment">  F(MV, FLT, FLT_TYPE, finalize,      i ## MV ## _plan *ths);</span>
02299 <span class="comment">*/</span>
02300 
02301 
02302 <a class="code" href="group__solver.html#ga42">MACRO_SOLVER_PLAN</a>(nfft, complex, <span class="keywordtype">double</span> complex)
02303 <a class="code" href="group__solver.html#ga42">MACRO_SOLVER_PLAN</a>(nfct, <span class="keywordtype">double</span>, <span class="keywordtype">double</span>)
02304 MACRO_SOLVER_PLAN(nfst, <span class="keywordtype">double</span>, <span class="keywordtype">double</span>)
02305 MACRO_SOLVER_PLAN(nnfft, complex, <span class="keywordtype">double</span> complex)
02306 MACRO_SOLVER_PLAN(mri_inh_2d1d, complex, <span class="keywordtype">double</span> complex)
02307 MACRO_SOLVER_PLAN(mri_inh_3d, complex, <span class="keywordtype">double</span> complex)
02308 MACRO_SOLVER_PLAN(nfsft, complex, <span class="keywordtype">double</span> complex)
02312 #endif
02313 <span class="comment">/* nfft3.h */</span>
</pre></div>    <hr size="1"/>
    Generated on 22 Jan 2007 by Doxygen 1.4.1
  </body>
</html>
