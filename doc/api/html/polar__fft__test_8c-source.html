<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
    <title>
      NFFT 3.0.2 API Reference - NFFT: polar_fft_test.c Source File
    </title>
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <table>
      <tr>
        <td valign="top">
          <img src="images/logo.png" alt="NFFT Logo">
        </td>
        <td align="left" valign="bottom" width="100%">
          <H1nc>3.0.2 API Reference</H1nc>
        </td>
      </tr>
    </table>  
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="dir_000006.html">applications</a>&nbsp;/&nbsp;<a class="el" href="dir_000013.html">polarFFT</a></div>
<h1>polar_fft_test.c</h1><a href="polar__fft__test_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 
00009 <span class="preprocessor">#include &lt;math.h&gt;</span>
00010 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00011 <span class="preprocessor">#include "<a class="code" href="util_8h.html">util.h</a>"</span>
00012 <span class="preprocessor">#include "<a class="code" href="nfft3_8h.html">nfft3.h</a>"</span>
00013 
<a name="l00051"></a><a class="code" href="group__applications__polarFFT__polar.html#ga0">00051</a> <span class="keywordtype">int</span> <a class="code" href="group__applications__polarFFT__polar.html#ga0">polar_grid</a>(<span class="keywordtype">int</span> T, <span class="keywordtype">int</span> R, <span class="keywordtype">double</span> *x, <span class="keywordtype">double</span> *w)
00052 {
00053   <span class="keywordtype">int</span> t, r;
00054   <span class="keywordtype">double</span> W=(double)T*(((double)R/2.0)*((double)R/2.0)+1.0/4.0);
00055 
00056   <span class="keywordflow">for</span>(t=-T/2; t&lt;T/2; t++)
00057   {
00058     <span class="keywordflow">for</span>(r=-R/2; r&lt;R/2; r++)
00059     {
00060       x[2*((t+T/2)*R+(r+R/2))+0] = (double)r/R*cos(<a class="code" href="group__nfftutil.html#ga57">PI</a>*t/T);
00061       x[2*((t+T/2)*R+(r+R/2))+1] = (double)r/R*sin(<a class="code" href="group__nfftutil.html#ga57">PI</a>*t/T);
00062       <span class="keywordflow">if</span> (r==0)
00063         w[(t+T/2)*R+(r+R/2)] = 1.0/4.0/W;
00064       <span class="keywordflow">else</span>
00065         w[(t+T/2)*R+(r+R/2)] = fabs((<span class="keywordtype">double</span>)r)/W;
00066     }
00067   }
00068 
00069   <span class="keywordflow">return</span> T*R;                           
00070 }
00071 
<a name="l00073"></a><a class="code" href="group__applications__polarFFT__polar.html#ga1">00073</a> <span class="keywordtype">int</span> <a class="code" href="group__applications__polarFFT__polar.html#ga1">polar_dft</a>(fftw_complex *f_hat, <span class="keywordtype">int</span> NN, fftw_complex *f, <span class="keywordtype">int</span> T, <span class="keywordtype">int</span> R, <span class="keywordtype">int</span> m)
00074 {
00075   <span class="keywordtype">int</span> j,k;                              
00076   <a class="code" href="structnfft__plan.html">nfft_plan</a> my_nfft_plan;               
00078   <span class="keywordtype">double</span> *x, *w;                        
00080   <span class="keywordtype">int</span> N[2],n[2];
00081   <span class="keywordtype">int</span> M=T*R;                            
00083   N[0]=NN; n[0]=2*N[0];                 
00084   N[1]=NN; n[1]=2*N[1];                 
00086   x = (<span class="keywordtype">double</span> *)malloc(2*T*R*(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)));
00087   <span class="keywordflow">if</span> (x==NULL)
00088     <span class="keywordflow">return</span> -1;
00089 
00090   w = (<span class="keywordtype">double</span> *)malloc(T*R*(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)));
00091   <span class="keywordflow">if</span> (w==NULL)
00092     <span class="keywordflow">return</span> -1;
00093 
00095   <a class="code" href="group__nfft.html#ga9">nfft_init_guru</a>(&amp;my_nfft_plan, 2, N, M, n, m,
00096                   <a class="code" href="group__nfft.html#ga16">PRE_PHI_HUT</a>| <a class="code" href="group__nfft.html#ga20">PRE_PSI</a>| <a class="code" href="group__nfft.html#ga22">MALLOC_X</a> | <a class="code" href="group__nfft.html#ga23">MALLOC_F_HAT</a>| <a class="code" href="group__nfft.html#ga24">MALLOC_F</a>| <a class="code" href="group__nfft.html#ga26">FFTW_INIT</a> | <a class="code" href="group__nfft.html#ga25">FFT_OUT_OF_PLACE</a>,
00097                   FFTW_MEASURE| FFTW_DESTROY_INPUT);
00098 
00100   <a class="code" href="group__applications__polarFFT__polar.html#ga0">polar_grid</a>(T,R,x,w);
00101   <span class="keywordflow">for</span>(j=0;j&lt;my_nfft_plan.<a class="code" href="structnfft__plan.html#o1">M_total</a>;j++)
00102   {
00103     my_nfft_plan.<a class="code" href="structnfft__plan.html#o14">x</a>[2*j+0] = x[2*j+0];
00104     my_nfft_plan.<a class="code" href="structnfft__plan.html#o14">x</a>[2*j+1] = x[2*j+1];
00105   }
00106 
00108   <span class="keywordflow">for</span>(k=0;k&lt;my_nfft_plan.<a class="code" href="structnfft__plan.html#o0">N_total</a>;k++)
00109     my_nfft_plan.<a class="code" href="structnfft__plan.html#o2">f_hat</a>[k] = f_hat[k];
00110 
00112   <a class="code" href="group__nfft.html#ga0">ndft_trafo</a>(&amp;my_nfft_plan);
00113 
00115   <span class="keywordflow">for</span>(j=0;j&lt;my_nfft_plan.<a class="code" href="structnfft__plan.html#o1">M_total</a>;j++)
00116     f[j] = my_nfft_plan.<a class="code" href="structnfft__plan.html#o3">f</a>[j];
00117 
00119   <a class="code" href="group__nfft.html#ga15">nfft_finalize</a>(&amp;my_nfft_plan);
00120   free(x);
00121   free(w);
00122 
00123   <span class="keywordflow">return</span> EXIT_SUCCESS;
00124 }
00125 
<a name="l00127"></a><a class="code" href="group__applications__polarFFT__polar.html#ga2">00127</a> <span class="keywordtype">int</span> <a class="code" href="group__applications__polarFFT__polar.html#ga2">polar_fft</a>(fftw_complex *f_hat, <span class="keywordtype">int</span> NN, fftw_complex *f, <span class="keywordtype">int</span> T, <span class="keywordtype">int</span> R, <span class="keywordtype">int</span> m)
00128 {
00129   <span class="keywordtype">int</span> j,k;                              
00130   <a class="code" href="structnfft__plan.html">nfft_plan</a> my_nfft_plan;               
00132   <span class="keywordtype">double</span> *x, *w;                        
00134   <span class="keywordtype">int</span> N[2],n[2];
00135   <span class="keywordtype">int</span> M=T*R;                            
00137   N[0]=NN; n[0]=2*N[0];                 
00138   N[1]=NN; n[1]=2*N[1];                 
00140   x = (<span class="keywordtype">double</span> *)malloc(2*T*R*(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)));
00141   <span class="keywordflow">if</span> (x==NULL)
00142     <span class="keywordflow">return</span> -1;
00143 
00144   w = (<span class="keywordtype">double</span> *)malloc(T*R*(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)));
00145   <span class="keywordflow">if</span> (w==NULL)
00146     <span class="keywordflow">return</span> -1;
00147 
00149   <a class="code" href="group__nfft.html#ga9">nfft_init_guru</a>(&amp;my_nfft_plan, 2, N, M, n, m,
00150                   <a class="code" href="group__nfft.html#ga16">PRE_PHI_HUT</a>| <a class="code" href="group__nfft.html#ga20">PRE_PSI</a>| <a class="code" href="group__nfft.html#ga22">MALLOC_X</a> | <a class="code" href="group__nfft.html#ga23">MALLOC_F_HAT</a>| <a class="code" href="group__nfft.html#ga24">MALLOC_F</a>| <a class="code" href="group__nfft.html#ga26">FFTW_INIT</a> | <a class="code" href="group__nfft.html#ga25">FFT_OUT_OF_PLACE</a>,
00151                   FFTW_MEASURE| FFTW_DESTROY_INPUT);
00152 
00154   <a class="code" href="group__applications__polarFFT__polar.html#ga0">polar_grid</a>(T,R,x,w);
00155   <span class="keywordflow">for</span>(j=0;j&lt;my_nfft_plan.<a class="code" href="structnfft__plan.html#o1">M_total</a>;j++)
00156   {
00157     my_nfft_plan.<a class="code" href="structnfft__plan.html#o14">x</a>[2*j+0] = x[2*j+0];
00158     my_nfft_plan.<a class="code" href="structnfft__plan.html#o14">x</a>[2*j+1] = x[2*j+1];
00159   }
00160 
00162   <span class="keywordflow">if</span>(my_nfft_plan.<a class="code" href="structnfft__plan.html#o12">nfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga18">PRE_LIN_PSI</a>)
00163     <a class="code" href="group__nfft.html#ga13">nfft_precompute_lin_psi</a>(&amp;my_nfft_plan);
00164 
00165   <span class="keywordflow">if</span>(my_nfft_plan.<a class="code" href="structnfft__plan.html#o12">nfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga20">PRE_PSI</a>)
00166     <a class="code" href="group__nfft.html#ga12">nfft_precompute_psi</a>(&amp;my_nfft_plan);
00167 
00168   <span class="keywordflow">if</span>(my_nfft_plan.<a class="code" href="structnfft__plan.html#o12">nfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga21">PRE_FULL_PSI</a>)
00169     <a class="code" href="group__nfft.html#ga11">nfft_precompute_full_psi</a>(&amp;my_nfft_plan);
00170 
00172   <span class="keywordflow">for</span>(k=0;k&lt;my_nfft_plan.<a class="code" href="structnfft__plan.html#o0">N_total</a>;k++)
00173     my_nfft_plan.<a class="code" href="structnfft__plan.html#o2">f_hat</a>[k] = f_hat[k];
00174 
00176   <a class="code" href="group__nfft.html#ga2">nfft_trafo</a>(&amp;my_nfft_plan);
00177 
00179   <span class="keywordflow">for</span>(j=0;j&lt;my_nfft_plan.<a class="code" href="structnfft__plan.html#o1">M_total</a>;j++)
00180     f[j] = my_nfft_plan.<a class="code" href="structnfft__plan.html#o3">f</a>[j];
00181 
00183   <a class="code" href="group__nfft.html#ga15">nfft_finalize</a>(&amp;my_nfft_plan);
00184   free(x);
00185   free(w);
00186 
00187   <span class="keywordflow">return</span> EXIT_SUCCESS;
00188 }
00189 
<a name="l00191"></a><a class="code" href="group__applications__polarFFT__polar.html#ga3">00191</a> <span class="keywordtype">int</span> <a class="code" href="group__applications__polarFFT__polar.html#ga3">inverse_polar_fft</a>(fftw_complex *f, <span class="keywordtype">int</span> T, <span class="keywordtype">int</span> R, fftw_complex *f_hat, <span class="keywordtype">int</span> NN, <span class="keywordtype">int</span> max_i, <span class="keywordtype">int</span> m)
00192 {
00193   <span class="keywordtype">int</span> j,k;                              
00194   <a class="code" href="structnfft__plan.html">nfft_plan</a> my_nfft_plan;               
00195   <a class="code" href="structinfft__plan.html">infft_plan</a> my_infft_plan;             
00197   <span class="keywordtype">double</span> *x, *w;                        
00198   <span class="keywordtype">int</span> l;                                
00200   <span class="keywordtype">int</span> N[2],n[2];
00201   <span class="keywordtype">int</span> M=T*R;                            
00203   N[0]=NN; n[0]=2*N[0];                 
00204   N[1]=NN; n[1]=2*N[1];                 
00206   x = (<span class="keywordtype">double</span> *)malloc(2*T*R*(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)));
00207   <span class="keywordflow">if</span> (x==NULL)
00208     <span class="keywordflow">return</span> -1;
00209 
00210   w = (<span class="keywordtype">double</span> *)malloc(T*R*(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)));
00211   <span class="keywordflow">if</span> (w==NULL)
00212     <span class="keywordflow">return</span> -1;
00213 
00215   <a class="code" href="group__nfft.html#ga9">nfft_init_guru</a>(&amp;my_nfft_plan, 2, N, M, n, m,
00216                   <a class="code" href="group__nfft.html#ga16">PRE_PHI_HUT</a>| <a class="code" href="group__nfft.html#ga20">PRE_PSI</a>| <a class="code" href="group__nfft.html#ga22">MALLOC_X</a> | <a class="code" href="group__nfft.html#ga23">MALLOC_F_HAT</a>| <a class="code" href="group__nfft.html#ga24">MALLOC_F</a>| <a class="code" href="group__nfft.html#ga26">FFTW_INIT</a> | <a class="code" href="group__nfft.html#ga25">FFT_OUT_OF_PLACE</a>,
00217                   FFTW_MEASURE| FFTW_DESTROY_INPUT);
00218 
00220   <a class="code" href="group__solver.html#ga1">infft_init_advanced</a>(&amp;my_infft_plan,&amp;my_nfft_plan, <a class="code" href="group__solver.html#ga37">CGNR</a> | <a class="code" href="group__solver.html#ga40">PRECOMPUTE_WEIGHT</a> );
00221 
00223   <a class="code" href="group__applications__polarFFT__polar.html#ga0">polar_grid</a>(T,R,x,w);
00224   <span class="keywordflow">for</span>(j=0;j&lt;my_nfft_plan.<a class="code" href="structnfft__plan.html#o1">M_total</a>;j++)
00225   {
00226     my_nfft_plan.<a class="code" href="structnfft__plan.html#o14">x</a>[2*j+0] = x[2*j+0];
00227     my_nfft_plan.<a class="code" href="structnfft__plan.html#o14">x</a>[2*j+1] = x[2*j+1];
00228     my_infft_plan.<a class="code" href="structinfft__plan.html#o4">y</a>[j]    = f[j];
00229     my_infft_plan.<a class="code" href="structinfft__plan.html#o2">w</a>[j]    = w[j];
00230   }
00231 
00233   <span class="keywordflow">if</span>(my_nfft_plan.<a class="code" href="structnfft__plan.html#o12">nfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga18">PRE_LIN_PSI</a>)
00234     <a class="code" href="group__nfft.html#ga13">nfft_precompute_lin_psi</a>(&amp;my_nfft_plan);
00235 
00236   <span class="keywordflow">if</span>(my_nfft_plan.<a class="code" href="structnfft__plan.html#o12">nfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga20">PRE_PSI</a>)
00237     <a class="code" href="group__nfft.html#ga12">nfft_precompute_psi</a>(&amp;my_nfft_plan);
00238 
00239   <span class="keywordflow">if</span>(my_nfft_plan.<a class="code" href="structnfft__plan.html#o12">nfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga21">PRE_FULL_PSI</a>)
00240     <a class="code" href="group__nfft.html#ga11">nfft_precompute_full_psi</a>(&amp;my_nfft_plan);
00241 
00243   <span class="keywordflow">if</span>(my_infft_plan.<a class="code" href="structinfft__plan.html#o1">flags</a> &amp; <a class="code" href="group__solver.html#ga41">PRECOMPUTE_DAMP</a>)
00244     <span class="keywordflow">for</span>(j=0;j&lt;my_infft_plan.<a class="code" href="structinfft__plan.html#o0">mv</a>-&gt;<a class="code" href="structnfft__plan.html#o5">N</a>[0];j++)
00245       <span class="keywordflow">for</span>(k=0;k&lt;my_infft_plan.<a class="code" href="structinfft__plan.html#o0">mv</a>-&gt;<a class="code" href="structnfft__plan.html#o5">N</a>[1];k++)
00246   {
00247     my_infft_plan.<a class="code" href="structinfft__plan.html#o3">w_hat</a>[j*my_infft_plan.<a class="code" href="structinfft__plan.html#o0">mv</a>-&gt;<a class="code" href="structnfft__plan.html#o5">N</a>[1]+k]=
00248         (sqrt(pow(j-my_infft_plan.<a class="code" href="structinfft__plan.html#o0">mv</a>-&gt;<a class="code" href="structnfft__plan.html#o5">N</a>[0]/2,2)+pow(k-my_infft_plan.<a class="code" href="structinfft__plan.html#o0">mv</a>-&gt;<a class="code" href="structnfft__plan.html#o5">N</a>[1]/2,2))&gt;(my_infft_plan.<a class="code" href="structinfft__plan.html#o0">mv</a>-&gt;<a class="code" href="structnfft__plan.html#o5">N</a>[0]/2)?0:1);
00249   }
00250 
00252   <span class="keywordflow">for</span>(k=0;k&lt;my_nfft_plan.<a class="code" href="structnfft__plan.html#o0">N_total</a>;k++)
00253     my_infft_plan.<a class="code" href="structinfft__plan.html#o5">f_hat_iter</a>[k] = 0.0 + I*0.0;
00254 
00256   <a class="code" href="group__solver.html#ga2">infft_before_loop</a>(&amp;my_infft_plan);
00257 
00258   <span class="keywordflow">if</span> (max_i&lt;1)
00259   {
00260     l=1;
00261     <span class="keywordflow">for</span>(k=0;k&lt;my_nfft_plan.<a class="code" href="structnfft__plan.html#o0">N_total</a>;k++)
00262       my_infft_plan.<a class="code" href="structinfft__plan.html#o5">f_hat_iter</a>[k] = my_infft_plan.<a class="code" href="structinfft__plan.html#o8">p_hat_iter</a>[k];
00263   }
00264   <span class="keywordflow">else</span>
00265   {
00266     <span class="keywordflow">for</span>(l=1;l&lt;=max_i;l++)
00267     {
00268       <a class="code" href="group__solver.html#ga3">infft_loop_one_step</a>(&amp;my_infft_plan);
00269     }
00270   }
00271 
00273   <span class="keywordflow">for</span>(k=0;k&lt;my_nfft_plan.<a class="code" href="structnfft__plan.html#o0">N_total</a>;k++)
00274     f_hat[k] = my_infft_plan.<a class="code" href="structinfft__plan.html#o5">f_hat_iter</a>[k];
00275 
00277   <a class="code" href="group__solver.html#ga4">infft_finalize</a>(&amp;my_infft_plan);
00278   <a class="code" href="group__nfft.html#ga15">nfft_finalize</a>(&amp;my_nfft_plan);
00279   free(x);
00280   free(w);
00281 
00282   <span class="keywordflow">return</span> EXIT_SUCCESS;
00283 }
00284 
<a name="l00286"></a><a class="code" href="group__applications__polarFFT__polar.html#ga4">00286</a> <span class="keywordtype">int</span> <a class="code" href="flags_8c.html#a6">main</a>(<span class="keywordtype">int</span> argc,<span class="keywordtype">char</span> **argv)
00287 {
00288   <span class="keywordtype">int</span> N;                                
00289   <span class="keywordtype">int</span> T, R;                             
00290   <span class="keywordtype">int</span> M;                                
00291   <span class="keywordtype">double</span> *x, *w;                        
00292   fftw_complex *f_hat, *f, *f_direct, *f_tilde;
00293   <span class="keywordtype">int</span> k;
00294   <span class="keywordtype">int</span> max_i;                            
00295   <span class="keywordtype">int</span> m;
00296   <span class="keywordtype">double</span> temp1, temp2, E_max=0.0;
00297   FILE *fp1, *fp2;
00298   <span class="keywordtype">char</span> filename[30];
00299 
00300   <span class="keywordflow">if</span>( argc!=4 )
00301   {
00302     printf(<span class="stringliteral">"polar_fft_test N T R \n"</span>);
00303     printf(<span class="stringliteral">"\n"</span>);
00304     printf(<span class="stringliteral">"N          polar FFT of size NxN     \n"</span>);
00305     printf(<span class="stringliteral">"T          number of slopes          \n"</span>);
00306     printf(<span class="stringliteral">"R          number of offsets         \n"</span>);
00307     exit(-1);
00308   }
00309 
00310   N = atoi(argv[1]);
00311   T = atoi(argv[2]);
00312   R = atoi(argv[3]);
00313   printf(<span class="stringliteral">"N=%d, polar grid with T=%d, R=%d =&gt; "</span>,N,T,R);
00314 
00315   x = (<span class="keywordtype">double</span> *)malloc(2*1.25*T*R*(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)));
00316   w = (<span class="keywordtype">double</span> *)malloc(1.25*T*R*(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)));
00317 
00318   f_hat    = (fftw_complex *)fftw_malloc(<span class="keyword">sizeof</span>(fftw_complex)*N*N);
00319   f        = (fftw_complex *)fftw_malloc(<span class="keyword">sizeof</span>(fftw_complex)*T*R);
00320   f_direct = (fftw_complex *)fftw_malloc(<span class="keyword">sizeof</span>(fftw_complex)*T*R);
00321   f_tilde  = (fftw_complex *)fftw_malloc(<span class="keyword">sizeof</span>(fftw_complex)*N*N);
00322 
00324   M=<a class="code" href="group__applications__polarFFT__polar.html#ga0">polar_grid</a>(T,R,x,w); printf(<span class="stringliteral">"M=%d.\n"</span>,M);
00325 
00327   fp1=fopen(<span class="stringliteral">"input_data_r.dat"</span>,<span class="stringliteral">"r"</span>);
00328   fp2=fopen(<span class="stringliteral">"input_data_i.dat"</span>,<span class="stringliteral">"r"</span>);
00329   <span class="keywordflow">if</span> (fp1==NULL)
00330     <span class="keywordflow">return</span>(-1);
00331   <span class="keywordflow">for</span>(k=0;k&lt;N*N;k++)
00332   {
00333     fscanf(fp1,<span class="stringliteral">"%le "</span>,&amp;temp1);
00334     fscanf(fp2,<span class="stringliteral">"%le "</span>,&amp;temp2);
00335     f_hat[k]=temp1+I*temp2;
00336   }
00337   fclose(fp1);
00338   fclose(fp2);
00339 
00341     <a class="code" href="group__applications__polarFFT__polar.html#ga1">polar_dft</a>(f_hat,N,f_direct,T,R,m);
00342   <span class="comment">//  polar_fft(f_hat,N,f_direct,T,R,12);</span>
00343 
00345   printf(<span class="stringliteral">"\nTest of the polar FFT: \n"</span>);
00346   fp1=fopen(<span class="stringliteral">"polar_fft_error.dat"</span>,<span class="stringliteral">"w+"</span>);
00347   <span class="keywordflow">for</span> (m=1; m&lt;=12; m++)
00348   {
00350     <a class="code" href="group__applications__polarFFT__polar.html#ga2">polar_fft</a>(f_hat,N,f,T,R,m);
00351 
00353     E_max=<a class="code" href="group__nfftutil.html#ga37">nfft_error_l_infty_complex</a>(f_direct,f,M);
00354     printf(<span class="stringliteral">"m=%2d: E_max = %e\n"</span>,m,E_max);
00355     fprintf(fp1,<span class="stringliteral">"%e\n"</span>,E_max);
00356   }
00357   fclose(fp1);
00358 
00360   <span class="keywordflow">for</span> (m=3; m&lt;=9; m+=3)
00361   {
00362     printf(<span class="stringliteral">"\nTest of the inverse polar FFT for m=%d: \n"</span>,m);
00363     sprintf(filename,<span class="stringliteral">"polar_ifft_error%d.dat"</span>,m);
00364     fp1=fopen(filename,<span class="stringliteral">"w+"</span>);
00365     <span class="keywordflow">for</span> (max_i=0; max_i&lt;=100; max_i+=10)
00366     {
00368       <a class="code" href="group__applications__polarFFT__polar.html#ga3">inverse_polar_fft</a>(f_direct,T,R,f_tilde,N,max_i,m);
00369 
00371       <span class="comment">/* E_max=0.0;</span>
00372 <span class="comment">      for(k=0;k&lt;N*N;k++)</span>
00373 <span class="comment">      {</span>
00374 <span class="comment">        temp = cabs((f_hat[k]-f_tilde[k])/f_hat[k]);</span>
00375 <span class="comment">        if (temp&gt;E_max) E_max=temp;</span>
00376 <span class="comment">      }</span>
00377 <span class="comment">      */</span>
00378        E_max=<a class="code" href="group__nfftutil.html#ga37">nfft_error_l_infty_complex</a>(f_hat,f_tilde,N*N);
00379       printf(<span class="stringliteral">"%3d iterations: E_max = %e\n"</span>,max_i,E_max);
00380       fprintf(fp1,<span class="stringliteral">"%e\n"</span>,E_max);
00381     }
00382     fclose(fp1);
00383   }
00384 
00386   free(x);
00387   free(w);
00388   free(f_hat);
00389   free(f);
00390   free(f_direct);
00391   free(f_tilde);
00392 
00393   <span class="keywordflow">return</span> 0;
00394 }
00395 <span class="comment">/* \} */</span>
</pre></div>    <hr size="1"/>
    Generated on 22 Jan 2007 by Doxygen 1.4.1
  </body>
</html>
