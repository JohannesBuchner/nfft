<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
    <title>
      NFFT 3.0.2 API Reference - NFFT: accuracy.c Source File
    </title>
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <table>
      <tr>
        <td valign="top">
          <img src="images/logo.png" alt="NFFT Logo">
        </td>
        <td align="left" valign="bottom" width="100%">
          <H1nc>3.0.2 API Reference</H1nc>
        </td>
      </tr>
    </table>  
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">examples</a>&nbsp;/&nbsp;<a class="el" href="dir_000001.html">nnfft</a>&nbsp;/&nbsp;<a class="el" href="dir_000002.html">accuracy</a></div>
<h1>accuracy.c</h1><div class="fragment"><pre class="fragment">00001 <span class="preprocessor">#include &lt;math.h&gt;</span>
00002 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00003 <span class="preprocessor">#include "<a class="code" href="nfft3_8h.html">nfft3.h</a>"</span>
00004 <span class="preprocessor">#include "<a class="code" href="util_8h.html">util.h</a>"</span>
00005 
00006 <span class="keywordtype">void</span> accuracy(<span class="keywordtype">int</span> d)
00007 {
00008   <span class="keywordtype">int</span> m,t;                         
00009   <a class="code" href="structnnfft__plan.html">nnfft_plan</a> my_plan;                   
00010   <span class="keywordtype">double</span> complex *slow;
00011   
00012   <span class="keywordtype">int</span> N[d],n[d];
00013   <span class="keywordtype">int</span> M_total,N_total;
00014   M_total=10000;N_total=1;
00015   
00016   slow=(<span class="keywordtype">double</span> complex*)fftw_malloc(M_total*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span> complex));
00017   
00018   <span class="keywordflow">for</span>(t=0; t&lt;d; t++)
00019     {
00020       N[t]=(1&lt;&lt;(12/d));
00021       n[t]=2*N[t];
00022       N_total*=N[t];
00023     }
00024   
00026   <span class="keywordflow">for</span>(m=0; m&lt;10; m++)
00027     {
00028       <a class="code" href="group__nnfft.html#ga1">nnfft_init_guru</a>(&amp;my_plan, d, N_total, M_total, N, n, m,
00029           PRE_PSI| PRE_PHI_HUT|
00030           MALLOC_X| MALLOC_V| MALLOC_F_HAT| MALLOC_F);
00031       
00032       
00034       <a class="code" href="group__nfftutil.html#ga47">nfft_vrand_shifted_unit_double</a>(my_plan.<a class="code" href="structnnfft__plan.html#o17">x</a>, d*my_plan.<a class="code" href="structnnfft__plan.html#o1">M_total</a>);
00035       <a class="code" href="group__nfftutil.html#ga47">nfft_vrand_shifted_unit_double</a>(my_plan.<a class="code" href="structnnfft__plan.html#o18">v</a>, d*my_plan.<a class="code" href="structnnfft__plan.html#o0">N_total</a>);
00036       
00038       <span class="keywordflow">if</span>(my_plan.<a class="code" href="structnnfft__plan.html#o15">nnfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga20">PRE_PSI</a>)
00039         <a class="code" href="group__nnfft.html#ga7">nnfft_precompute_psi</a>(&amp;my_plan);
00040       
00041       <span class="keywordflow">if</span>(my_plan.<a class="code" href="structnnfft__plan.html#o15">nnfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga18">PRE_LIN_PSI</a>)
00042         <a class="code" href="group__nnfft.html#ga6">nnfft_precompute_lin_psi</a>(&amp;my_plan);
00043       
00044       <span class="keywordflow">if</span>(my_plan.<a class="code" href="structnnfft__plan.html#o15">nnfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga21">PRE_FULL_PSI</a>)
00045         <a class="code" href="group__nnfft.html#ga8">nnfft_precompute_full_psi</a>(&amp;my_plan);
00046       
00048       <span class="keywordflow">if</span>(my_plan.<a class="code" href="structnnfft__plan.html#o15">nnfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga16">PRE_PHI_HUT</a>)
00049         <a class="code" href="group__nnfft.html#ga9">nnfft_precompute_phi_hut</a>(&amp;my_plan);
00050       
00052       <a class="code" href="group__nfftutil.html#ga46">nfft_vrand_unit_complex</a>(my_plan.<a class="code" href="structnnfft__plan.html#o2">f_hat</a>, my_plan.<a class="code" href="structnnfft__plan.html#o0">N_total</a>);
00053       
00055       <a class="code" href="group__nnfft.html#ga2">nndft_trafo</a>(&amp;my_plan);
00056       
00057       <a class="code" href="group__nfftutil.html#ga55">NFFT_SWAP_complex</a>(my_plan.<a class="code" href="structnnfft__plan.html#o3">f</a>,slow);
00058       
00060       <a class="code" href="group__nnfft.html#ga4">nnfft_trafo</a>(&amp;my_plan);
00061       
00062       printf(<span class="stringliteral">"%e, %e\n"</span>,
00063        <a class="code" href="group__nfftutil.html#ga37">nfft_error_l_infty_complex</a>(slow, my_plan.<a class="code" href="structnnfft__plan.html#o3">f</a>, M_total),
00064        <a class="code" href="group__nfftutil.html#ga39">nfft_error_l_infty_1_complex</a>(slow, my_plan.<a class="code" href="structnnfft__plan.html#o3">f</a>, M_total, my_plan.<a class="code" href="structnnfft__plan.html#o2">f_hat</a>,
00065              my_plan.<a class="code" href="structnnfft__plan.html#o0">N_total</a>));
00066       
00068       <a class="code" href="group__nnfft.html#ga10">nnfft_finalize</a>(&amp;my_plan);
00069     }
00070 }
00071 
00072 <span class="keywordtype">int</span> <a class="code" href="flags_8c.html#a6">main</a>()
00073 { 
00074   <span class="keywordtype">int</span> d;
00075   <span class="keywordflow">for</span>(d=1; d&lt;4; d++)
00076     accuracy(d);
00077   
00078   <span class="keywordflow">return</span> 1;
00079 }
</pre></div>    <hr size="1"/>
    Generated on 22 Jan 2007 by Doxygen 1.4.1
  </body>
</html>
