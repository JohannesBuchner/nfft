<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
    <title>
      NFFT 3.0.2 API Reference - NFFT: simple_test.c Source File
    </title>
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <table>
      <tr>
        <td valign="top">
          <img src="images/logo.png" alt="NFFT Logo">
        </td>
        <td align="left" valign="bottom" width="100%">
          <H1nc>3.0.2 API Reference</H1nc>
        </td>
      </tr>
    </table>  
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">examples</a>&nbsp;/&nbsp;<a class="el" href="dir_000010.html">solver</a></div>
<h1>solver/simple_test.c</h1><div class="fragment"><pre class="fragment">00001 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00002 <span class="preprocessor">#include &lt;math.h&gt;</span>
00003 <span class="preprocessor">#include &lt;string.h&gt;</span>
00004 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00005 <span class="preprocessor">#include "<a class="code" href="util_8h.html">util.h</a>"</span>
00006 <span class="preprocessor">#include "<a class="code" href="nfft3_8h.html">nfft3.h</a>"</span>
00007 
<a name="l00015"></a><a class="code" href="group__examples__solver__simple.html#ga0">00015</a> <span class="keywordtype">void</span> <a class="code" href="group__examples__solver__simple.html#ga0">simple_test_infft_1d</a>(<span class="keywordtype">int</span> N, <span class="keywordtype">int</span> M, <span class="keywordtype">int</span> iter)
00016 {
00017   <span class="keywordtype">int</span> k,l;                            
00018   <a class="code" href="structnfft__plan.html">nfft_plan</a> p;                          
00019   <a class="code" href="structinfft__plan.html">infft_plan</a> ip;                        
00022   <a class="code" href="group__nfft.html#ga4">nfft_init_1d</a>(&amp;p, N, M);
00023 
00025   <a class="code" href="group__nfftutil.html#ga47">nfft_vrand_shifted_unit_double</a>(p.<a class="code" href="structnfft__plan.html#o14">x</a>,p.<a class="code" href="structnfft__plan.html#o1">M_total</a>);
00026   
00028   <span class="keywordflow">if</span>(p.<a class="code" href="structnfft__plan.html#o12">nfft_flags</a> &amp; <a class="code" href="group__nfft.html#ga27">PRE_ONE_PSI</a>)
00029     <a class="code" href="group__nfft.html#ga10">nfft_precompute_one_psi</a>(&amp;p);
00030 
00032   <a class="code" href="group__solver.html#ga0">infft_init</a>(&amp;ip,&amp;p);
00033 
00035   <a class="code" href="group__nfftutil.html#ga46">nfft_vrand_unit_complex</a>(ip.<a class="code" href="structinfft__plan.html#o4">y</a>,p.<a class="code" href="structnfft__plan.html#o1">M_total</a>);
00036   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(ip.<a class="code" href="structinfft__plan.html#o4">y</a>,p.<a class="code" href="structnfft__plan.html#o1">M_total</a>,<span class="stringliteral">"Given data, vector y"</span>);
00037 
00039   <span class="keywordflow">for</span>(k=0;k&lt;p.<a class="code" href="structnfft__plan.html#o0">N_total</a>;k++)
00040       ip.<a class="code" href="structinfft__plan.html#o5">f_hat_iter</a>[k]=0; 
00041 
00042   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(ip.<a class="code" href="structinfft__plan.html#o5">f_hat_iter</a>,p.<a class="code" href="structnfft__plan.html#o0">N_total</a>,<span class="stringliteral">"Initial guess, vector f_hat_iter"</span>);
00043 
00044   <a class="code" href="group__nfftutil.html#ga55">NFFT_SWAP_complex</a>(ip.<a class="code" href="structinfft__plan.html#o5">f_hat_iter</a>,p.<a class="code" href="structnfft__plan.html#o2">f_hat</a>);
00045   <a class="code" href="group__nfft.html#ga2">nfft_trafo</a>(&amp;p);
00046   <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(p.<a class="code" href="structnfft__plan.html#o3">f</a>,p.<a class="code" href="structnfft__plan.html#o1">M_total</a>,<span class="stringliteral">"Data fit, vector f"</span>);
00047   <a class="code" href="group__nfftutil.html#ga55">NFFT_SWAP_complex</a>(ip.<a class="code" href="structinfft__plan.html#o5">f_hat_iter</a>,p.<a class="code" href="structnfft__plan.html#o2">f_hat</a>);
00048 
00049   <a class="code" href="group__solver.html#ga2">infft_before_loop</a>(&amp;ip);
00050   printf(<span class="stringliteral">"\n Residual r=%e\n"</span>,ip.<a class="code" href="structinfft__plan.html#o12">dot_r_iter</a>);
00051 
00052   <span class="keywordflow">for</span>(l=0;l&lt;iter;l++)
00053     {
00054       printf(<span class="stringliteral">"\n********** Iteration l=%d **********\n"</span>,l);
00055       <a class="code" href="group__solver.html#ga3">infft_loop_one_step</a>(&amp;ip);
00056       <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(ip.<a class="code" href="structinfft__plan.html#o5">f_hat_iter</a>,p.<a class="code" href="structnfft__plan.html#o0">N_total</a>,
00057       <span class="stringliteral">"Approximate solution, vector f_hat_iter"</span>);
00058       
00059       <a class="code" href="group__nfftutil.html#ga55">NFFT_SWAP_complex</a>(ip.<a class="code" href="structinfft__plan.html#o5">f_hat_iter</a>,p.<a class="code" href="structnfft__plan.html#o2">f_hat</a>);
00060       <a class="code" href="group__nfft.html#ga2">nfft_trafo</a>(&amp;p);
00061       <a class="code" href="group__nfftutil.html#ga45">nfft_vpr_complex</a>(p.<a class="code" href="structnfft__plan.html#o3">f</a>,p.<a class="code" href="structnfft__plan.html#o1">M_total</a>,<span class="stringliteral">"Data fit, vector f"</span>);
00062       <a class="code" href="group__nfftutil.html#ga55">NFFT_SWAP_complex</a>(ip.<a class="code" href="structinfft__plan.html#o5">f_hat_iter</a>,p.<a class="code" href="structnfft__plan.html#o2">f_hat</a>);
00063 
00064       printf(<span class="stringliteral">"\n Residual r=%e\n"</span>,ip.<a class="code" href="structinfft__plan.html#o12">dot_r_iter</a>);
00065     }
00066   
00067   <a class="code" href="group__solver.html#ga4">infft_finalize</a>(&amp;ip);  
00068   <a class="code" href="group__nfft.html#ga15">nfft_finalize</a>(&amp;p);  
00069 }
00070 
<a name="l00072"></a><a class="code" href="group__examples__solver__simple.html#ga1">00072</a> <span class="keywordtype">int</span> <a class="code" href="flags_8c.html#a6">main</a>()
00073 {
00074   printf(<span class="stringliteral">"\n Computing a one dimensional inverse nfft\n"</span>);
00075   <a class="code" href="group__examples__solver__simple.html#ga0">simple_test_infft_1d</a>(8,4,5);
00076 
00077   <span class="keywordflow">return</span> 1;
00078 }
00079 <span class="comment">/* \} */</span>
</pre></div>    <hr size="1"/>
    Generated on 22 Jan 2007 by Doxygen 1.4.1
  </body>
</html>
