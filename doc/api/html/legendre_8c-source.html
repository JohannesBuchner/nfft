<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
    <title>
      NFFT 3.0.3 API Reference - NFFT: legendre.c Source File
    </title>
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <table>
      <tr>
        <td valign="top">
          <img src="images/logo.png" alt="NFFT Logo">
        </td>
        <td align="left" valign="bottom" width="100%">
          <H1nc>3.0.3 API Reference</H1nc>
        </td>
      </tr>
    </table>  
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="dir_000003.html">kernel</a>&nbsp;/&nbsp;<a class="el" href="dir_000004.html">nfsft</a></div>
<h1>legendre.c</h1><div class="fragment"><pre class="fragment">00001 <span class="preprocessor">#include "legendre.h"</span>
00002 <span class="preprocessor">#include "<a class="code" href="api_8h.html">api.h</a>"</span>
00003 <span class="preprocessor">#include &lt;math.h&gt;</span>
00004 
<a name="l00009"></a><a class="code" href="group__nfsft.html#ga12">00009</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="group__nfsft.html#ga12">alpha_al</a>(<span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n)
00010 { 
00011   <span class="keywordflow">if</span> (k == -1)
00012   {
00013     <span class="keywordflow">return</span> (0.0); 
00014   }
00015   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k == 0)
00016   {
00017     <span class="keywordflow">if</span> (n == 0)
00018     {
00019       <span class="keywordflow">return</span> 1;
00020     }
00021     <span class="keywordflow">else</span>
00022     {
00023       <span class="keywordflow">return</span> n%2==0?-1.0:0.0;
00024     }
00025   }
00026   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k &lt; n) 
00027   {
00028     <span class="keywordflow">return</span> k%2==0?-1.0:1.0;
00029   }  
00030   <span class="keywordflow">else</span> 
00031   {
00032     <span class="keywordflow">return</span> (2.0*k+1.0) / sqrt ((k-n+1.0) * (k+n+1.0));        
00033   }
00034 }
00035 
<a name="l00036"></a><a class="code" href="group__nfsft.html#ga13">00036</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="group__nfsft.html#ga13">beta_al</a>(<span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n)
00037 {
00038   <span class="keywordflow">if</span> (0 &lt;= k &amp;&amp; k &lt; n)
00039   {
00040     <span class="keywordflow">return</span> (1.0);
00041   }
00042   <span class="keywordflow">else</span>
00043   {
00044     <span class="keywordflow">return</span> (0.0);
00045   }
00046 }
00047 
<a name="l00048"></a><a class="code" href="group__nfsft.html#ga14">00048</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="group__nfsft.html#ga14">gamma_al</a>(<span class="keywordtype">int</span> k, <span class="keywordtype">int</span> n)
00049 { 
00050   <span class="keyword">static</span> <span class="keywordtype">int</span> i;
00051   <span class="keyword">static</span> <span class="keywordtype">double</span> result;
00052   
00053   <span class="keywordflow">if</span> (k == -1) 
00054   {
00055     <span class="comment">/* Constant is ((2n)!)^(1/2) / (2^n n!). */</span>
00056     result = 1.0;
00057     <span class="keywordflow">for</span> (i = 1; i &lt;= n; i++)
00058     {  
00059       result *= (n+i)/(4.0*i);                                      
00060     }  
00061     <span class="keywordflow">return</span> (sqrt(result));
00062   }
00063   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k &lt;= n) 
00064   {
00065     <span class="keywordflow">return</span> (0.0);
00066   }
00067   <span class="keywordflow">else</span> 
00068   {
00069     <span class="keywordflow">return</span> (-sqrt(((<span class="keywordtype">double</span>)(k-n)*(k+n))/(((k-n+1.0)*(k+n+1.0))))); 
00070   }
00071 }             
00072 
00073 <span class="keyword">inline</span> <span class="keywordtype">void</span> alpha_al_row(<span class="keywordtype">double</span> *alpha, <span class="keywordtype">int</span> N, <span class="keywordtype">int</span> n)
00074 {
00075   <span class="keywordtype">int</span> j;
00076   <span class="keywordtype">double</span> *alpha_act = alpha;
00077   <span class="keywordflow">for</span> (j = -1; j &lt;= N; j++)
00078   {
00079     *alpha_act = <a class="code" href="group__nfsft.html#ga12">alpha_al</a>(j,n); 
00080     alpha_act++;
00081   }  
00082 }
00083 
00084 <span class="keyword">inline</span> <span class="keywordtype">void</span> beta_al_row(<span class="keywordtype">double</span> *beta, <span class="keywordtype">int</span> N, <span class="keywordtype">int</span> n)
00085 {
00086   <span class="keywordtype">int</span> j;
00087   <span class="keywordtype">double</span> *beta_act = beta;
00088   <span class="keywordflow">for</span> (j = -1; j &lt;= N; j++)
00089   {
00090     *beta_act = <a class="code" href="group__nfsft.html#ga13">beta_al</a>(j,n); 
00091     beta_act++;
00092   }  
00093 }
00094 
00095 <span class="keyword">inline</span> <span class="keywordtype">void</span> gamma_al_row(<span class="keywordtype">double</span> *gamma, <span class="keywordtype">int</span> N, <span class="keywordtype">int</span> n)
00096 {
00097   <span class="keywordtype">int</span> j;
00098   <span class="keywordtype">double</span> *gamma_act = gamma;
00099   <span class="keywordflow">for</span> (j = -1; j &lt;= N; j++)
00100   {
00101     *gamma_act = <a class="code" href="group__nfsft.html#ga14">gamma_al</a>(j,n); 
00102     gamma_act++;
00103   }  
00104 }
00105 
<a name="l00106"></a><a class="code" href="group__nfsft.html#ga18">00106</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group__nfsft.html#ga18">alpha_al_all</a>(<span class="keywordtype">double</span> *alpha, <span class="keywordtype">int</span> N)
00107 {
00108   <span class="keywordtype">int</span> i,j;
00109   <span class="keywordtype">double</span> *alpha_act = alpha;
00110   <span class="keywordflow">for</span> (i = 0; i &lt;= N; i++)
00111   {
00112     <span class="keywordflow">for</span> (j = -1; j &lt;= N; j++)
00113     {
00114       *alpha_act = <a class="code" href="group__nfsft.html#ga12">alpha_al</a>(j,i); 
00115       alpha_act++;
00116     }  
00117   }  
00118 }
00119 
<a name="l00120"></a><a class="code" href="group__nfsft.html#ga19">00120</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group__nfsft.html#ga19">beta_al_all</a>(<span class="keywordtype">double</span> *alpha, <span class="keywordtype">int</span> N)
00121 {
00122   <span class="keywordtype">int</span> i,j;
00123   <span class="keywordtype">double</span> *alpha_act = alpha;
00124   <span class="keywordflow">for</span> (i = 0; i &lt;= N; i++)
00125   {
00126     <span class="keywordflow">for</span> (j = -1; j &lt;= N; j++)
00127     {
00128       *alpha_act = <a class="code" href="group__nfsft.html#ga13">beta_al</a>(j,i); 
00129       alpha_act++;
00130     }  
00131   }  
00132 }
00133 
<a name="l00134"></a><a class="code" href="group__nfsft.html#ga20">00134</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group__nfsft.html#ga20">gamma_al_all</a>(<span class="keywordtype">double</span> *alpha, <span class="keywordtype">int</span> N)
00135 {
00136   <span class="keywordtype">int</span> i,j;
00137   <span class="keywordtype">double</span> *alpha_act = alpha;
00138   <span class="keywordflow">for</span> (i = 0; i &lt;= N; i++)
00139   {
00140     <span class="keywordflow">for</span> (j = -1; j &lt;= N; j++)
00141     {
00142       *alpha_act = <a class="code" href="group__nfsft.html#ga14">gamma_al</a>(j,i); 
00143       alpha_act++;
00144     }  
00145   }  
00146 }
00147 
<a name="l00148"></a><a class="code" href="group__nfsft.html#ga21">00148</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group__nfsft.html#ga21">eval_al</a>(<span class="keywordtype">double</span> *x, <span class="keywordtype">double</span> *y, <span class="keywordtype">int</span> size, <span class="keywordtype">int</span> k, <span class="keywordtype">double</span> *alpha, 
00149   <span class="keywordtype">double</span> *beta, <span class="keywordtype">double</span> *gamma)
00150 {
00151   <span class="comment">/* Evaluate the associated Legendre polynomial P_{k,nleg} (l,x) for the vector </span>
00152 <span class="comment">   * of knots  x[0], ..., x[size-1] by the Clenshaw algorithm</span>
00153 <span class="comment">   */</span>
00154   <span class="keywordtype">int</span> i,j;
00155   <span class="keywordtype">double</span> a,b,x_val_act,a_old;
00156   <span class="keywordtype">double</span> *x_act, *y_act;  
00157   <span class="keywordtype">double</span> *alpha_act, *beta_act, *gamma_act;
00158   
00159   <span class="comment">/* Traverse all nodes. */</span>
00160   x_act = x;
00161   y_act = y;
00162   <span class="keywordflow">for</span> (i = 0; i &lt; size; i++)
00163   {
00164     a = 1.0;
00165     b = 0.0;
00166     x_val_act = *x_act;
00167     
00168     <span class="keywordflow">if</span> (k == 0)
00169     {  
00170       *y_act = 1.0;
00171     }
00172     <span class="keywordflow">else</span>
00173     {
00174       alpha_act = &amp;(alpha[k]);
00175       beta_act = &amp;(beta[k]);
00176       gamma_act = &amp;(gamma[k]);
00177       <span class="keywordflow">for</span> (j = k; j &gt; 1; j--)
00178       {
00179         a_old = a;
00180         a = b + a_old*((*alpha_act)*x_val_act+(*beta_act));           
00181          b = a_old*(*gamma_act);
00182         alpha_act--;
00183         beta_act--;
00184         gamma_act--;
00185       }
00186       *y_act = (a*((*alpha_act)*x_val_act+(*beta_act))+b);                  
00187     }
00188     x_act++;
00189     y_act++;
00190   }
00191 }
00192 
<a name="l00193"></a><a class="code" href="group__nfsft.html#ga22">00193</a> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="group__nfsft.html#ga22">eval_al_thresh</a>(<span class="keywordtype">double</span> *x, <span class="keywordtype">double</span> *y, <span class="keywordtype">int</span> size, <span class="keywordtype">int</span> k, <span class="keywordtype">double</span> *alpha, 
00194   <span class="keywordtype">double</span> *beta, <span class="keywordtype">double</span> *gamma, <span class="keywordtype">double</span> threshold)
00195 {
00196   <span class="comment">/* Evaluate the associated Legendre polynomial P_{k,nleg} (l,x) for the vector </span>
00197 <span class="comment">   * of knots  x[0], ..., x[size-1] by the Clenshaw algorithm</span>
00198 <span class="comment">   */</span>
00199   <span class="keywordtype">int</span> i,j;
00200   <span class="keywordtype">double</span> a,b,x_val_act,a_old;
00201   <span class="keywordtype">double</span> *x_act, *y_act;
00202   <span class="keywordtype">double</span> *alpha_act, *beta_act, *gamma_act;
00203   
00204   <span class="comment">/* Traverse all nodes. */</span>
00205   x_act = x;
00206   y_act = y;
00207   <span class="keywordflow">for</span> (i = 0; i &lt; size; i++)
00208   {
00209     a = 1.0;
00210     b = 0.0;
00211     x_val_act = *x_act;
00212     
00213     <span class="keywordflow">if</span> (k == 0)
00214     {  
00215      *y_act = 1.0;
00216     }
00217     <span class="keywordflow">else</span>
00218     {
00219       alpha_act = &amp;(alpha[k]);
00220       beta_act = &amp;(beta[k]);
00221       gamma_act = &amp;(gamma[k]);
00222       <span class="keywordflow">for</span> (j = k; j &gt; 1; j--)
00223       {
00224         a_old = a;
00225         a = b + a_old*((*alpha_act)*x_val_act+(*beta_act));           
00226          b = a_old*(*gamma_act);
00227         alpha_act--;
00228         beta_act--;
00229         gamma_act--;
00230       }
00231       *y_act = (a*((*alpha_act)*x_val_act+(*beta_act))+b);                  
00232       <span class="keywordflow">if</span> (fabs(*y_act) &gt; threshold)
00233       {
00234         <span class="keywordflow">return</span> 1;
00235       }
00236     }
00237     x_act++;
00238     y_act++;
00239   }
00240   <span class="keywordflow">return</span> 0;
00241 }
00242 <span class="comment">/* \} */</span>
</pre></div>    <hr size="1"/>
    Generated on 5 Feb 2007 by Doxygen 1.4.1
  </body>
</html>
